import{r as f,b as ue,T as ge,c as be,g as ye,j as e,d as J,e as je,f as N,a as oe,I as Q,B as o,R as Y,A as ve,h as m,C as se,i as ne,k as Ce,l as ie}from"./index-DxyCEj15.js";import{A as ae,T as le,a as Se,M as we}from"./ArrowBackIosNew-BGmXEOrO.js";import{C as ke}from"./CheckCircle-B4j7OQ6x.js";import{S as Ie}from"./Straighten-C0jIxJqH.js";import{L as ze}from"./LocalShipping-YvugtPgC.js";import{u as U}from"./productStore-C_8ymkx7.js";import{u as _}from"./cartStore-DCeI--0K.js";import{u as ce}from"./pricingStore-PcBgT_-N.js";import{Q as Te,p as Re}from"./profile-mqY_a61I.js";import{A as We}from"./Add-gZqJg1iJ.js";import{S as Ee}from"./Search-CDptXU-4.js";import{S as de}from"./ShoppingCart-BeGKc97u.js";import{F as Fe}from"./FitnessCenter-BLtp9Amm.js";import{B as Ae,E as Pe}from"./EnergySavingsLeaf-BKmOvRof.js";import{F as De}from"./FlashOn-DAtaWd2q.js";import{D as xe}from"./DialogTitle-nzooP7jj.js";import{A as ee}from"./Alert-D6nSKEw_.js";import{B as $}from"./Button-C0BYlUU1.js";import{d as Le,o as he,I as G,F as Me,S as Oe}from"./TextField-aIIEym9U.js";import{Q as Ve}from"./QuantitySelector-DnLewwMD.js";import{O as Be}from"./OfflineDialog-CcfiyZlD.js";import{H as Ne}from"./Header-f4TfKueg.js";import{P as He}from"./Page-BHx2H6bX.js";import{C as Ue}from"./Chip-Dmx1LAXp.js";import{G as H}from"./Grid-CT5rJy85.js";import{D as q}from"./Divider-CmVhtnPA.js";import{C as $e}from"./CardContent-4CEbcEGT.js";import"./dividerClasses-ttEJLAcw.js";import"./isMuiElement-BCf5HDxN.js";import"./DialogContentText-DzJj1vtL.js";function Qe(s,c,t){const n=c.getBoundingClientRect(),a=t&&t.getBoundingClientRect(),b=he(c);let j;if(c.fakeTransform)j=c.fakeTransform;else{const g=b.getComputedStyle(c);j=g.getPropertyValue("-webkit-transform")||g.getPropertyValue("transform")}let I=0,v=0;if(j&&j!=="none"&&typeof j=="string"){const g=j.split("(")[1].split(")")[0].split(",");I=parseInt(g[4],10),v=parseInt(g[5],10)}return s==="left"?a?`translateX(${a.right+I-n.left}px)`:`translateX(${b.innerWidth+I-n.left}px)`:s==="right"?a?`translateX(-${n.right-a.left-I}px)`:`translateX(-${n.left+n.width-I}px)`:s==="up"?a?`translateY(${a.bottom+v-n.top}px)`:`translateY(${b.innerHeight+v-n.top}px)`:a?`translateY(-${n.top-a.top+n.height-v}px)`:`translateY(-${n.top+n.height-v}px)`}function Ye(s){return typeof s=="function"?s():s}function X(s,c,t){const n=Ye(t),a=Qe(s,c,n);a&&(c.style.webkitTransform=a,c.style.transform=a)}const me=f.forwardRef(function(c,t){const n=ue(),a={enter:n.transitions.easing.easeOut,exit:n.transitions.easing.sharp},b={enter:n.transitions.duration.enteringScreen,exit:n.transitions.duration.leavingScreen},{addEndListener:j,appear:I=!0,children:v,container:g,direction:z="down",easing:A=a,in:T,onEnter:R,onEntered:w,onEntering:W,onExit:E,onExited:k,onExiting:P,style:C,timeout:D=b,TransitionComponent:M=ge,...i}=c,d=f.useRef(null),F=be(ye(v),d,t),V=l=>S=>{l&&(S===void 0?l(d.current):l(d.current,S))},r=V((l,S)=>{X(z,l,g),je(l),R&&R(l,S)}),u=V((l,S)=>{const B=J({timeout:D,style:C,easing:A},{mode:"enter"});l.style.webkitTransition=n.transitions.create("-webkit-transform",{...B}),l.style.transition=n.transitions.create("transform",{...B}),l.style.webkitTransform="none",l.style.transform="none",W&&W(l,S)}),h=V(w),x=V(P),y=V(l=>{const S=J({timeout:D,style:C,easing:A},{mode:"exit"});l.style.webkitTransition=n.transitions.create("-webkit-transform",S),l.style.transition=n.transitions.create("transform",S),X(z,l,g),E&&E(l)}),O=V(l=>{l.style.webkitTransition="",l.style.transition="",k&&k(l)}),p=l=>{j&&j(d.current,l)},L=f.useCallback(()=>{d.current&&X(z,d.current,g)},[z,g]);return f.useEffect(()=>{if(T||z==="down"||z==="right")return;const l=Le(()=>{d.current&&X(z,d.current,g)}),S=he(d.current);return S.addEventListener("resize",l),()=>{l.clear(),S.removeEventListener("resize",l)}},[z,T,g]),f.useEffect(()=>{T||L()},[T,L]),e.jsx(M,{nodeRef:d,onEnter:r,onEntered:h,onEntering:u,onExit:y,onExited:O,onExiting:x,addEndListener:p,appear:I,in:T,timeout:D,...i,children:(l,{ownerState:S,...B})=>f.cloneElement(v,{ref:F,style:{visibility:l==="exited"&&!T?"hidden":void 0,...C,...v.props.style},...B})})}),_e=N(e.jsx("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"})),Xe=N(e.jsx("path",{d:"M21.6 18.2 13 11.75v-.91c1.65-.49 2.8-2.17 2.43-4.05-.26-1.31-1.3-2.4-2.61-2.7C10.54 3.57 8.5 5.3 8.5 7.5h2c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5c0 .84-.69 1.52-1.53 1.5-.54-.01-.97.45-.97.99v1.76L2.4 18.2c-.77.58-.36 1.8.6 1.8h18c.96 0 1.37-1.22.6-1.8M6 18l6-4.5 6 4.5z"})),Ge=N(e.jsx("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54z"})),Ze=N(e.jsx("path",{d:"M3.27 3 2 4.27l5 5V13h3v9l3.58-6.14L17.73 20 19 18.73zM17 10h-4l4-8H7v2.18l8.46 8.46z"})),te=N(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"})),qe=N(e.jsx("path",{d:"M3 6c-.55 0-1 .45-1 1v13c0 1.1.9 2 2 2h13c.55 0 1-.45 1-1s-.45-1-1-1H5c-.55 0-1-.45-1-1V7c0-.55-.45-1-1-1m17-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-2 9h-8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1m-4 4h-4c-.55 0-1-.45-1-1s.45-1 1-1h4c.55 0 1 .45 1 1s-.45 1-1 1m4-8h-8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1"})),Ke=N(e.jsx("path",{d:"m3 2 2.01 18.23C5.13 21.23 5.97 22 7 22h10c1.03 0 1.87-.77 1.99-1.77L21 2zm9 17c-1.66 0-3-1.34-3-3 0-2 3-5.4 3-5.4s3 3.4 3 5.4c0 1.66-1.34 3-3 3m6.33-11H5.67l-.44-4h13.53z"})),Je=N(e.jsx("path",{d:"M3 17v2h6v-2zM3 5v2h10V5zm10 16v-2h8v-2h-8v-2h-2v6zM7 9v2H3v2h4v2h2V9zm14 4v-2H11v2zm-6-4h2V7h4V5h-4V3h-2z"})),et=N(e.jsx("path",{d:"M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8M7.83 14c.37 0 .67.26.74.62.41 2.22 2.28 2.98 3.64 2.87.43-.02.79.32.79.75 0 .4-.32.73-.72.75-2.13.13-4.62-1.09-5.19-4.12-.08-.45.28-.87.74-.87"})),fe=()=>{const c=_(n=>n.items).length,t=oe();return e.jsxs(Q,{sx:{bgcolor:"action.hover"},onClick:()=>t({to:"/checkout"}),children:[e.jsx(de,{}),c>0&&e.jsx(o,{sx:{position:"absolute",top:0,right:0,width:16,height:16,bgcolor:"red",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.65rem",color:"white",fontWeight:"bold",border:"2px solid",borderColor:"background.paper"},children:c})]})},tt=Y.forwardRef(function(c,t){return e.jsx(me,{direction:"up",ref:t,...c})}),rt=({open:s,onClose:c,onScanSuccess:t})=>{const n=f.useRef(null),[a,b]=f.useState(null),[j,I]=f.useState(!0),[v,g]=f.useState(!1),[z,A]=f.useState(!0),[T,R]=f.useState(!1),[w,W]=f.useState(null),[E,k]=f.useState(1),[P,C]=f.useState(1),[D,M]=f.useState(!1),i=f.useCallback(()=>{R(!1),w&&w.stop(),n.current&&n.current.srcObject&&(n.current.srcObject.getTracks().forEach(u=>u.stop()),n.current.srcObject=null)},[w]),d=f.useCallback(async()=>{if(A(!0),b(null),!("BarcodeDetector"in window)){I(!1),A(!1);return}try{const r=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{min:1280,ideal:3840,max:4096},height:{min:720,ideal:2160,max:2160},frameRate:{ideal:30,max:60}}});if(n.current){n.current.srcObject=r;const u=r.getVideoTracks()[0];W(u),await n.current.play();try{const h=u.getCapabilities(),x={advanced:[]};h.zoom&&(M(!0),C(h.zoom.max),k(h.zoom.min||1)),h.focusMode?.includes("continuous")&&x.advanced.push({focusMode:"continuous"}),h.whiteBalanceMode?.includes("continuous")&&x.advanced.push({whiteBalanceMode:"continuous"}),h.exposureMode?.includes("continuous")&&x.advanced.push({exposureMode:"continuous"}),x.advanced.length>0&&await u.applyConstraints(x)}catch(h){console.warn("Advanced constraints not supported:",h)}A(!1),R(!0)}}catch(r){console.error("Error accessing camera:",r),b(r.name==="NotAllowedError"?"Camera permission denied":"Could not access camera"),A(!1)}},[]);f.useEffect(()=>{s?d():i()},[s,d,i]),f.useEffect(()=>{let r,u=0;const h=300,x="BarcodeDetector"in window?new window.BarcodeDetector({formats:["qr_code","ean_13","ean_8","code_128","code_39","upc_a","upc_e"]}):null,y=async O=>{if(!(!T||!n.current||!x)){if(O-u>h){u=O;try{if(n.current.readyState===n.current.HAVE_ENOUGH_DATA){const p=await x.detect(n.current);if(p.length>0){const L=p[0].rawValue;t(L),i();return}}}catch(p){console.error("Detection error:",p)}}r=requestAnimationFrame(y)}};return T&&(r=requestAnimationFrame(y)),()=>{r&&cancelAnimationFrame(r)}},[T,t,i]);const F=async()=>{if(w&&"applyConstraints"in w)try{await w.applyConstraints({advanced:[{torch:!v}]}),g(!v)}catch(r){console.error("Error toggling torch:",r)}},V=async r=>{if(w&&"applyConstraints"in w)try{await w.applyConstraints({advanced:[{zoom:r}]}),k(r)}catch(u){console.error("Error adjusting zoom:",u)}};return e.jsxs(xe,{fullScreen:!0,open:s,onClose:c,TransitionComponent:tt,PaperProps:{sx:{bgcolor:"#000",color:"white",overflow:"hidden"}},children:[e.jsx(ae,{sx:{position:"relative",bgcolor:"transparent",boxShadow:"none"},children:e.jsxs(le,{children:[e.jsx(Q,{edge:"start",color:"inherit",onClick:c,"aria-label":"close",children:e.jsx(ve,{})}),e.jsx(m,{sx:{ml:2,flex:1,fontWeight:700},variant:"h6",children:"Scan Barcode"}),w&&e.jsx(Q,{color:"inherit",onClick:F,children:v?e.jsx(De,{sx:{color:"primary.main"}}):e.jsx(Ze,{})})]})}),e.jsxs(o,{sx:{flex:1,position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",bgcolor:"#000"},children:[z&&e.jsx(o,{sx:{position:"absolute",zIndex:2,display:"flex",flexDirection:"column",alignItems:"center"},children:e.jsx(se,{color:"primary"})}),a&&e.jsxs(o,{sx:{p:4,textAlign:"center",zIndex:2},children:[e.jsx(ee,{severity:"error",sx:{mb:2},children:a}),e.jsx($,{variant:"contained",onClick:d,children:"Retry"})]}),!j&&e.jsxs(o,{sx:{p:4,textAlign:"center",zIndex:2},children:[e.jsx(ee,{severity:"warning",sx:{mb:2},children:"Native barcode scanning is not supported in this browser. Please use Chrome or Edge."}),e.jsx($,{variant:"outlined",color:"inherit",onClick:c,children:"Close"})]}),e.jsxs(o,{sx:{position:"relative",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx("video",{ref:n,style:{width:"100%",height:"100%",objectFit:"cover"},playsInline:!0,muted:!0}),e.jsx(o,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:e.jsx(o,{sx:{width:"280px",height:"280px",border:"2px solid rgba(255, 255, 255, 0.5)",borderRadius:"24px",position:"relative","&::before, &::after":{content:'""',position:"absolute",width:"40px",height:"40px",borderColor:"primary.main",borderStyle:"solid"},"&::before":{top:-2,left:-2,borderTopWidth:4,borderLeftWidth:4,borderBottomWidth:0,borderRightWidth:0,borderTopLeftRadius:"24px"},"&::after":{bottom:-2,right:-2,borderBottomWidth:4,borderRightWidth:4,borderTopWidth:0,borderLeftWidth:0,borderBottomRightRadius:"24px"}},children:e.jsx(o,{sx:{position:"absolute",top:0,left:"10%",width:"80%",height:"2px",bgcolor:"primary.main",boxShadow:"0 0 15px #2196f3",willChange:"transform",animation:"scan 2.5s ease-in-out infinite","@keyframes scan":{"0%":{transform:"translateY(28px)",opacity:0},"50%":{transform:"translateY(140px)",opacity:1},"100%":{transform:"translateY(252px)",opacity:0}}}})})}),e.jsxs(o,{sx:{position:"absolute",bottom:40,display:"flex",gap:2,zIndex:3},children:[D&&e.jsx($,{variant:"contained",sx:{borderRadius:"20px",bgcolor:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)","&:hover":{bgcolor:"rgba(255,255,255,0.3)"}},onClick:()=>V(E===1?Math.min(2,P):1),children:E===1?"2x Zoom":"1x Zoom"}),e.jsx($,{variant:"contained",sx:{borderRadius:"20px",bgcolor:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)","&:hover":{bgcolor:"rgba(255,255,255,0.3)"}},onClick:F,children:v?"Flash Off":"Flash On"})]})]})]})]})},ot=s=>{if(s==null)return"";const c=Math.floor(s).toString(),t=c[0],n=c.slice(1);let a="";return t==="9"?a="N":a=(parseInt(t,10)+1).toString(),`22${n}${a}`},st={shopping_cart:e.jsx(de,{}),search:e.jsx(Ee,{}),tune:e.jsx(Je,{}),favorite:e.jsx(Ge,{}),nutrition:e.jsx(Pe,{}),bolt:e.jsx(Ae,{}),checkroom:e.jsx(Xe,{}),water_drop:e.jsx(et,{}),local_drink:e.jsx(Ke,{}),fitness_center:e.jsx(Fe,{})},nt=Y.forwardRef(function(c,t){return e.jsx(me,{direction:"up",ref:t,...c})}),Z=({name:s,filled:c=!1,className:t=""})=>e.jsx(e.Fragment,{children:st[s]});function Ot(){const s=U(r=>r.activeCategory),c=U(r=>r.setActiveCategory),t=U(r=>r.categories),n=U(r=>r.categoryItems),a=U(r=>r.products),b=U(r=>r.fetchProducts),j=ce(r=>r.fetchRules),I=U(r=>r.isLoading),v=oe(),[g,z]=f.useState(!1);f.useEffect(()=>{navigator.onLine||z(!0)},[]),f.useEffect(()=>{b(),j()},[b]);const[A,T]=f.useState(null),[R,w]=f.useState(""),[W,E]=f.useState(!1),[k,P]=f.useState(!1),[C,D]=f.useState(""),M=(r,u,h=!0)=>{if(!u)return 0;const x=r.toLowerCase(),y=u.toLowerCase();if(x===y)return 100;if(x.startsWith(y))return 80;if(x.includes(y))return 60;if(!h)return 0;let O=0;const p=y.split("");let L=-1;for(const S of p){const B=x.indexOf(S,L+1);B>-1&&(O++,L=B)}const l=O/y.length*40;return l>20?l:0},i=R?a.filter(r=>C?r.category.toLowerCase().includes(C.toLowerCase()):!0).map(r=>{const u=R.trim().toLowerCase().split(/\s+/),h=n.find(y=>y.name===r.category);let x=0;for(const y of u){const O=M(r.name,y,!1)*10,p=r.sku?M(r.sku,y,!0)*8:0,L=h?.sku?M(h.sku,y,!0)*5:0,l=M(r.detail,y,!0),S=M(r.category,y,!1),B=r.id?M(String(r.id),y,!0):0,pe=Math.max(O,p,L,l,S,B);x+=pe}return{...r,searchScore:x}}).filter(r=>r.searchScore>0).sort((r,u)=>(u.searchScore||0)-(r.searchScore||0)):a,d=r=>{c(r),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},400)},F=r=>{T(r),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},400)},V=()=>{T(null),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},400)};return e.jsxs(o,{sx:{pb:10,bgcolor:"background.default",minHeight:"100vh",color:"text.primary"},children:[e.jsxs(o,{sx:{position:"sticky",top:0,zIndex:1100,bgcolor:"background.default",borderBottom:1,borderColor:"divider"},children:[e.jsx(Ne,{title:"Shop Online",icon:e.jsxs(o,{sx:{position:"relative"},children:[e.jsx(ne,{src:Re,sx:{width:40,height:40,border:"2px solid",borderColor:"primary.main"},onClick:()=>v({to:"/admin"})}),e.jsx(o,{sx:{position:"absolute",bottom:0,right:0,width:12,height:12,bgcolor:"primary.main",borderRadius:"50%",border:"2px solid",borderColor:"background.paper"}})]}),rightContent:e.jsxs(e.Fragment,{children:[e.jsx(Te,{sx:{cursor:"pointer",pr:2,color:"text.secondary"},onClick:()=>E(!0)}),e.jsx(qe,{sx:{cursor:"pointer",pr:2,color:"text.secondary"},onClick:()=>v({to:"/history"})}),e.jsx(fe,{})]})}),e.jsxs(o,{sx:{px:2,pt:0,pb:1.5},children:[e.jsxs(o,{sx:{position:"relative"},children:[e.jsx(o,{sx:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",display:"flex",zIndex:100},children:e.jsx(Z,{name:"search"})}),e.jsx(G,{placeholder:"Search supplements, gear...",value:R,onChange:r=>w(r.target.value),onKeyDown:r=>{r.key==="Escape"&&(w(""),r.target.blur())},sx:{width:"100%",bgcolor:"background.paper",borderRadius:4,py:1.5,pl:6,pr:6,border:1,borderColor:"divider","&.Mui-focused":{borderColor:"primary.main",boxShadow:"0 0 0 2px rgba(242, 215, 13, 0.2)"}}}),e.jsx(Q,{onClick:()=>P(!k),sx:{position:"absolute",right:8,top:"50%",transform:"translateY(-50%)",bgcolor:k||C?"primary.main":"action.hover",color:k||C?"common.black":"inherit",p:.5,borderRadius:2,"&:hover":{bgcolor:k||C?"primary.dark":"action.selected"}},children:e.jsx(Z,{name:"tune"})})]}),e.jsx(Ce,{in:k,children:e.jsx(o,{sx:{pt:1},children:e.jsx(G,{placeholder:"Filter categories...",value:C,onChange:r=>D(r.target.value),sx:{width:"100%",bgcolor:"background.paper",borderRadius:3,py:1,px:2,border:1,borderColor:"divider",fontSize:"0.9rem"}})})})]})]}),e.jsx(He,{children:I?e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",py:8},children:e.jsx(se,{})}):e.jsxs(e.Fragment,{children:[!R&&e.jsx(o,{sx:{display:"flex",gap:1.5,overflowX:"auto",pb:2,"&::-webkit-scrollbar":{display:"none"}},children:(()=>{const r=t.filter(x=>x!=="All Items");return(a.some(x=>!x.categoryOnly&&(!x.category||!r.includes(x.category)))?[...t,"Un-grouped"]:t).map(x=>e.jsx(Ue,{label:x,onClick:()=>d(x),sx:{fontWeight:"bold",borderRadius:50,height:40,px:1,bgcolor:"background.paper",color:s===x?"primary.main":"text.secondary",border:1,borderColor:s===x?"primary.main":"divider","&:hover":{bgcolor:s===x?"primary.dark":"action.hover"}}},x))})()}),e.jsx(o,{sx:{px:0,pb:10},children:R?e.jsxs(o,{children:[e.jsxs(m,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:["Search Results (",i.length,")"]}),i.length>0?e.jsx(H,{container:!0,spacing:2,children:i.map(r=>e.jsx(H,{size:{xs:6,sm:6,md:3,lg:2,xl:2},children:e.jsx(K,{product:r,onClick:()=>F(r),setActiveCategory:d})},r.id))}):e.jsx(o,{sx:{textAlign:"center",py:8,opacity:.6},children:e.jsxs(m,{variant:"body1",children:['No products found matching "',R,'"']})})]}):e.jsx(e.Fragment,{children:s==="All Items"?e.jsx(e.Fragment,{children:e.jsx(H,{container:!0,spacing:2,children:(()=>{const r=t.filter(p=>p!=="All Items"),u=a.filter(p=>!p.categoryOnly&&(!p.category||!r.includes(p.category))),h=t.filter(p=>p!=="All Items").filter(p=>!C||p.toLowerCase().includes(C.toLowerCase())),x=[],y=[];h.forEach(p=>{a.filter(l=>l.category===p).length>0?x.push(p):y.push(p)});const O=p=>{const L=n.find(S=>S.name===p);if(!L)return null;const l=a.filter(S=>S.category===p).length;return e.jsx(H,{size:{xs:12,md:4},children:e.jsx(re,{title:p,count:l,products:[L],onProductClick:()=>d(p),onViewAll:()=>d(p),setActiveCategory:d})},p)};return e.jsxs(e.Fragment,{children:[x.map(O),u.length>0&&(!C||"un-grouped".includes(C.toLowerCase()))&&e.jsx(H,{size:{xs:12,md:4},children:e.jsx(re,{title:"Un-grouped",count:u.length,products:[{id:"ungrouped-dummy",name:"Un-grouped Items",detail:"Items not yet categorized",icon:"shopping_cart",sale:!1,isNew:!1,category:"Un-grouped",imageColor:"#f5f5f5",categoryOnly:!0}],onProductClick:()=>d("Un-grouped"),onViewAll:()=>d("Un-grouped"),setActiveCategory:d})},"Un-grouped"),y.length>0&&e.jsx(H,{size:12,children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",my:3},children:[e.jsx(q,{sx:{flex:1}}),e.jsx(m,{variant:"caption",sx:{px:2,fontWeight:"bold",color:"text.secondary",textTransform:"uppercase"},children:"Empty Categories"}),e.jsx(q,{sx:{flex:1}})]})}),y.map(O)]})})()})}):e.jsx(o,{sx:{px:0},children:e.jsx(H,{container:!0,spacing:2,children:(()=>{const r=t.filter(h=>h!=="All Items");let u=a;return s==="Un-grouped"?u=a.filter(h=>!h.categoryOnly&&(!h.category||!r.includes(h.category))):u=a.filter(h=>h.category===s&&!h.categoryOnly),u.map(h=>e.jsx(H,{size:{xs:6,sm:6,md:6,lg:4,xl:4},children:e.jsx(K,{product:h,onClick:()=>F(h),setActiveCategory:d})},h.id))})()})})})})]})}),e.jsx(at,{open:A!==null,handleClose:V,product:A}),e.jsx(rt,{open:W,onClose:()=>E(!1),onScanSuccess:r=>{E(!1),w(r),window.scrollTo({top:0,behavior:"smooth"})}}),e.jsx(Be,{open:g,onContinue:()=>z(!1),onNavigateAway:()=>v({to:"/shop"})})]})}const it=({onClick:s})=>e.jsxs(ie,{onClick:s,sx:{minWidth:120,height:"100%",borderRadius:4,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",bgcolor:"action.hover",border:1,borderColor:"divider",cursor:"pointer","&:hover":{borderColor:"primary.main",bgcolor:"action.selected",transform:"scale(1.02)",transition:"all 0.2s"}},children:[e.jsx(ne,{sx:{bgcolor:"primary.main",mb:1.5,width:48,height:48},children:e.jsx(_e,{sx:{color:"black",fontSize:20,ml:.5}})}),e.jsx(m,{variant:"subtitle2",sx:{fontWeight:800,color:"text.primary"},children:"View All"})]}),re=({title:s,count:c,products:t,onProductClick:n,onViewAll:a,setActiveCategory:b})=>e.jsxs(o,{children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",px:0,mb:1.5},children:[e.jsxs(m,{variant:"h6",sx:{fontWeight:800,textTransform:"uppercase",letterSpacing:.5,fontSize:"0.9rem"},children:[s," ",e.jsxs(m,{component:"span",sx:{color:"text.secondary",fontWeight:600},children:["(",c,")"]})]}),e.jsx($,{size:"small",onClick:a,sx:{fontWeight:700,textTransform:"none",color:"primary.main",minWidth:0,p:0,"&:hover":{bgcolor:"transparent",textDecoration:"underline"}},children:"View all"})]}),e.jsxs(o,{sx:{display:"flex",gap:2,overflowX:"auto",px:2,pb:1,"&::-webkit-scrollbar":{display:"none"},scrollSnapType:"x mandatory","& > *":{scrollSnapAlign:"start"}},children:[t.filter(j=>j.categoryOnly).slice(0,1).map(j=>e.jsx(o,{sx:{minWidth:200,maxWidth:200},children:e.jsx(K,{product:j,onClick:n,setActiveCategory:b})},j.id)),e.jsx(o,{sx:{minWidth:120,py:.5},children:e.jsx(it,{onClick:a})})]})]}),at=({open:s,handleClose:c,product:t})=>{const[n,a]=f.useState(1),[b,j]=f.useState(""),[I,v]=f.useState(""),[g,z]=f.useState(null),A=_(i=>i.addToCart),T=_(i=>i.items),R=_(i=>i.updateQuantity),{rules:w}=ce(),W=T.find(i=>i.id===t?.id&&i.selectedSize?.label===g?.label);if(Y.useEffect(()=>{s&&t&&(W?a(W.quantity):(a(1),j(""),v("")))},[s,t?.id,g?.label]),Y.useEffect(()=>{if(t?.isComplexVariant&&b&&I){const i=Number(b)*Number(I);a(Math.round(i*100)/100)}},[b,I,t?.isComplexVariant]),Y.useEffect(()=>{s&&t&&!g&&t.sizes&&t.sizes.length>0&&z(t.sizes[0])},[s,t]),!t)return null;const E=g?g.price:t.price;let k=0;if(t.taxRuleId){const i=w.find(d=>d.id===t.taxRuleId);i&&(i.valueType==="percentage"?k=E*(i.value/100):k=i.value)}let P=0;t.addonRuleIds&&t.addonRuleIds.length>0&&t.addonRuleIds.forEach(i=>{const d=w.find(F=>F.id===i);d&&(d.valueType==="percentage"?P+=E*(d.value/100):P+=d.value)});const C=E,D=C+k+P,M=()=>{let i=g;t.isComplexVariant&&(i={label:`${b} x ${I} ${t.unitName||"units"}`,price:E}),W?(t.isComplexVariant?T.find(F=>F.id===t.id&&F.selectedSize?.label===i.label):W)?R(t.id,n,i?.label):A({id:t.id,sku:t.sku,name:t.name,buyPrice:C,taxAmount:k,addonAmount:P,totalPrice:D,src:t.src,quantity:n,selectedSize:i,category:t.category,isComplexVariant:t.isComplexVariant,unitName:t.unitName}):A({id:t.id,sku:t.sku,name:t.name,buyPrice:C,taxAmount:k,addonAmount:P,totalPrice:D,src:t.src,quantity:n,selectedSize:i,category:t.category,isComplexVariant:t.isComplexVariant,unitName:t.unitName}),c()};return e.jsx(xe,{fullScreen:!0,open:s,onClose:c,TransitionComponent:nt,PaperProps:{sx:{bgcolor:"background.default",color:"text.primary"}},children:e.jsxs(o,{sx:{position:"relative",display:"flex",flexDirection:"column",height:"100%",maxWidth:"sm",mx:"auto",width:"100%",bgcolor:"background.paper",boxShadow:i=>i.shadows[10]},children:[e.jsx(ae,{sx:{position:"sticky",bgcolor:"background.paper",color:"text.primary",boxShadow:"none",borderBottom:1,borderColor:"divider"},children:e.jsxs(le,{sx:{justifyContent:"space-between",minHeight:56},children:[e.jsx(Q,{edge:"start",onClick:c,"aria-label":"close",size:"small",children:e.jsx(Se,{fontSize:"small"})}),e.jsx(m,{sx:{fontWeight:800,fontSize:"1.1rem",letterSpacing:-.5},variant:"h6",children:"Product Details"}),e.jsx(o,{sx:{position:"relative",display:"flex"},children:e.jsx(fe,{})})]})}),e.jsxs(o,{sx:{flex:1,overflowY:"auto",pb:13},children:[e.jsxs(o,{sx:{width:"100%",aspectRatio:"16/9",bgcolor:"#121212",borderRadius:"0 0 20px 20px",position:"relative",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"inset 0 -10px 20px rgba(0,0,0,0.2)"},children:[t.src&&e.jsx(o,{component:"img",src:t.src,alt:t.name,sx:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}}),e.jsx(o,{sx:{position:"absolute",bottom:12,right:12,bgcolor:"rgba(0,0,0,0.6)",color:"white",px:1.2,py:.4,borderRadius:10,fontSize:11,fontWeight:"bold",backdropFilter:"blur(8px)",zIndex:1},children:"1 / 3"})]}),e.jsxs(o,{sx:{px:2.5,pt:2.5},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:.5},children:[e.jsxs(o,{sx:{flex:1,pr:2},children:[e.jsx(m,{variant:"h6",sx:{fontWeight:800,lineHeight:1.2,mb:.5},children:t.name}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:.5,color:"success.main"},children:[e.jsx(ke,{sx:{fontSize:14}}),e.jsx(m,{variant:"caption",sx:{fontWeight:600},children:"In Stock • Ready to sell"})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:.5,color:"grey.600"},children:[e.jsx(te,{sx:{fontSize:14}}),e.jsx(m,{variant:"caption",sx:{fontWeight:600},children:t.purchasePrice!==void 0&&e.jsxs(m,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.2,fontSize:"0.7rem",fontWeight:600},children:["PID: ",ot(t.purchasePrice.toFixed(0))]})})]}),t.sku&&e.jsxs(m,{variant:"caption",sx:{fontWeight:800,color:"text.disabled",letterSpacing:1,mt:.5,display:"block"},children:["SKU: ",t.sku]})]}),e.jsxs(o,{sx:{textAlign:"right"},children:[e.jsxs(m,{variant:"h6",color:"primary.main",sx:{fontWeight:800,lineHeight:1},children:["₹",D?.toFixed(2)]}),(k>0||P>0)&&e.jsxs(e.Fragment,{children:[e.jsxs(m,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5,fontSize:"0.7rem"},children:["(Base: ₹",C.toFixed(2),")"]}),e.jsxs(m,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.2,fontSize:"0.7rem"},children:["(Tax: ₹",k.toFixed(2),")"]}),e.jsxs(m,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.2,fontSize:"0.7rem"},children:["(Addon: ₹",P.toFixed(2),")"]})]})]})]}),e.jsx(q,{sx:{my:2,opacity:.6}}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(o,{children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1.5},children:[e.jsx(m,{variant:"caption",sx:{fontWeight:800,textTransform:"uppercase",letterSpacing:1,color:"text.secondary"},children:"Size Selection"}),e.jsx($,{variant:"text",size:"small",startIcon:e.jsx(Ie,{sx:{fontSize:"14px !important"}}),sx:{textTransform:"none",color:"text.secondary",fontSize:"0.75rem",fontWeight:600,minWidth:0,p:0},children:"Size Guide"})]}),t.sizes&&t.sizes.length>0?e.jsx(Me,{fullWidth:!0,size:"small",children:e.jsx(Oe,{value:g?g.label:"",onChange:i=>{const d=t.sizes.find(F=>F.label===i.target.value);z(d)},sx:{borderRadius:2,fontWeight:700,fontSize:"0.85rem",bgcolor:"background.paper","& .MuiSelect-select":{py:1}},children:t.sizes.map(i=>e.jsxs(we,{value:i.label,children:[i.label," - ₹",i.price.toFixed(2)]},i.label))})}):e.jsx(m,{variant:"body2",sx:{fontWeight:600,color:"text.secondary",bgcolor:"action.hover",p:1,borderRadius:2,textAlign:"center"},children:"SIngle Variant"})]}),e.jsxs(o,{sx:{bgcolor:"action.hover",borderRadius:3,p:2,display:"flex",alignItems:"flex-start",justifyContent:"space-between"},children:[e.jsx(o,{sx:{flex:1,mr:2},children:t.isComplexVariant?e.jsxs(o,{sx:{width:"100%"},children:[e.jsxs(m,{variant:"caption",sx:{fontWeight:800,textTransform:"uppercase",letterSpacing:.5,color:"text.secondary",display:"block",mb:1},children:["Measurements (",t.unitName,")"]}),e.jsxs(o,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx(G,{type:"number",placeholder:"X",value:b,onChange:i=>j(Number(i.target.value)),sx:{bgcolor:"background.paper",border:1,borderColor:"divider",borderRadius:2,px:2,py:1,width:"100%",fontWeight:"bold"}}),e.jsx(m,{sx:{color:"text.secondary",fontWeight:"bold"},children:"x"}),e.jsx(G,{type:"number",placeholder:"Y",value:I,onChange:i=>v(Number(i.target.value)),sx:{bgcolor:"background.paper",border:1,borderColor:"divider",borderRadius:2,px:2,py:1,width:"100%",fontWeight:"bold"}})]}),e.jsxs(m,{variant:"body2",sx:{mt:1,fontWeight:"bold",color:"primary.main",textAlign:"right"},children:["Total: ",n," ",t.unitName,"²"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(m,{variant:"caption",sx:{fontWeight:800,textTransform:"uppercase",letterSpacing:.5,color:"text.secondary",display:"block",mb:.5},children:"Quantity"}),e.jsx(Ve,{quantity:n,onQuantityChange:a})]})}),e.jsxs(o,{sx:{textAlign:"right",marginTop:"auto",marginBottom:"auto"},children:[e.jsx(m,{variant:"caption",sx:{fontWeight:800,textTransform:"uppercase",letterSpacing:.5,color:"text.secondary",display:"block",mb:.5},children:"Total Value"}),e.jsxs(m,{sx:{fontWeight:900,color:"text.primary",fontSize:"1.1rem"},children:["₹",(D*n).toFixed(2)]})]})]}),e.jsxs(o,{children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(m,{variant:"subtitle1",sx:{fontWeight:800},children:"Description"}),e.jsx(te,{sx:{fontSize:16,color:"text.disabled"}})]}),e.jsx(m,{variant:"body2",color:"text.secondary",sx:{lineHeight:1.6,fontSize:"0.875rem"},children:t.detail}),e.jsxs(o,{sx:{mt:2.5,p:1.5,borderRadius:3,display:"flex",gap:1.5,bgcolor:"primary.light",background:"linear-gradient(135deg, rgba(242, 215, 13, 0.1) 0%, rgba(242, 215, 13, 0.05) 100%)",border:"1px solid rgba(242, 215, 13, 0.2)",alignItems:"center"},children:[e.jsx(o,{sx:{width:36,height:36,borderRadius:"10px",bgcolor:"primary.main",display:"flex",alignItems:"center",justifyContent:"center",color:"common.black",flexShrink:0},children:e.jsx(ze,{sx:{fontSize:18}})}),e.jsxs(o,{children:[e.jsx(m,{sx:{fontWeight:800,fontSize:"0.8rem",color:"text.primary"},children:"Free Desk Delivery"}),e.jsx(m,{sx:{fontSize:"0.7rem",color:"text.secondary",fontWeight:500},children:"Collection available within 2 hours at front desk"})]})]})]})]})]})]}),e.jsx(o,{sx:{position:"fixed",bottom:0,left:0,right:0,p:2,bgcolor:"background.paper",borderTop:1,borderColor:"divider",maxWidth:"sm",mx:"auto",zIndex:10},children:e.jsxs($,{fullWidth:!0,variant:"contained",size:"large",onClick:M,sx:{py:2,borderRadius:4,fontWeight:800,textTransform:"none",fontSize:"1.1rem",bgcolor:W?"success.main":"primary.main",color:W?"white":"black",boxShadow:"0 8px 20px -4px rgba(242, 215, 13, 0.4)","&:hover":{bgcolor:W?"success.dark":"primary.dark"}},children:["Add to Cart • ₹",(D*n).toFixed(2)]})})]})})},K=({product:s,onClick:c,setActiveCategory:t})=>{const a=_(b=>b.items).some(b=>b.id===s.id);return e.jsx(ie,{onClick:()=>{s.categoryOnly?t(s.category):c(s)},sx:{cursor:"pointer",borderRadius:4,height:"100%",display:"flex",flexDirection:"column",bgcolor:"background.paper",border:1,borderColor:"divider",boxShadow:"0 2px 6px -1px rgba(0, 0, 0, 0.1),0 2px 4px -1px rgba(0, 0, 0, 0.06)","&:hover":{borderColor:"primary.main"}},children:e.jsxs($e,{sx:{p:1.5,flex:1,display:"flex",flexDirection:"column"},children:[e.jsxs(o,{sx:{aspectRatio:"1/1",bgcolor:"action.hover",borderRadius:3,mb:1.5,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden"},children:[s.src?e.jsx("img",{loading:"lazy",src:s.src,alt:s.name,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:3}}):e.jsx(Z,{name:s.icon,className:"!text-6xl text-gray-400"}),s.sale&&e.jsx(o,{sx:{position:"absolute",top:8,left:8,bgcolor:"secondary.main",color:"white",fontSize:10,fontWeight:"bold",px:1,py:.25,borderRadius:10,textTransform:"uppercase"},children:"Sale"}),s.isNew&&e.jsx(o,{sx:{position:"absolute",top:8,left:8,bgcolor:"info.main",color:"black",fontSize:10,fontWeight:"bold",px:1,py:.25,borderRadius:10,textTransform:"uppercase"},children:"New"}),e.jsx(Q,{size:"small",sx:{position:"absolute",top:8,right:8,bgcolor:"background.paper",backdropFilter:"blur(4px)",backgroundColor:"#ffffff63",color:"text.secondary","&:hover":{color:"secondary.main"}},children:e.jsx(Z,{name:"favorite",className:"!text-lg"})})]}),e.jsx(m,{variant:"body2",sx:{fontWeight:"bold",lineHeight:1.2,mb:.5,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:s.name}),e.jsx(m,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:s.detail?.length>30?s.detail.substring(0,30)+"...":s.detail}),s.sku&&e.jsxs(m,{variant:"caption",color:"text.disabled",sx:{display:"block",fontWeight:800,fontSize:"0.65rem",mt:.5,letterSpacing:.5},children:["SKU: ",s.sku]}),!s.categoryOnly&&e.jsxs(o,{sx:{mt:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(o,{sx:{display:"flex",flexDirection:"column"},children:e.jsxs(m,{variant:"subtitle1",sx:{fontWeight:"bold",color:s.sale?"primary.main":"text.primary",lineHeight:1},children:["₹",s?.price?.toFixed(2)]})}),e.jsx(Q,{sx:{bgcolor:a?"primary.main":"action.hover",color:a?"black":"text.primary",borderRadius:3,width:36,height:36,"&:hover":{bgcolor:"primary.main",color:"black"}},children:e.jsx(We,{})})]})]})})};export{Ot as component};

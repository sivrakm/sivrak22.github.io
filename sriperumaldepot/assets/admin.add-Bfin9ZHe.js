import{j as e,r as g,C as je,O as be,P as ve,Q as Ce,S as ye}from"./index-DPMeJsKZ.js";import{u as C,A as we,T as Ie,a as Se}from"./productStore-DhwU9xUm.js";import{n as y,C as H,A as G,a as Pe,I as K,P as We,S as Q,N as ke,b as ze,E as Re}from"./index.browser-BfXix5Go.js";import{c as Z,B as s,T as i,a as f,P as R}from"./Button-BIX3GRht.js";import{I as j}from"./IconButton-Hw8WbtNh.js";import{S as c,E as $}from"./ExpandMore-u8U1fPbH.js";import{C as q}from"./Collapse-D-Jz6uJz.js";import{T as u,I as w}from"./TextField-CD6hLXiF.js";import{M as D,D as X,S as De,C as Ae}from"./ShoppingBag-CAKyWGOi.js";import{G as A}from"./Grid-ipB6zE33.js";import{D as J}from"./Delete-F0Bw7Obd.js";import{S as Ee}from"./Search-CwIN95I4.js";import{D as Ne}from"./Dialog-BB6swBfO.js";import{D as Te,a as Fe,b as Oe,c as Ue}from"./DialogTitle-DhoSV6bE.js";import{F as Be}from"./FitnessCenter-B4LKVGkj.js";import"./useThemeProps-8uCsiUgR.js";import"./SwitchBase-Cbn3LxlV.js";import"./Select-C2isiBkS.js";import"./isMuiElement-B1MDafNB.js";import"./Modal-CXJJcq9R.js";const Le=Z([e.jsx("path",{d:"m12 12.9-2.13 2.09c-.56.56-.87 1.29-.87 2.07C9 18.68 10.35 20 12 20s3-1.32 3-2.94c0-.78-.31-1.52-.87-2.07z"},"0"),e.jsx("path",{d:"m16 6-.44.55C14.38 8.02 12 7.19 12 5.3V2S4 6 4 13c0 2.92 1.56 5.47 3.89 6.86-.56-.79-.89-1.76-.89-2.8 0-1.32.52-2.56 1.47-3.5L12 10.1l3.53 3.47c.95.93 1.47 2.17 1.47 3.5 0 1.02-.31 1.96-.85 2.75 1.89-1.15 3.29-3.06 3.71-5.3.66-3.55-1.07-6.9-3.86-8.52"},"1")]),_e=Z(e.jsx("path",{d:"M20 10V8h-4V4h-2v4h-4V4H8v4H4v2h4v4H4v2h4v4h2v-4h4v4h2v-4h4v-2h-4v-4zm-6 4h-4v-4h4z"})),Y=[{value:"tag",label:"Tag",icon:e.jsx(_e,{})},{value:"fitness_center",label:"Dumbbell",icon:e.jsx(Be,{})},{value:"local_fire_department",label:"Fire",icon:e.jsx(Le,{})},{value:"shopping_bag",label:"Bag",icon:e.jsx(De,{})}],Me=[{value:"black",color:"#000000"},{value:"white",color:"#ffffff"},{value:"red",color:"#ef4444"},{value:"blue",color:"#3b82f6"},{value:"yellow",color:"#f2b90d"}];function cr(){const ee=C(r=>r.pushProducttoDb),re=C(r=>r.updateProduct),te=C(r=>r.products),E=C(r=>r.fetchProducts),se=C(r=>r.deleteProduct),N=C(r=>r.categories);g.useState(()=>{E()});const[b,T]=g.useState(null),[oe,F]=g.useState(!1),[P,W]=g.useState(!1),[ie,I]=g.useState(!1),[O,U]=g.useState(null),[B,k]=g.useState({}),[z,ne]=g.useState(""),ae=r=>{k(t=>({...t,[r]:!t[r]}))},le=r=>{const t={...B};r.forEach(o=>{t[o]=!0}),k(t)},ce=()=>{k({})},L=g.useRef(null),de=async r=>{const t=r.target.files?.[0];if(t){F(!0);try{const o=be(ve,`products/${y()}_${t.name}`),a={customMetadata:{imgRefId:String(n.imgRefId),productName:String(n.name||"unnamed")}},v=await Ce(o,t,a),S=await ye(v.ref);p(l=>({...l,src:S}))}catch(o){console.error("Error uploading image: ",o),alert("Failed to upload image.")}finally{F(!1)}}},[n,p]=g.useState({name:"",sku:"",id:y(),imgRefId:y(),category:"",detail:"",price:void 0,originalPrice:void 0,icon:"fitness_center",imageColor:"black",src:"",sale:!1,isNew:!0,sizes:[],categoryOnly:!1}),x=(r,t)=>{p(o=>({...o,[r]:t}))},_=(r,t,o)=>{const a=[...n.sizes||[]];a[r]={...a[r],[t]:o},p(v=>({...v,sizes:a}))},he=()=>{p(r=>({...r,sizes:[...r.sizes||[],{label:"",price:0}]}))},xe=r=>{p(t=>({...t,sizes:t.sizes?.filter((o,a)=>a!==r)}))},ue=r=>{p({...r,imgRefId:r.imgRefId||y()}),T(r.id),W(!0),window.scrollTo({top:0,behavior:"smooth"})},ge=r=>{U(r),I(!0)},pe=async()=>{O&&(await se(O),I(!1),U(null))},M=()=>{p({name:"",sku:"",id:y(),imgRefId:y(),category:"",detail:"",price:void 0,originalPrice:void 0,icon:"fitness_center",imageColor:"black",src:"",sale:!1,isNew:!0,sizes:[],categoryOnly:!1}),T(null),W(!1),window.scrollTo({top:0,behavior:"smooth"})},me=async()=>{try{console.log("Saving product...",n);const r=Object.entries(n).reduce((t,[o,a])=>(a!==void 0&&(o==="price"||o==="originalPrice"?a===""||a===null||isNaN(Number(a))?o==="originalPrice"&&(t[o]=null):t[o]=Number(a):t[o]=a),t),{});if(!r.name||!r.price){alert("Please fill in at least Name and Price");return}b?(await re({...r,id:b}),alert("Product updated successfully!")):(await ee(r),alert("Product saved successfully!")),await E(),M()}catch(r){console.error("Error saving product:",r),alert("Failed to save product")}};return e.jsxs(s,{sx:{minHeight:"100vh",bgcolor:"background.default",pb:10},children:[e.jsx(we,{position:"sticky",color:"default",elevation:0,sx:{bgcolor:"background.paper",borderBottom:1,borderColor:"divider"},children:e.jsxs(Ie,{children:[e.jsx(j,{onClick:()=>window.history.back(),edge:"start",children:e.jsx(Se,{})}),e.jsx(i,{variant:"h6",component:"h1",sx:{flexGrow:1,textAlign:"center",pr:5,fontWeight:"bold"},children:b?"Edit Product":"Add Product"}),b&&e.jsx(f,{color:"inherit",onClick:M,children:"Cancel Edit"})]})}),e.jsxs(H,{maxWidth:"sm",sx:{py:3,display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(s,{sx:{border:1,borderColor:"divider",borderRadius:3,overflow:"hidden",bgcolor:"background.paper"},children:[e.jsxs(s,{onClick:()=>W(!P),sx:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",p:2,bgcolor:"action.hover",transition:"background-color 0.2s","&:hover":{bgcolor:"action.selected"}},children:[e.jsxs(c,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(G,{color:"primary"}),e.jsx(i,{variant:"subtitle1",sx:{fontWeight:"bold"},children:b?"Edit Product Details":"Add New Product"})]}),e.jsx(j,{size:"small",sx:{transform:P?"rotate(180deg)":"none",transition:"transform 0.3s"},children:e.jsx($,{})})]}),e.jsx(q,{in:P,children:e.jsxs(s,{sx:{p:2,display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(s,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:"bold",textTransform:"uppercase"},children:"Product Image"}),e.jsx(u,{fullWidth:!0,placeholder:"Paste image URL here...",value:n.src??"",onChange:r=>x("src",r.target.value),InputProps:{endAdornment:e.jsxs(w,{position:"end",children:[e.jsx(j,{onClick:()=>L.current?.click(),edge:"end",children:oe?e.jsx(je,{size:24}):e.jsx(Pe,{color:"primary"})}),e.jsx("input",{type:"file",hidden:!0,ref:L,accept:"image/*",onChange:de})]}),sx:{borderRadius:3}}}),e.jsx(s,{sx:{mt:2,height:160,borderRadius:3,border:"2px dashed",borderColor:"divider",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden",bgcolor:"action.hover"},children:n.src?e.jsx(s,{component:"img",src:n.src,sx:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsxs(e.Fragment,{children:[e.jsx(K,{sx:{fontSize:40,opacity:.5,mb:1}}),e.jsx(i,{variant:"caption",sx:{opacity:.7},children:"Image preview will appear here"})]})})]}),e.jsxs(c,{spacing:2,children:[e.jsxs(c,{direction:"row",spacing:2,children:[e.jsxs(s,{flex:1,children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Product Name"}),e.jsx(u,{fullWidth:!0,placeholder:"e.g. Protein Whey",value:n.name??"",onChange:r=>x("name",r.target.value)})]}),e.jsxs(s,{width:140,children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"SKU ID"}),e.jsx(u,{fullWidth:!0,placeholder:"PROD-001",value:n.sku||"",onChange:r=>x("sku",r.target.value)})]})]}),e.jsxs(s,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Category"}),e.jsxs(u,{select:!0,fullWidth:!0,value:n.category,onChange:r=>x("category",r.target.value),children:[e.jsx(D,{value:"",disabled:!0,children:"Select Category"}),N.filter(r=>r!=="All Items").map(r=>e.jsx(D,{value:r,children:r},r))]})]}),e.jsxs(s,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Detail"}),e.jsx(u,{fullWidth:!0,multiline:!0,minRows:3,placeholder:"Describe the product features...",value:n.detail??"",onChange:r=>x("detail",r.target.value)})]})]}),e.jsx(s,{sx:{my:1,borderTop:1,borderColor:"divider",borderStyle:"dashed"}}),e.jsxs(A,{container:!0,spacing:2,children:[e.jsxs(A,{size:6,children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Price"}),e.jsx(u,{fullWidth:!0,type:"number",placeholder:"0.00",value:n.price??"",onChange:r=>x("price",r.target.value===""?void 0:Number(r.target.value)),InputProps:{startAdornment:e.jsx(w,{position:"start",children:"₹"})}})]}),e.jsxs(A,{size:6,children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Original Price"}),e.jsx(u,{fullWidth:!0,type:"number",placeholder:"0.00",value:n.originalPrice??"",onChange:r=>x("originalPrice",r.target.value===""?void 0:Number(r.target.value)),InputProps:{startAdornment:e.jsx(w,{position:"start",children:"₹"})}})]})]}),e.jsxs(c,{spacing:2,children:[e.jsxs(s,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Icon"}),e.jsx(u,{select:!0,fullWidth:!0,value:n.icon,onChange:r=>x("icon",r.target.value),InputProps:{startAdornment:e.jsx(w,{position:"start",children:Y.find(r=>r.value===n.icon)?.icon})},children:Y.map(r=>e.jsx(D,{value:r.value,children:e.jsxs(c,{direction:"row",alignItems:"center",spacing:1,children:[r.icon,e.jsx("span",{children:r.label})]})},r.value))})]}),e.jsxs(s,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Image Color"}),e.jsx(c,{direction:"row",spacing:1.5,sx:{overflowX:"auto",py:1},children:Me.map(r=>e.jsx(s,{onClick:()=>x("imageColor",r.value),sx:{width:40,height:40,borderRadius:"50%",bgcolor:r.color,border:r.value==="white"?"1px solid #e5e7eb":"none",cursor:"pointer",ring:n.imageColor===r.value?2:0,ringColor:"primary.main",ringOffset:2,boxShadow:1,transition:"all 0.2s",transform:n.imageColor===r.value?"scale(1.1)":"scale(1)"}},r.value))})]})]}),e.jsxs(R,{variant:"outlined",sx:{borderRadius:3,overflow:"hidden"},children:[e.jsxs(s,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px dashed",borderColor:"divider"},children:[e.jsxs(c,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(s,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:"primary.light",color:"primary.main",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(We,{fontSize:"small"})}),e.jsx(i,{fontWeight:500,children:"On Sale"})]}),e.jsx(Q,{checked:n.sale,onChange:r=>x("sale",r.target.checked)})]}),e.jsxs(s,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(c,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(s,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:"primary.light",color:"primary.main",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ke,{fontSize:"small"})}),e.jsx(i,{fontWeight:500,children:"New Arrival"})]}),e.jsx(Q,{checked:n.isNew,onChange:r=>x("isNew",r.target.checked)})]})]}),e.jsxs(s,{children:[e.jsx(i,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:"Available Sizes"}),e.jsxs(c,{spacing:2,children:[n.sizes?.map((r,t)=>e.jsxs(c,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(u,{sx:{width:180},placeholder:"Label",value:r.label,onChange:o=>_(t,"label",o.target.value),inputProps:{style:{textAlign:"center"}}}),e.jsx(u,{fullWidth:!0,placeholder:"0.00",type:"number",value:r.price,onChange:o=>_(t,"price",Number(o.target.value)),InputProps:{startAdornment:e.jsx(w,{position:"start",children:"₹"})}}),e.jsx(j,{color:"error",onClick:()=>xe(t),sx:{bgcolor:"error.main",color:"white","&:hover":{bgcolor:"error.dark"},borderRadius:2},children:e.jsx(J,{})})]},t)),e.jsx(f,{variant:"outlined",startIcon:e.jsx(G,{}),onClick:he,sx:{py:1.5,borderStyle:"dashed",borderWidth:2,borderRadius:3,"&:hover":{borderWidth:2}},children:"Add Size Variant"})]})]})]})})]}),e.jsxs(s,{sx:{mt:4},children:[e.jsx(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:e.jsx(i,{variant:"h6",sx:{fontWeight:"bold"},children:"Manage Products"})}),e.jsx(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:e.jsx(u,{size:"small",placeholder:"Search name or SKU...",value:z,onChange:r=>ne(r.target.value),InputProps:{startAdornment:e.jsx(w,{position:"start",children:e.jsx(Ee,{fontSize:"small",sx:{opacity:.5}})}),sx:{borderRadius:2,bgcolor:"background.paper"}},sx:{width:"100%"}})}),(()=>{const t=te.filter(l=>{if(!z)return!0;const d=z.toLowerCase();return l.name.toLowerCase().includes(d)||l.sku&&l.sku.toLowerCase().includes(d)}).reduce((l,d)=>{const m=d.category||"Uncategorized";return l[m]||(l[m]=[]),l[m].push(d),l},{}),o=Object.keys(t).sort(),a=N.filter(l=>l!=="All Items"&&!t[l]).sort();a.forEach(l=>{t[l]=[]});const v=[...o,...a],S=l=>l.map(d=>{const m=t[d]?[...t[d]].sort((h,fe)=>h.name.localeCompare(fe.name)):[],V=!!B[d];return e.jsxs(s,{sx:{mb:3},children:[e.jsxs(s,{onClick:()=>ae(d),sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:1.5,bgcolor:"action.selected",borderRadius:2,mb:1,cursor:"pointer"},children:[e.jsxs(i,{variant:"subtitle1",sx:{fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:[d,e.jsx(Ae,{size:"small",label:m.length,sx:{fontWeight:"bold"}})]}),e.jsx(j,{size:"small",sx:{transform:V?"rotate(180deg)":"none",transition:"transform 0.3s"},children:e.jsx($,{})})]}),e.jsx(q,{in:V,children:e.jsx(c,{spacing:2,children:m.length>0?m.map(h=>e.jsx(R,{variant:"outlined",sx:{p:2,borderRadius:2},children:e.jsxs(c,{direction:"row",spacing:2,alignItems:"center",children:[h.src?e.jsx(s,{component:"img",src:h.src,sx:{width:60,height:60,objectFit:"cover",borderRadius:2,bgcolor:"action.hover"}}):e.jsx(s,{sx:{width:60,height:60,borderRadius:2,bgcolor:"action.hover",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(K,{sx:{opacity:.3}})}),e.jsxs(s,{flex:1,children:[e.jsx(i,{fontWeight:600,children:h.name}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["₹",h.price]}),e.jsx(c,{direction:"row",spacing:1,alignItems:"center",children:e.jsx(i,{variant:"caption",color:"text.secondary",children:h.category})}),h.sku&&e.jsxs(i,{variant:"caption",color:"text.secondary",children:["SKU: ",h.sku]})]}),e.jsx(j,{size:"small",onClick:()=>ue(h),children:e.jsx(Re,{})}),e.jsx(j,{size:"small",color:"error",onClick:()=>ge(h.id),children:e.jsx(J,{})})]})},h.id)):e.jsx(i,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic",px:1},children:"No products in this category."})})})]},d)});return e.jsxs(e.Fragment,{children:[v.length>0&&e.jsxs(s,{sx:{display:"flex",gap:1,mb:2},children:[e.jsx(f,{size:"small",variant:"outlined",onClick:()=>le(v),sx:{borderRadius:2,textTransform:"none",fontWeight:"bold",fontSize:"0.75rem"},children:"Expand All"}),e.jsx(f,{size:"small",variant:"outlined",onClick:ce,sx:{borderRadius:2,textTransform:"none",fontWeight:"bold",fontSize:"0.75rem"},children:"Collapse All"})]}),S(o),a.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",my:3},children:[e.jsx(X,{sx:{flex:1}}),e.jsx(i,{variant:"caption",sx:{px:2,fontWeight:"bold",color:"text.secondary",textTransform:"uppercase"},children:"Empty Categories"}),e.jsx(X,{sx:{flex:1}})]}),S(a)]})]})})()]})]}),e.jsx(R,{sx:{position:"fixed",bottom:0,left:0,right:0,p:2,bgcolor:"background.paper",borderTop:1,borderColor:"divider",zIndex:10},elevation:4,children:e.jsx(H,{maxWidth:"sm",children:e.jsx(f,{fullWidth:!0,variant:"contained",size:"large",startIcon:e.jsx(ze,{}),onClick:me,sx:{height:56,borderRadius:3,fontSize:"1.1rem",fontWeight:"bold",boxShadow:2},children:b?"Update Product":"Save Product"})})}),e.jsxs(Ne,{open:ie,onClose:()=>I(!1),PaperProps:{sx:{borderRadius:3,p:1}},children:[e.jsx(Te,{sx:{fontWeight:"bold"},children:"Delete Product?"}),e.jsx(Fe,{children:e.jsx(Oe,{children:"Are you sure you want to delete this product? This action is permanent and cannot be undone."})}),e.jsxs(Ue,{sx:{p:2},children:[e.jsx(f,{onClick:()=>I(!1),color:"inherit",sx:{fontWeight:"bold"},children:"Cancel"}),e.jsx(f,{onClick:pe,variant:"contained",color:"error",sx:{fontWeight:"bold",borderRadius:2},children:"Delete"})]})]})]})}export{cr as component};

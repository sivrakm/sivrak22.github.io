import{B as oe,A as se,r as d,n as ae,E as ie,j as e,v as J,t as K,D as Q,x as ne,y as Y,c as le,p as de,a as ce,u as pe,a1 as xe,z as ue,b as me,d as be}from"./index-u-Pyqm2L.js";import{u as U}from"./cartStore-lozCm6wo.js";import{u as he}from"./orderStore-wEoj8_-G.js";import{u as ge}from"./pricingStore-CZoj9XRo.js";import{C as fe,n as ye}from"./index.browser-CG79L3LT.js";import{T as o,c as O,B as t,a as $}from"./Button-BvdBmECo.js";import{I as G}from"./IconButton-DaXXZkh3.js";import{G as I}from"./Grid-Crx6eLGN.js";import{T as p}from"./TextField-DOiLr8mU.js";import{I as je}from"./InputAdornment-DOgrOArL.js";import{u as ve,f as Ce}from"./Select-DnbZrhwj.js";import{D as Ie}from"./Dialog-DBRFRXpQ.js";import{D as Pe,a as Se,b as ke}from"./DialogTitle-pSFS_agU.js";import{D as De}from"./Delete-BYt5Wo1R.js";import{A as We}from"./Add-B77GNgl9.js";import{D as Ae}from"./Divider-DvTK_4E0.js";import{P as we}from"./Payments-CCPgNHPJ.js";import{C as Me}from"./CheckCircle-CV5t2dZA.js";import{S as ze}from"./ShoppingCart-B-2Pu-5x.js";import{A as Fe}from"./ArrowBack-CSWNx66k.js";import"./SwitchBase-DdQNUR1U.js";import"./useThemeProps--1KHIWKW.js";import"./Modal-DqwB1Nyl.js";import"./dividerClasses-D0LBK0wA.js";function Ne(a){return se("MuiFormControlLabel",a)}const F=oe("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),Re=a=>{const{classes:i,disabled:n,labelPlacement:c,error:h,required:u}=a,W={root:["root",n&&"disabled",`labelPlacement${Q(c)}`,h&&"error",u&&"required"],label:["label",n&&"disabled"],asterisk:["asterisk",h&&"error"]};return ne(W,Ne,i)},Te=K("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(a,i)=>{const{ownerState:n}=a;return[{[`& .${F.label}`]:i.label},i.root,i[`labelPlacement${Q(n.labelPlacement)}`]]}})(Y(({theme:a})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${F.disabled}`]:{cursor:"default"},[`& .${F.label}`]:{[`&.${F.disabled}`]:{color:(a.vars||a).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:i})=>i==="start"||i==="top"||i==="bottom",style:{marginLeft:16}}]}))),Le=K("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(Y(({theme:a})=>({[`&.${F.error}`]:{color:(a.vars||a).palette.error.main}}))),Ue=d.forwardRef(function(i,n){const c=ae({props:i,name:"MuiFormControlLabel"}),{checked:h,className:u,componentsProps:W={},control:P,disabled:q,disableTypography:N,inputRef:g,label:H,labelPlacement:E="end",name:X,onChange:A,required:l,slots:V={},slotProps:f={},value:B,...y}=c,w=ve(),R=q??P.props.disabled??w?.disabled,j=l??P.props.required,M={disabled:R,required:j};["checked","name","onChange","value","inputRef"].forEach(C=>{typeof P.props[C]>"u"&&typeof c[C]<"u"&&(M[C]=c[C])});const T=Ce({props:c,muiFormControl:w,states:["error"]}),m={...c,disabled:R,labelPlacement:E,required:j,error:T.error},S=Re(m),b={slots:V,slotProps:{...W,...f}},[z,v]=ie("typography",{elementType:o,externalForwardedProps:b,ownerState:m});let x=H;return x!=null&&x.type!==o&&!N&&(x=e.jsx(z,{component:"span",...v,className:J(S.label,v?.className),children:x})),e.jsxs(Te,{className:J(S.root,u),ownerState:m,ref:n,...y,children:[d.cloneElement(P,M),j?e.jsxs("div",{children:[x,e.jsxs(Le,{ownerState:m,"aria-hidden":!0,className:S.asterisk,children:[" ","*"]})]}):x]})}),$e=O(e.jsx("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m0 14H4v-6h16zm0-10H4V6h16z"})),Oe=O(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25"})),qe=O(e.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"})),He=O(e.jsx("path",{d:"M17 1.01 7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99M17 19H7V5h10z"})),Ee=le()(de(a=>({shippingDetails:{firstName:"",orgName:"",address:"",zip:"",city:"",phoneNumber:""},setShippingDetails:i=>a({shippingDetails:i})}),{name:"shipping-storage"})),Ve={arrow_back:e.jsx(Fe,{}),shopping_cart:e.jsx(ze,{}),check_circle:e.jsx(Me,{}),credit_card:e.jsx($e,{}),help:e.jsx(Oe,{}),lock:e.jsx(qe,{}),payments:e.jsx(we,{}),upi:e.jsx(He,{})},D=({name:a,filled:i=!1,className:n=""})=>e.jsx(e.Fragment,{children:Ve[a]});function br(){const[a,i]=d.useState("upi"),[n,c]=d.useState(!1),h=ce(),u=U(r=>r.items),W=U(r=>r.getTotalItems),P=U(r=>r.getTotalPrice),q=U(r=>r.clearCart),N=pe(r=>r.user),{shippingDetails:g,setShippingDetails:H}=Ee(),E=he(r=>r.setLastOrder),{fetchDeliveryConfig:X,deliveryConfig:A}=ge();d.useState(()=>{X()});const[l,V]=d.useState({firstName:g.firstName,orgName:g.orgName,address:g.address,zip:g.zip,city:g.city,phoneNumber:g.phoneNumber||N?.phoneNumber||""}),[f,B]=d.useState([]),[y,w]=d.useState(null),[R,j]=d.useState(!1),[M,T]=d.useState(""),[m,S]=d.useState(""),b=r=>s=>{V({...l,[r]:s.target.value})},z=P(),v=u.reduce((r,s)=>r+(s.taxAmount||0)*s.quantity,0),x=u.reduce((r,s)=>r+(s.addonAmount||0)*s.quantity,0),C=f.reduce((r,s)=>r+s.amount,0),k=x+C,L=y!==null?y:A.enabled?A.amount:0,_=z+v+k+L,ee=W(),re=async()=>{if(!n){c(!0);try{H(l);const r={userId:N?.uid||"guest",shippingDetails:l,items:u,subtotal:z,tax:v,itemAddons:x,orderAddons:C,addons:k,manualAddons:f,deliveryAmount:L,total:_,paymentMethod:a,status:"pending",timestamp:xe()},s=await ue(me(be,"orders"),r);E({...r,id:s.id}),q(),h({to:"/orders"})}catch(r){console.error("Error placing order:",r),alert("Failed to place order. Please try again.")}finally{c(!1)}}};return e.jsxs(t,{sx:{pb:30,bgcolor:"background.default",minHeight:"100vh",color:"text.primary",position:"relative"},children:[e.jsx(t,{sx:{position:"sticky",top:0,zIndex:1100,bgcolor:"background.default/90",backdropFilter:"blur(20px)",borderBottom:1,borderColor:"divider"},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:2,height:64},children:[e.jsx(G,{sx:{ml:-1,bgcolor:"action.hover"},onClick:()=>h({to:"/checkout"}),children:e.jsx(D,{name:"arrow_back"})}),e.jsx(o,{variant:"h6",sx:{fontWeight:"bold"},children:"Checkout"}),e.jsx(t,{sx:{width:40}})," "]})}),e.jsxs(t,{sx:{p:2,display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1.5},children:[e.jsx(o,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",textTransform:"uppercase",letterSpacing:1},children:"Order Summary"}),e.jsx($,{size:"small",onClick:()=>h({to:"/checkout"}),sx:{fontSize:"0.75rem",fontWeight:500,color:"info.main",minWidth:"auto",p:0,"&:hover":{color:"text.primary",bgcolor:"transparent"}},children:"Edit Cart"})]}),e.jsx(t,{sx:{bgcolor:"background.paper",borderRadius:3,border:1,borderColor:"divider",p:2,boxShadow:"none"},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(t,{sx:{display:"flex",ml:1.5},children:e.jsx(t,{sx:{width:48,height:48,bgcolor:"action.hover",borderRadius:2,border:2,borderColor:"background.paper",display:"flex",alignItems:"center",justifyContent:"center",zIndex:30,ml:-1.5},children:e.jsx(D,{name:"shopping_cart",className:"!text-xl text-text-secondary"})})}),e.jsxs(t,{sx:{flex:1,minWidth:0,display:"flex",flexDirection:"column",justifyContent:"center"},children:[e.jsxs(o,{variant:"body2",style:{fontWeight:"bold",whiteSpace:"nowrap"},children:[ee," Items"]}),e.jsx(t,{style:{color:"text.secondary",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:u.map((r,s)=>e.jsxs(o,{variant:"body2",children:[r.quantity," x ",r.selectedSize?.label.slice(0,5),"..,",r.name.slice(0,10),".."]},`${r.id}-${r.selectedSize?.label||"default"}-${s}`))})]})]})}),e.jsxs(t,{sx:{mb:2.5,px:0,pt:2},children:[e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:1,mb:1.5},children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{minWidth:100},children:"Subtotal"}),e.jsxs(o,{variant:"body2",color:"text.primary",sx:{fontWeight:500,textAlign:"right"},children:["₹",z.toFixed(2)]})]}),v>0&&e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{minWidth:100},children:"Tax"}),e.jsxs(o,{variant:"body2",color:"text.primary",sx:{fontWeight:500,textAlign:"right"},children:["₹",v.toFixed(2)]})]}),k!==0&&e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{minWidth:100},children:"Add-ons/Discounts"}),e.jsxs(o,{variant:"body2",color:k>0?"text.primary":"error.main",sx:{fontWeight:500,textAlign:"right"},children:[k<0?"-":"","₹",Math.abs(k).toFixed(2)]})]}),(L!==0||y!==null)&&e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{minWidth:100},children:"Delivery"}),e.jsxs(o,{variant:"body2",color:"text.primary",sx:{fontWeight:500,textAlign:"right"},children:["₹",L.toFixed(2)]})]})]}),e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pt:1.5,borderTop:"1px dashed",borderColor:"divider"},children:[e.jsx(o,{variant:"body1",sx:{fontWeight:"bold",minWidth:100},children:"Total"}),e.jsxs(o,{variant:"h6",sx:{fontWeight:"bold",color:"primary.main",textAlign:"right"},children:["₹",_.toFixed(2)]})]}),e.jsx(t,{sx:{display:"flex",justifyContent:"flex-end",mt:1},children:e.jsx($,{size:"small",onClick:()=>{y===null&&w(A.enabled?A.amount:0),j(!0)},sx:{fontSize:"0.75rem",fontWeight:500,color:"primary.main",p:0},children:"Edit Pricing"})})]})]}),e.jsxs(t,{children:[e.jsx(o,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",textTransform:"uppercase",letterSpacing:1,display:"block",mb:1.5},children:"Shipping Address"}),e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[e.jsxs(I,{container:!0,spacing:1.5,children:[e.jsx(I,{size:12,children:e.jsx(p,{label:"First Name",variant:"filled",fullWidth:!0,value:l.firstName,onChange:b("firstName"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})}),e.jsx(I,{size:12,children:e.jsx(p,{label:"Organization Name",variant:"filled",fullWidth:!0,value:l.orgName,onChange:b("orgName"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})}),e.jsx(I,{size:12,children:e.jsx(p,{label:"Phone Number",variant:"filled",fullWidth:!0,placeholder:"+91 99999 99999",value:l.phoneNumber,onChange:b("phoneNumber"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})})]}),e.jsx(p,{label:"Address",variant:"filled",fullWidth:!0,value:l.address,onChange:b("address"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}}),e.jsxs(I,{container:!0,spacing:1.5,children:[e.jsx(I,{size:4,children:e.jsx(p,{label:"Zip Code",variant:"filled",fullWidth:!0,value:l.zip,onChange:b("zip"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})}),e.jsx(I,{size:8,children:e.jsx(p,{label:"City",variant:"filled",fullWidth:!0,value:l.city,onChange:b("city"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})})]})]})]}),e.jsxs(t,{children:[e.jsx(o,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",textTransform:"uppercase",letterSpacing:1,display:"block",mb:1.5},children:"Payment Method"}),e.jsx(t,{sx:{display:"flex",gap:1.5,mb:2,overflowX:"auto",pb:.5},children:["upi","payments"].map(r=>{const s=a===r,Z={upi:"UPI",payments:"Cash"};return e.jsxs(t,{component:"button",onClick:()=>i(r),sx:{flex:1,minWidth:110,p:1.5,borderRadius:3,border:s?2:1,borderColor:s?"primary.main":"divider",bgcolor:s?"rgba(103, 103, 103, 0.1)":"background.paper",display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",height:80,position:"relative",transition:"all 0.2s","&:active":{transform:"scale(0.95)"}},children:[s&&e.jsx(t,{sx:{position:"absolute",top:8,right:8,color:"primary.main"},children:e.jsx(D,{name:"check_circle",filled:!0})}),e.jsx(t,{sx:{color:s?"primary.main":"text.secondary"},children:e.jsx(D,{name:r})}),e.jsx(o,{variant:"caption",sx:{fontWeight:s?"bold":"medium",color:s?"text.primary":"text.secondary"},children:Z[r]})]},r)})}),a==="upi"&&e.jsxs(t,{sx:{bgcolor:"background.paper",borderRadius:3,border:1,borderColor:"divider",p:2,display:"flex",flexDirection:"column",gap:1.5},children:[e.jsx(p,{label:"UPI ID",variant:"filled",fullWidth:!0,placeholder:"username@bank",defaultValue:"mystore@a123bank",disabled:!0,sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"action.hover",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0,endAdornment:e.jsx(je,{position:"end",children:e.jsx(D,{name:"upi",className:"text-text-disabled"})})}}),e.jsx(o,{variant:"caption",color:"text.secondary",sx:{px:.5},children:"Securely pay using your favorite UPI app (GPay, PhonePe, Paytm, etc)."})]}),e.jsx(t,{sx:{display:"flex",alignItems:"center",mt:2},children:e.jsx(Ue,{control:e.jsx(fe,{defaultChecked:!0,sx:{color:"text.secondary","&.Mui-checked":{color:"primary.main"}}}),label:e.jsx(o,{variant:"body2",color:"text.secondary",children:"Save this VPA for future purchases"})})})]})]}),e.jsx(t,{sx:{position:"fixed",bottom:0,left:0,right:0,bgcolor:"background.paper",borderTop:1,borderColor:"divider",p:3,pb:4,borderTopLeftRadius:24,borderTopRightRadius:24,boxShadow:"0 -8px 30px rgba(0,0,0,0.1)",zIndex:1e3},children:e.jsxs($,{variant:"contained",color:"primary",fullWidth:!0,size:"large",sx:{borderRadius:4,py:2,variant:"contained",color:"primary",fontSize:"1rem",fontWeight:"bold",textTransform:"none",boxShadow:"0 8px 20px -4px rgba(242, 238, 13, 0.3)",display:"flex",justifyContent:"center",gap:1.5},onClick:re,disabled:n,children:[e.jsx(D,{name:"lock"}),n?"Processing...":`Place Order • Rs ${_.toFixed(2)}`]})}),e.jsxs(Ie,{open:R,onClose:()=>j(!1),maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{borderRadius:4,bgcolor:"background.paper"}},children:[e.jsx(Pe,{sx:{fontWeight:"bold"},children:"Edit Pricing"}),e.jsx(Se,{children:e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsx(o,{variant:"subtitle2",sx:{fontWeight:"bold",color:"text.secondary"},children:"Addons / Discounts"}),e.jsx(t,{sx:{display:"flex",flexDirection:"column",gap:1},children:f.map((r,s)=>e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",bgcolor:"action.hover",p:1,borderRadius:2},children:[e.jsx(o,{variant:"body2",children:r.label}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(o,{variant:"body2",sx:{fontWeight:"bold"},children:["₹",r.amount.toFixed(2)]}),e.jsx(G,{size:"small",color:"error",onClick:()=>B(f.filter((Z,te)=>te!==s)),children:e.jsx(De,{fontSize:"small"})})]})]},s))}),e.jsxs(t,{sx:{display:"flex",gap:1},children:[e.jsx(p,{label:"Description",variant:"outlined",size:"small",fullWidth:!0,value:M,onChange:r=>T(r.target.value)}),e.jsx(p,{label:"Amount",type:"number",variant:"outlined",size:"small",sx:{width:100},value:m,onChange:r=>S(r.target.value)}),e.jsx(G,{color:"primary",onClick:()=>{if(m){const r=M||`manual-${ye(5)}`;B([...f,{label:r,amount:Number(m)}]),T(""),S("")}},children:e.jsx(We,{})})]}),e.jsx(Ae,{sx:{my:1}}),e.jsx(o,{variant:"subtitle2",sx:{fontWeight:"bold",color:"text.secondary"},children:"Delivery Charge"}),e.jsx(p,{label:"Delivery Amount",type:"number",variant:"outlined",fullWidth:!0,value:y??0,onChange:r=>w(Number(r.target.value)),helperText:"Set to 0 to remove delivery charge"})]})}),e.jsx(ke,{sx:{p:2},children:e.jsx($,{onClick:()=>j(!1),fullWidth:!0,variant:"contained",sx:{borderRadius:3,py:1.5,fontWeight:"bold"},children:"Done"})})]})]})}export{br as component};

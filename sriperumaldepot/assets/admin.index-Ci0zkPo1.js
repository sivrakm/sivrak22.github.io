import{j as e,a as K,r as h,C as Q,b as F,d as D,q as M,o as L,w as R,g as H,e as Y,f as X}from"./index-D6Ims6lA.js";import{p as Z}from"./printInvoice-jRRD6ymd.js";import{c as u,B as t,T as n,a as j}from"./Button-CSdwMSvw.js";import{H as _}from"./Header-W2LZm1Nr.js";import{A as I}from"./Avatar-DeualJy0.js";import{P as ee}from"./Page-CkbXrPWE.js";import{G as c}from"./Grid-70wYpfNu.js";import{S as w}from"./ShoppingCart-DH1yXO0y.js";import{S as k}from"./Stack-CDybcgVS.js";import{C as T}from"./Card-BqCIStG6.js";import{I as se}from"./IconButton-p7-xcs9z.js";import{E as te}from"./ExpandMore-DPhG_8mo.js";import{C as re}from"./Collapse-CkKghRFb.js";import{C as q}from"./CardContent-BsTwSeb9.js";import{C as ne}from"./CheckCircle-CdOf2QXI.js";import{C as oe,I as ie,H as ae}from"./Inventory2-Kfd_mQKZ.js";import{L as ce}from"./LocalShipping-CHFllEK-.js";import"./useThemeProps-Dxe8bh_K.js";const le=u([e.jsx("path",{d:"M17 11c.34 0 .67.04 1 .09V6.27L10.5 3 3 6.27v4.91c0 4.54 3.2 8.79 7.5 9.82.55-.13 1.08-.32 1.6-.55-.69-.98-1.1-2.17-1.1-3.45 0-3.31 2.69-6 6-6"},"0"),e.jsx("path",{d:"M17 13c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 1.38c.62 0 1.12.51 1.12 1.12s-.51 1.12-1.12 1.12-1.12-.51-1.12-1.12.5-1.12 1.12-1.12m0 5.37c-.93 0-1.74-.46-2.24-1.17.05-.72 1.51-1.08 2.24-1.08s2.19.36 2.24 1.08c-.5.71-1.31 1.17-2.24 1.17"},"1")]),de=u([e.jsx("path",{d:"m12 2-5.5 9h11z"},"0"),e.jsx("circle",{cx:"17.5",cy:"17.5",r:"4.5"},"1"),e.jsx("path",{d:"M3 13.5h8v8H3z"},"2")]),xe=u(e.jsx("path",{d:"M20 2H4c-1 0-2 .9-2 2v3.01c0 .72.43 1.34 1 1.69V20c0 1.1 1.1 2 2 2h14c.9 0 2-.9 2-2V8.7c.57-.35 1-.97 1-1.69V4c0-1.1-1-2-2-2m-5 12H9v-2h6zm5-7H4V4l16-.02z"})),pe=u(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16"})),he=u(e.jsx("path",{d:"m16 6 2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"}));function We(){const i=K(),[l,x]=h.useState([]),[m,v]=h.useState(!0),[E,P]=h.useState(0),[N,A]=h.useState(0),[C,V]=h.useState(null),S=(s,o)=>{try{const r=Y(D,"orders",s);X(r,{status:o}),(async()=>{try{const d=F(D,"orders"),g=M(d,L("timestamp","desc"),R("status","==","pending")),b=(await H(g)).docs.map(f=>({id:f.id,...f.data()}));x(b);const p=b.length,z=b.reduce((f,J)=>f+(Number(J.total)||0),0);A(p),P(Number(z.toFixed(2)))}catch(d){console.error("Error refreshing data:",d)}})()}catch(r){console.error("Error updating order status:",r),alert("Failed to update order status")}},B=s=>{if(!s)return"Just now";const o=s.toDate(),a=new Date().getTime()-o.getTime(),d=Math.floor(a/(1e3*60*60*24));return d===0?`Today, ${o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:d===1?`Yesterday, ${o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:o.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},U=s=>{V(C===s?null:s)},G=s=>{const o=l.find(r=>r.id===s);Z(o)};h.useEffect(()=>{const s=async()=>{try{const r=F(D,"orders"),a=M(r,L("timestamp","desc"),R("status","==","pending")),g=(await H(a)).docs.map(p=>({id:p.id,...p.data()}));x(g);const W=g.length,b=g.reduce((p,z)=>p+(Number(z.total)||0),0);A(W),P(Number(b.toFixed(2)))}catch(r){console.error("Error fetching dashboard data:",r)}finally{v(!1)}};s();const o=setInterval(s,3e4);return()=>clearInterval(o)},[]);const $=s=>{switch(s?.toLowerCase()){case"pending":case"processing":return{label:"Processing",icon:e.jsx(ae,{fontSize:"small"}),color:"warning.main",bgcolor:"rgba(237, 108, 2, 0.1)",borderColor:"rgba(237, 108, 2, 0.2)"};case"shipped":return{label:"Shipped",icon:e.jsx(ce,{fontSize:"small"}),color:"info.main",bgcolor:"rgba(2, 136, 209, 0.1)",borderColor:"rgba(2, 136, 209, 0.2)"};case"delivered":return{label:"Delivered",icon:e.jsx(ie,{fontSize:"small"}),color:"success.main",bgcolor:"rgba(46, 125, 50, 0.1)",borderColor:"rgba(46, 125, 50, 0.2)"};case"cancelled":return{label:"Cancelled",icon:e.jsx(oe,{fontSize:"small"}),color:"error.main",bgcolor:"rgba(211, 47, 47, 0.1)",borderColor:"rgba(211, 47, 47, 0.2)"};default:return{label:s||"Unknown",icon:e.jsx(ne,{fontSize:"small"}),color:"text.secondary",bgcolor:"action.hover",borderColor:"divider"}}};return e.jsxs(t,{sx:{pb:10,bgcolor:"background.default",minHeight:"100vh",color:"text.primary"},children:[e.jsxs(t,{sx:{position:"sticky",top:0,zIndex:1100,bgcolor:"background.default",borderBottom:1,borderColor:"divider"},children:[e.jsx(_,{title:"Admin Portal",icon:e.jsx(I,{sx:{bgcolor:"secondary.main"},children:e.jsx(le,{})})}),e.jsxs(t,{sx:{px:3,pb:2},children:[e.jsx(n,{variant:"h5",sx:{fontWeight:"bold"},children:"Dashboard"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Overview of your store performance"})]})]}),e.jsxs(ee,{children:[e.jsx(t,{sx:{px:2,py:2},children:e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{size:{xs:12,sm:12,md:6,lg:6},children:e.jsx(O,{icon:e.jsx(he,{}),label:"Pending Money(Rs)",value:E,color:"success.main",bgcolor:"rgba(46, 125, 50, 0.1)"})}),e.jsx(c,{size:{xs:12,sm:12,md:6,lg:6},children:e.jsx(O,{icon:e.jsx(w,{}),label:"Pending Count",value:N,color:"primary.main",bgcolor:"rgba(25, 118, 210, 0.1)"})})]})}),e.jsxs(t,{sx:{px:2,py:2},children:[e.jsx(n,{variant:"h6",sx:{fontWeight:"bold",mb:2,textTransform:"uppercase",letterSpacing:1,fontSize:"0.9rem"},children:"Management"}),e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{size:4,children:e.jsx(y,{icon:e.jsx(xe,{}),label:"Products",onClick:()=>i({to:"/admin/add"}),color:"primary.main"})}),e.jsx(c,{size:4,children:e.jsx(y,{icon:e.jsx(de,{}),label:"Category",onClick:()=>i({to:"/admin/addcat"}),color:"secondary.main"})}),e.jsx(c,{size:4,children:e.jsx(y,{icon:e.jsx(w,{}),label:"Orders",onClick:()=>i({to:"/admin/orders"}),color:"warning.main"})}),e.jsx(c,{size:4,children:e.jsx(y,{icon:e.jsx(pe,{}),label:"Pricing",onClick:()=>i({to:"/admin/pricing"}),color:"success.main"})})]})]}),e.jsxs(t,{sx:{px:2,py:2},children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(n,{variant:"h6",sx:{fontWeight:"bold",textTransform:"uppercase",letterSpacing:1,fontSize:"0.9rem"},children:"Recent Orders"}),e.jsx(j,{size:"small",onClick:()=>i({to:"/admin/orders"}),children:"View All"})]}),m?e.jsx(t,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(Q,{size:30})}):l.length===0?e.jsx(n,{color:"text.secondary",align:"center",children:"No orders found."}):e.jsx(k,{spacing:2,children:l.map(s=>{const o=$(s.status);return e.jsx(T,{sx:{p:2,borderRadius:3,border:1,borderColor:"divider",boxShadow:"none",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",transition:"all 0.2s","&:active":{transform:"scale(0.98)"}},onClick:()=>U(s.id),children:e.jsxs(t,{sx:{width:"100%"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(I,{sx:{width:48,height:48,bgcolor:o.bgcolor||"action.selected",color:o.color,border:1,borderColor:"divider"},children:o.icon}),e.jsxs(t,{children:[e.jsxs(n,{variant:"body2",sx:{fontWeight:"bold"},children:["#",s.id.slice(0,5).toUpperCase()]}),e.jsx(n,{variant:"caption",sx:{color:"text.secondary",mt:.5,display:"block"},children:B(s.timestamp)})]})]}),e.jsxs(t,{sx:{textAlign:"right",display:"flex",alignItems:"center",gap:1},children:[e.jsxs(t,{children:[e.jsxs(n,{variant:"body2",sx:{fontWeight:"bold"},children:["₹",s.total?.toLocaleString()]}),e.jsx(t,{sx:{display:"inline-block",mt:.5,px:1.5,py:.25,borderRadius:10,bgcolor:o.color+"1A",color:o.color,fontSize:"0.625rem",fontWeight:"bold",textTransform:"uppercase",letterSpacing:.5},children:o.label})]}),e.jsx(se,{size:"small",sx:{transform:C===s.id?"rotate(180deg)":"none",transition:"transform 0.3s"},children:e.jsx(te,{})})]})]}),e.jsxs(re,{in:C===s.id,timeout:"auto",unmountOnExit:!0,children:[e.jsxs(t,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:[e.jsx(n,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",mb:1.5,display:"block",textTransform:"uppercase",letterSpacing:.5},children:"Details"}),e.jsxs(n,{variant:"caption",sx:{fontWeight:"bold",color:"text.primary",mb:1.5,display:"block",textTransform:"uppercase",letterSpacing:.5},children:[s?.timestamp>0&&e.jsxs(e.Fragment,{children:["Time: ",s?.timestamp?.toDate().toLocaleString()," ",e.jsx("br",{})]}),s.total>0&&e.jsxs(e.Fragment,{children:["Total: ₹",s.total," ",e.jsx("br",{})]}),s.subtotal>0&&e.jsxs(e.Fragment,{children:["Subtotal: ₹",s.subtotal?.toFixed(2)," ",e.jsx("br",{})]}),s.tax>0&&e.jsxs(e.Fragment,{children:["Tax: ₹",s.tax?.toFixed(2)," ",e.jsx("br",{})]}),s.itemAddons>0&&e.jsxs(e.Fragment,{children:["Item Addons: ₹",s.itemAddons?.toFixed(2)," ",e.jsx("br",{})]}),s.manualAddons?.map((r,a)=>e.jsxs("span",{children:[r.label,": ",r.amount<0?"-":"","₹",Math.abs(r.amount).toFixed(2),e.jsx("br",{})]},a)),!s.itemAddons&&!s.manualAddons&&s.addons>0&&e.jsxs(e.Fragment,{children:["Addons: ₹",s.addons?.toFixed(2),e.jsx("br",{})]}),s.deliveryAmount>0&&e.jsxs(e.Fragment,{children:["Delivery: ₹",s.deliveryAmount?.toFixed(2),e.jsx("br",{})]})]})]}),e.jsxs(t,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:[e.jsx(n,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",mb:1.5,display:"block",textTransform:"uppercase",letterSpacing:.5},children:"Shipping"}),e.jsxs(n,{variant:"caption",sx:{fontWeight:"bold",color:"text.primary",mb:1.5,display:"block",textTransform:"uppercase",letterSpacing:.5},children:[s.shippingDetails?.firstName," ",s.shippingDetails?.lastName,e.jsx("br",{}),s.shippingDetails?.phoneNumber,e.jsx("br",{}),s.shippingDetails?.address,", ",s.shippingDetails?.city]})]}),e.jsxs(t,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:[e.jsx(n,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",mb:1.5,display:"block",textTransform:"uppercase",letterSpacing:.5},children:"Items"}),e.jsx(k,{spacing:1.5,children:s.items?.map((r,a)=>e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(t,{sx:{width:32,height:32,bgcolor:"action.hover",borderRadius:1.5,display:"flex",alignItems:"center",justifyContent:"center",color:"text.secondary"},children:e.jsx(w,{sx:{fontSize:"1.25rem"}})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(n,{variant:"body2",sx:{fontWeight:"bold"},children:r.name}),e.jsxs(n,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:[r.selectedSize?.label||"Single"," | Qty: ",r.quantity]}),r.sku&&e.jsxs(n,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:["SKU: ",r.sku]})]}),e.jsxs(n,{variant:"body2",sx:{fontWeight:600},children:["₹",(r.buyPrice*r.quantity).toLocaleString()]})]},a))}),e.jsxs(k,{direction:"row",spacing:1,sx:{mt:2},children:[e.jsx(j,{size:"small",variant:"outlined",color:"success",onClick:()=>S(s.id,"Delivered"),children:"Delivered"}),e.jsx(j,{size:"small",variant:"outlined",color:"error",onClick:()=>S(s.id,"Cancelled"),children:"Cancelled"}),e.jsx(j,{size:"small",variant:"outlined",color:"warning",onClick:()=>S(s.id,"Processing"),children:"Processing"}),e.jsx(j,{size:"small",variant:"contained",color:"success",onClick:()=>G(s.id),children:"Print"})]})]})]})]})},s.id)})})]})]})]})}const y=({icon:i,label:l,onClick:x,color:m})=>e.jsx(T,{sx:{borderRadius:3,cursor:"pointer",textAlign:"center",border:1,borderColor:"divider",boxShadow:"none",transition:"all 0.2s","&:active":{transform:"scale(0.95)"},"&:hover":{bgcolor:"action.hover"}},onClick:x,children:e.jsxs(q,{sx:{p:2,"&:last-child":{pb:2}},children:[e.jsx(t,{sx:{color:m,display:"flex",justifyContent:"center",mb:1},children:i}),e.jsx(n,{variant:"caption",sx:{fontWeight:"bold"},children:l})]})}),O=({icon:i,label:l,value:x,color:m,bgcolor:v})=>e.jsx(T,{sx:{borderRadius:3,border:1,borderColor:"divider",boxShadow:"none"},children:e.jsxs(q,{sx:{p:2,display:"flex",alignItems:"center",gap:2,"&:last-child":{pb:2}},children:[e.jsx(I,{sx:{bgcolor:v,color:m,width:40,height:40},children:i}),e.jsxs(t,{children:[e.jsx(n,{variant:"caption",color:"text.secondary",sx:{fontWeight:600},children:l}),e.jsx(n,{variant:"h6",sx:{fontWeight:"bold",lineHeight:1},children:x})]})]})});export{We as component};

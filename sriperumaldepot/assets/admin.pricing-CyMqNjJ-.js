import{r as i,j as e,C as M}from"./index-BrftD8ME.js";import{u as V}from"./pricingStore-CDIHPSHB.js";import{B as t,T as s,a as o,P as j}from"./Button-CJN5vbBf.js";import{A as H,T as q,a as J,C as A,M as R}from"./ArrowBackIosNew-CKmh_qYH.js";import{I as d}from"./IconButton-9fU6RE08.js";import{P as K}from"./Page-BvvfCohJ.js";import{C as Q,E as S,S as U}from"./Edit-C4X_xSXy.js";import{G as x}from"./Grid-BjII6Q-Z.js";import{A as W}from"./Add-9t-ZeTiu.js";import{S as b}from"./Stack-BbyMH-el.js";import{D as I}from"./Delete-q3P4uv6_.js";import{T as u}from"./TextField-F5gMl4zx.js";import{D as X}from"./Dialog-LUgSli6X.js";import{D as Y,a as Z,b as _}from"./DialogTitle-Ck_HpUr9.js";import"./Select-ua_mlDYE.js";import"./Modal-LR47lFSl.js";import"./useThemeProps-DhpRE2cF.js";import"./SwitchBase-BXtKTsm0.js";function je(){const{rules:v,fetchRules:P,addRule:z,updateRule:E,deleteRule:B,isLoading:F,deliveryConfig:y,fetchDeliveryConfig:N,updateDeliveryConfig:G}=V();i.useEffect(()=>{P(),N()},[]);const[$,C]=i.useState(!1),[h,T]=i.useState(null),[p,L]=i.useState("tax"),[l,r]=i.useState({label:"",type:"tax",valueType:"percentage",value:0}),[n,m]=i.useState({enabled:!1,amount:0});i.useEffect(()=>{m(y)},[y]);const c=(a,f)=>{f?(T(f),r(f)):(T(null),r({label:"",type:a,valueType:"percentage",value:0})),L(a),C(!0)},g=()=>{C(!1)},O=async()=>{if(!l.label||l.value===void 0){alert("Please fill in all fields");return}const a={label:l.label,type:p,valueType:l.valueType,value:Number(l.value)};h?await E({...a,id:h.id}):await z(a),g()},D=async a=>{confirm("Are you sure you want to delete this rule?")&&await B(a)},k=v.filter(a=>a.type==="tax"),w=v.filter(a=>a.type==="addon");return e.jsxs(t,{sx:{pb:10,bgcolor:"background.default",minHeight:"100vh",color:"text.primary"},children:[e.jsx(H,{position:"sticky",color:"default",elevation:0,sx:{bgcolor:"background.paper",borderBottom:1,borderColor:"divider"},children:e.jsxs(q,{children:[e.jsx(d,{onClick:()=>window.history.back(),edge:"start",children:e.jsx(J,{})}),e.jsx(s,{variant:"h6",component:"h1",sx:{flexGrow:1,textAlign:"center",pr:5,fontWeight:"bold"},children:"Pricing Configuration"})]})}),e.jsx(K,{children:e.jsx(Q,{maxWidth:"md",sx:{py:4},children:F?e.jsx(t,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(M,{})}):e.jsxs(x,{container:!0,spacing:4,children:[e.jsxs(x,{size:12,children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(s,{variant:"h6",sx:{fontWeight:"bold"},children:"Tax Rules"}),e.jsx(o,{variant:"contained",startIcon:e.jsx(W,{}),onClick:()=>c("tax"),size:"small",children:"Add Tax"})]}),e.jsxs(b,{spacing:2,children:[k.length===0&&e.jsx(s,{color:"text.secondary",children:"No tax rules defined."}),k.map(a=>e.jsxs(j,{sx:{p:2,display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:2},children:[e.jsxs(t,{children:[e.jsx(s,{variant:"subtitle1",fontWeight:"bold",children:a.label}),e.jsx(A,{label:`${a.value}${a.valueType==="percentage"?"%":" Fixed"}`,size:"small",color:"primary",variant:"outlined"})]}),e.jsxs(t,{children:[e.jsx(d,{onClick:()=>c("tax",a),size:"small",color:"primary",children:e.jsx(S,{})}),e.jsx(d,{onClick:()=>D(a.id),size:"small",color:"error",children:e.jsx(I,{})})]})]},a.id))]})]}),e.jsxs(x,{size:12,children:[e.jsx(s,{variant:"h6",sx:{fontWeight:"bold",mb:2},children:"Delivery Charge"}),e.jsxs(j,{sx:{p:2,borderRadius:2},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(s,{variant:"subtitle1",fontWeight:"bold",children:"Enable Delivery Charge"}),e.jsx(U,{checked:n.enabled,onChange:a=>m({...n,enabled:a.target.checked})})]}),e.jsx(u,{label:"Amount",type:"number",fullWidth:!0,value:n.amount,disabled:!n.enabled,onChange:a=>m({...n,amount:Number(a.target.value)}),helperText:"Fixed amount applied to the entire order"}),e.jsx(o,{variant:"contained",color:"primary",sx:{mt:2},onClick:async()=>{try{await G(n),alert("Delivery charge saved successfully!")}catch{alert("Failed to save delivery charge. Please try again.")}},children:"Save Delivery Charge"})]})]}),e.jsxs(x,{size:12,children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(s,{variant:"h6",sx:{fontWeight:"bold"},children:"Add-on Costs"}),e.jsx(o,{variant:"contained",color:"secondary",startIcon:e.jsx(W,{}),onClick:()=>c("addon"),size:"small",children:"Add Add-on"})]}),e.jsxs(b,{spacing:2,children:[w.length===0&&e.jsx(s,{color:"text.secondary",children:"No add-on rules defined."}),w.map(a=>e.jsxs(j,{sx:{p:2,display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:2},children:[e.jsxs(t,{children:[e.jsx(s,{variant:"subtitle1",fontWeight:"bold",children:a.label}),e.jsx(A,{label:`${a.value}${a.valueType==="percentage"?"%":" Fixed"}`,size:"small",color:"secondary",variant:"outlined"})]}),e.jsxs(t,{children:[e.jsx(d,{onClick:()=>c("addon",a),size:"small",color:"primary",children:e.jsx(S,{})}),e.jsx(d,{onClick:()=>D(a.id),size:"small",color:"error",children:e.jsx(I,{})})]})]},a.id))]})]})]})})}),e.jsxs(X,{open:$,onClose:g,maxWidth:"xs",fullWidth:!0,children:[e.jsxs(Y,{children:[h?"Edit":"Add"," ",p==="tax"?"Tax Rule":"Add-on"]}),e.jsx(Z,{children:e.jsxs(b,{spacing:2,sx:{mt:1},children:[e.jsx(u,{label:"Label",fullWidth:!0,placeholder:p==="tax"?"e.g. VAT, GST":"e.g. Gift Wrap, Service Charge",value:l.label,onChange:a=>r({...l,label:a.target.value})}),e.jsxs(u,{select:!0,label:"Type",fullWidth:!0,value:l.valueType,onChange:a=>r({...l,valueType:a.target.value}),children:[e.jsx(R,{value:"percentage",children:"Percentage (%)"}),e.jsx(R,{value:"fixed",children:"Fixed Amount"})]}),e.jsx(u,{label:"Value",type:"number",fullWidth:!0,value:l.value,onChange:a=>r({...l,value:Number(a.target.value)})})]})}),e.jsxs(_,{children:[e.jsx(o,{onClick:g,children:"Cancel"}),e.jsx(o,{onClick:O,variant:"contained",disabled:!l.label,children:"Save"})]})]})]})}export{je as component};

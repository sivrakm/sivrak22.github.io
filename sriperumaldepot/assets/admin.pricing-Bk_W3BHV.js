import{r,j as e,C as O}from"./index-jkkTBVtM.js";import{u as L}from"./pricingStore-C-tbukPv.js";import{B as t,T as s,a as c,P as g}from"./Button-DyWE-TO5.js";import{A as M,T as V,a as H,C as w,M as A}from"./ArrowBackIosNew-AXzXIPsE.js";import{I as o}from"./IconButton-bdtkLUFW.js";import{P as q}from"./Page-D8cE7n7m.js";import{C as J,E as R,S as K}from"./Edit-kmNWLXkX.js";import{G as x}from"./Grid-DCSbaDKa.js";import{A as W}from"./Add-DxKOWqEo.js";import{S as f}from"./Stack-Bag7HaCI.js";import{D as I}from"./Delete-CeOPWJli.js";import{T as u}from"./TextField-GSq9JZz_.js";import{D as Q}from"./Dialog-DFTo8v6H.js";import{D as U,a as X,b as Y}from"./DialogTitle-CzX4z1ZA.js";import"./Select-BQ32v_-G.js";import"./Modal-BAVllA8P.js";import"./useThemeProps-CaWGZOjg.js";import"./SwitchBase-B_-h0qfG.js";function je(){const{rules:b,fetchRules:S,addRule:z,updateRule:P,deleteRule:E,isLoading:B,deliveryConfig:i,fetchDeliveryConfig:N,updateDeliveryConfig:v}=L();r.useEffect(()=>{S(),N()},[]);const[F,y]=r.useState(!1),[h,C]=r.useState(null),[p,G]=r.useState("tax"),[l,n]=r.useState({label:"",type:"tax",valueType:"percentage",value:0}),d=(a,j)=>{j?(C(j),n(j)):(C(null),n({label:"",type:a,valueType:"percentage",value:0})),G(a),y(!0)},m=()=>{y(!1)},$=async()=>{if(!l.label||l.value===void 0){alert("Please fill in all fields");return}const a={label:l.label,type:p,valueType:l.valueType,value:Number(l.value)};h?await P({...a,id:h.id}):await z(a),m()},T=async a=>{confirm("Are you sure you want to delete this rule?")&&await E(a)},D=b.filter(a=>a.type==="tax"),k=b.filter(a=>a.type==="addon");return e.jsxs(t,{sx:{pb:10,bgcolor:"background.default",minHeight:"100vh",color:"text.primary"},children:[e.jsx(M,{position:"sticky",color:"default",elevation:0,sx:{bgcolor:"background.paper",borderBottom:1,borderColor:"divider"},children:e.jsxs(V,{children:[e.jsx(o,{onClick:()=>window.history.back(),edge:"start",children:e.jsx(H,{})}),e.jsx(s,{variant:"h6",component:"h1",sx:{flexGrow:1,textAlign:"center",pr:5,fontWeight:"bold"},children:"Pricing Configuration"})]})}),e.jsx(q,{children:e.jsx(J,{maxWidth:"md",sx:{py:4},children:B?e.jsx(t,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(O,{})}):e.jsxs(x,{container:!0,spacing:4,children:[e.jsxs(x,{size:12,children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(s,{variant:"h6",sx:{fontWeight:"bold"},children:"Tax Rules"}),e.jsx(c,{variant:"contained",startIcon:e.jsx(W,{}),onClick:()=>d("tax"),size:"small",children:"Add Tax"})]}),e.jsxs(f,{spacing:2,children:[D.length===0&&e.jsx(s,{color:"text.secondary",children:"No tax rules defined."}),D.map(a=>e.jsxs(g,{sx:{p:2,display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:2},children:[e.jsxs(t,{children:[e.jsx(s,{variant:"subtitle1",fontWeight:"bold",children:a.label}),e.jsx(w,{label:`${a.value}${a.valueType==="percentage"?"%":" Fixed"}`,size:"small",color:"primary",variant:"outlined"})]}),e.jsxs(t,{children:[e.jsx(o,{onClick:()=>d("tax",a),size:"small",color:"primary",children:e.jsx(R,{})}),e.jsx(o,{onClick:()=>T(a.id),size:"small",color:"error",children:e.jsx(I,{})})]})]},a.id))]})]}),e.jsxs(x,{size:12,children:[e.jsx(s,{variant:"h6",sx:{fontWeight:"bold",mb:2},children:"Delivery Charge"}),e.jsxs(g,{sx:{p:2,borderRadius:2},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(s,{variant:"subtitle1",fontWeight:"bold",children:"Enable Delivery Charge"}),e.jsx(K,{checked:i.enabled,onChange:a=>v({...i,enabled:a.target.checked})})]}),e.jsx(u,{label:"Amount",type:"number",fullWidth:!0,value:i.amount,disabled:!i.enabled,onChange:a=>v({...i,amount:Number(a.target.value)}),helperText:"Fixed amount applied to the entire order"})]})]}),e.jsxs(x,{size:12,children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(s,{variant:"h6",sx:{fontWeight:"bold"},children:"Add-on Costs"}),e.jsx(c,{variant:"contained",color:"secondary",startIcon:e.jsx(W,{}),onClick:()=>d("addon"),size:"small",children:"Add Add-on"})]}),e.jsxs(f,{spacing:2,children:[k.length===0&&e.jsx(s,{color:"text.secondary",children:"No add-on rules defined."}),k.map(a=>e.jsxs(g,{sx:{p:2,display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:2},children:[e.jsxs(t,{children:[e.jsx(s,{variant:"subtitle1",fontWeight:"bold",children:a.label}),e.jsx(w,{label:`${a.value}${a.valueType==="percentage"?"%":" Fixed"}`,size:"small",color:"secondary",variant:"outlined"})]}),e.jsxs(t,{children:[e.jsx(o,{onClick:()=>d("addon",a),size:"small",color:"primary",children:e.jsx(R,{})}),e.jsx(o,{onClick:()=>T(a.id),size:"small",color:"error",children:e.jsx(I,{})})]})]},a.id))]})]})]})})}),e.jsxs(Q,{open:F,onClose:m,maxWidth:"xs",fullWidth:!0,children:[e.jsxs(U,{children:[h?"Edit":"Add"," ",p==="tax"?"Tax Rule":"Add-on"]}),e.jsx(X,{children:e.jsxs(f,{spacing:2,sx:{mt:1},children:[e.jsx(u,{label:"Label",fullWidth:!0,placeholder:p==="tax"?"e.g. VAT, GST":"e.g. Gift Wrap, Service Charge",value:l.label,onChange:a=>n({...l,label:a.target.value})}),e.jsxs(u,{select:!0,label:"Type",fullWidth:!0,value:l.valueType,onChange:a=>n({...l,valueType:a.target.value}),children:[e.jsx(A,{value:"percentage",children:"Percentage (%)"}),e.jsx(A,{value:"fixed",children:"Fixed Amount"})]}),e.jsx(u,{label:"Value",type:"number",fullWidth:!0,value:l.value,onChange:a=>n({...l,value:Number(a.target.value)})})]})}),e.jsxs(Y,{children:[e.jsx(c,{onClick:m,children:"Cancel"}),e.jsx(c,{onClick:$,variant:"contained",disabled:!l.label,children:"Save"})]})]})]})}export{je as component};

import{j as e,r as h,C as te,O as se,P as ie,Q as oe,S as ne}from"./index-CJQyQtfI.js";import{u as g,A as ae,T as le,a as ce}from"./productStore-Ds2YwoQa.js";import{n as y,C as T,A as E,a as de,I as F,P as he,S as O,N as ue,E as xe,b as ge}from"./index.browser-CTf-T3Be.js";import{c as _,a as t,T as i,b as m,P as w}from"./Button-fnge12a-.js";import{I as p}from"./IconButton-Cx5rAatU.js";import{S as l,E as pe,C as me}from"./ExpandMore-BeTaR3Dt.js";import{T as d,I as f}from"./TextField-CJprGTiR.js";import{M as P,S as fe}from"./ShoppingBag-B0m9lMNF.js";import{G as I}from"./Grid-N_cln35M.js";import{D as B}from"./Delete-D9aGPuxe.js";import{D as je}from"./Dialog--RaA3a4G.js";import{D as be,a as ve,b as Ce,c as ye}from"./DialogTitle-S3vUMq-h.js";import{F as we}from"./FitnessCenter-B5yOiZcT.js";import"./useThemeProps-BOqN-2Wm.js";import"./SwitchBase-CC0EDkbz.js";import"./Select-Dff4fZ1F.js";import"./isMuiElement-CGQUDQGH.js";import"./Modal-B7X9SdUY.js";const Pe=_([e.jsx("path",{d:"m12 12.9-2.13 2.09c-.56.56-.87 1.29-.87 2.07C9 18.68 10.35 20 12 20s3-1.32 3-2.94c0-.78-.31-1.52-.87-2.07z"},"0"),e.jsx("path",{d:"m16 6-.44.55C14.38 8.02 12 7.19 12 5.3V2S4 6 4 13c0 2.92 1.56 5.47 3.89 6.86-.56-.79-.89-1.76-.89-2.8 0-1.32.52-2.56 1.47-3.5L12 10.1l3.53 3.47c.95.93 1.47 2.17 1.47 3.5 0 1.02-.31 1.96-.85 2.75 1.89-1.15 3.29-3.06 3.71-5.3.66-3.55-1.07-6.9-3.86-8.52"},"1")]),Ie=_(e.jsx("path",{d:"M20 10V8h-4V4h-2v4h-4V4H8v4H4v2h4v4H4v2h4v4h2v-4h4v4h2v-4h4v-2h-4v-4zm-6 4h-4v-4h4z"})),U=[{value:"tag",label:"Tag",icon:e.jsx(Ie,{})},{value:"fitness_center",label:"Dumbbell",icon:e.jsx(we,{})},{value:"local_fire_department",label:"Fire",icon:e.jsx(Pe,{})},{value:"shopping_bag",label:"Bag",icon:e.jsx(fe,{})}],Se=[{value:"black",color:"#000000"},{value:"white",color:"#ffffff"},{value:"red",color:"#ef4444"},{value:"blue",color:"#3b82f6"},{value:"yellow",color:"#f2b90d"}];function Ge(){const L=g(r=>r.pushProducttoDb),M=g(r=>r.updateProduct),V=g(r=>r.products),S=g(r=>r.fetchProducts),H=g(r=>r.deleteProduct),G=g(r=>r.categories);h.useState(()=>{S()});const[x,W]=h.useState(null),[K,D]=h.useState(!1),[b,v]=h.useState(!1),[$,j]=h.useState(!1),[k,z]=h.useState(null),R=h.useRef(null),Q=async r=>{const s=r.target.files?.[0];if(s){D(!0);try{const n=se(ie,`products/${y()}_${s.name}`),a=await oe(n,s),C=await ne(a.ref);u(re=>({...re,src:C}))}catch(n){console.error("Error uploading image: ",n),alert("Failed to upload image.")}finally{D(!1)}}},[o,u]=h.useState({name:"",sku:"",id:y(),category:"",detail:"",price:void 0,originalPrice:void 0,icon:"fitness_center",imageColor:"black",src:"",sale:!1,isNew:!0,sizes:[],categoryOnly:!1}),c=(r,s)=>{u(n=>({...n,[r]:s}))},A=(r,s,n)=>{const a=[...o.sizes||[]];a[r]={...a[r],[s]:n},u(C=>({...C,sizes:a}))},X=()=>{u(r=>({...r,sizes:[...r.sizes||[],{label:"",price:0}]}))},q=r=>{u(s=>({...s,sizes:s.sizes?.filter((n,a)=>a!==r)}))},J=r=>{u({...r}),W(r.id),v(!0),window.scrollTo({top:0,behavior:"smooth"})},Y=r=>{z(r),j(!0)},Z=async()=>{k&&(await H(k),j(!1),z(null))},N=()=>{u({name:"",sku:"",id:y(),category:"",detail:"",price:void 0,originalPrice:void 0,icon:"fitness_center",imageColor:"black",src:"",sale:!1,isNew:!0,sizes:[],categoryOnly:!1}),W(null),v(!1),window.scrollTo({top:0,behavior:"smooth"})},ee=async()=>{try{console.log("Saving product...",o);const r=Object.entries(o).reduce((s,[n,a])=>(a!==void 0&&(n==="price"||n==="originalPrice"?a===""||a===null||isNaN(Number(a))?n==="originalPrice"&&(s[n]=null):s[n]=Number(a):s[n]=a),s),{});if(!r.name||!r.price){alert("Please fill in at least Name and Price");return}x?(await M({...r,id:x}),alert("Product updated successfully!")):(await L(r),alert("Product saved successfully!")),await S(),N()}catch(r){console.error("Error saving product:",r),alert("Failed to save product")}};return e.jsxs(t,{sx:{minHeight:"100vh",bgcolor:"background.default",pb:10},children:[e.jsx(ae,{position:"sticky",color:"default",elevation:0,sx:{bgcolor:"background.paper",borderBottom:1,borderColor:"divider"},children:e.jsxs(le,{children:[e.jsx(p,{onClick:()=>window.history.back(),edge:"start",children:e.jsx(ce,{})}),e.jsx(i,{variant:"h6",component:"h1",sx:{flexGrow:1,textAlign:"center",pr:5,fontWeight:"bold"},children:x?"Edit Product":"Add Product"}),x&&e.jsx(m,{color:"inherit",onClick:N,children:"Cancel Edit"})]})}),e.jsxs(T,{maxWidth:"sm",sx:{py:3,display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(t,{sx:{border:1,borderColor:"divider",borderRadius:3,overflow:"hidden",bgcolor:"background.paper"},children:[e.jsxs(t,{onClick:()=>v(!b),sx:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",p:2,bgcolor:"action.hover",transition:"background-color 0.2s","&:hover":{bgcolor:"action.selected"}},children:[e.jsxs(l,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(E,{color:"primary"}),e.jsx(i,{variant:"subtitle1",sx:{fontWeight:"bold"},children:x?"Edit Product Details":"Add New Product"})]}),e.jsx(p,{size:"small",sx:{transform:b?"rotate(180deg)":"none",transition:"transform 0.3s"},children:e.jsx(pe,{})})]}),e.jsx(me,{in:b,children:e.jsxs(t,{sx:{p:2,display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(t,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:"bold",textTransform:"uppercase"},children:"Product Image"}),e.jsx(d,{fullWidth:!0,placeholder:"Paste image URL here...",value:o.src??"",onChange:r=>c("src",r.target.value),InputProps:{endAdornment:e.jsxs(f,{position:"end",children:[e.jsx(p,{onClick:()=>R.current?.click(),edge:"end",children:K?e.jsx(te,{size:24}):e.jsx(de,{color:"primary"})}),e.jsx("input",{type:"file",hidden:!0,ref:R,accept:"image/*",onChange:Q})]}),sx:{borderRadius:3}}}),e.jsx(t,{sx:{mt:2,height:160,borderRadius:3,border:"2px dashed",borderColor:"divider",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden",bgcolor:"action.hover"},children:o.src?e.jsx(t,{component:"img",src:o.src,sx:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsxs(e.Fragment,{children:[e.jsx(F,{sx:{fontSize:40,opacity:.5,mb:1}}),e.jsx(i,{variant:"caption",sx:{opacity:.7},children:"Image preview will appear here"})]})})]}),e.jsxs(l,{spacing:2,children:[e.jsxs(l,{direction:"row",spacing:2,children:[e.jsxs(t,{flex:1,children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Product Name"}),e.jsx(d,{fullWidth:!0,placeholder:"e.g. Protein Whey",value:o.name??"",onChange:r=>c("name",r.target.value)})]}),e.jsxs(t,{width:140,children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"SKU ID"}),e.jsx(d,{fullWidth:!0,placeholder:"PROD-001",value:o.sku||"",onChange:r=>c("sku",r.target.value)})]})]}),e.jsxs(t,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Category"}),e.jsxs(d,{select:!0,fullWidth:!0,value:o.category,onChange:r=>c("category",r.target.value),children:[e.jsx(P,{value:"",disabled:!0,children:"Select Category"}),G.filter(r=>r!=="All Items").map(r=>e.jsx(P,{value:r,children:r},r))]})]}),e.jsxs(t,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Detail"}),e.jsx(d,{fullWidth:!0,multiline:!0,minRows:3,placeholder:"Describe the product features...",value:o.detail??"",onChange:r=>c("detail",r.target.value)})]})]}),e.jsx(t,{sx:{my:1,borderTop:1,borderColor:"divider",borderStyle:"dashed"}}),e.jsxs(I,{container:!0,spacing:2,children:[e.jsxs(I,{size:6,children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Price"}),e.jsx(d,{fullWidth:!0,type:"number",placeholder:"0.00",value:o.price??"",onChange:r=>c("price",r.target.value===""?void 0:Number(r.target.value)),InputProps:{startAdornment:e.jsx(f,{position:"start",children:"₹"})}})]}),e.jsxs(I,{size:6,children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Original Price"}),e.jsx(d,{fullWidth:!0,type:"number",placeholder:"0.00",value:o.originalPrice??"",onChange:r=>c("originalPrice",r.target.value===""?void 0:Number(r.target.value)),InputProps:{startAdornment:e.jsx(f,{position:"start",children:"₹"})}})]})]}),e.jsxs(l,{spacing:2,children:[e.jsxs(t,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Icon"}),e.jsx(d,{select:!0,fullWidth:!0,value:o.icon,onChange:r=>c("icon",r.target.value),InputProps:{startAdornment:e.jsx(f,{position:"start",children:U.find(r=>r.value===o.icon)?.icon})},children:U.map(r=>e.jsx(P,{value:r.value,children:e.jsxs(l,{direction:"row",alignItems:"center",spacing:1,children:[r.icon,e.jsx("span",{children:r.label})]})},r.value))})]}),e.jsxs(t,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:"Image Color"}),e.jsx(l,{direction:"row",spacing:1.5,sx:{overflowX:"auto",py:1},children:Se.map(r=>e.jsx(t,{onClick:()=>c("imageColor",r.value),sx:{width:40,height:40,borderRadius:"50%",bgcolor:r.color,border:r.value==="white"?"1px solid #e5e7eb":"none",cursor:"pointer",ring:o.imageColor===r.value?2:0,ringColor:"primary.main",ringOffset:2,boxShadow:1,transition:"all 0.2s",transform:o.imageColor===r.value?"scale(1.1)":"scale(1)"}},r.value))})]})]}),e.jsxs(w,{variant:"outlined",sx:{borderRadius:3,overflow:"hidden"},children:[e.jsxs(t,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between",borderBottom:"1px dashed",borderColor:"divider"},children:[e.jsxs(l,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(t,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:"primary.light",color:"primary.main",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(he,{fontSize:"small"})}),e.jsx(i,{fontWeight:500,children:"On Sale"})]}),e.jsx(O,{checked:o.sale,onChange:r=>c("sale",r.target.checked)})]}),e.jsxs(t,{sx:{p:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(t,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:"primary.light",color:"primary.main",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ue,{fontSize:"small"})}),e.jsx(i,{fontWeight:500,children:"New Arrival"})]}),e.jsx(O,{checked:o.isNew,onChange:r=>c("isNew",r.target.checked)})]})]}),e.jsxs(t,{children:[e.jsx(i,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:"Available Sizes"}),e.jsxs(l,{spacing:2,children:[o.sizes?.map((r,s)=>e.jsxs(l,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(d,{sx:{width:80},placeholder:"Label",value:r.label,onChange:n=>A(s,"label",n.target.value),inputProps:{style:{textAlign:"center"}}}),e.jsx(d,{fullWidth:!0,placeholder:"0.00",type:"number",value:r.price,onChange:n=>A(s,"price",Number(n.target.value)),InputProps:{startAdornment:e.jsx(f,{position:"start",children:"₹"})}}),e.jsx(p,{color:"error",onClick:()=>q(s),sx:{bgcolor:"error.main",color:"white","&:hover":{bgcolor:"error.dark"},borderRadius:2},children:e.jsx(B,{})})]},s)),e.jsx(m,{variant:"outlined",startIcon:e.jsx(E,{}),onClick:X,sx:{py:1.5,borderStyle:"dashed",borderWidth:2,borderRadius:3,"&:hover":{borderWidth:2}},children:"Add Size Variant"})]})]})]})})]}),e.jsxs(t,{sx:{mt:4},children:[e.jsx(i,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:"Manage Products"}),e.jsx(l,{spacing:2,children:V.map(r=>e.jsx(w,{variant:"outlined",sx:{p:2,borderRadius:2},children:e.jsxs(l,{direction:"row",spacing:2,alignItems:"center",children:[r.src?e.jsx(t,{component:"img",src:r.src,sx:{width:60,height:60,objectFit:"cover",borderRadius:2,bgcolor:"action.hover"}}):e.jsx(t,{sx:{width:60,height:60,borderRadius:2,bgcolor:"action.hover",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(F,{sx:{opacity:.3}})}),e.jsxs(t,{flex:1,children:[e.jsx(i,{fontWeight:600,children:r.name}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["₹",r.price]}),e.jsx(l,{direction:"row",spacing:1,alignItems:"center",children:e.jsx(i,{variant:"caption",color:"text.secondary",children:r.category})}),r.sku&&e.jsxs(i,{variant:"caption",color:"text.secondary",children:["SKU: ",r.sku]})]}),e.jsx(p,{size:"small",onClick:()=>J(r),children:e.jsx(xe,{})}),e.jsx(p,{size:"small",color:"error",onClick:()=>Y(r.id),children:e.jsx(B,{})})]})},r.id))})]})]}),e.jsx(w,{sx:{position:"fixed",bottom:0,left:0,right:0,p:2,bgcolor:"background.paper",borderTop:1,borderColor:"divider",zIndex:10},elevation:4,children:e.jsx(T,{maxWidth:"sm",children:e.jsx(m,{fullWidth:!0,variant:"contained",size:"large",startIcon:e.jsx(ge,{}),onClick:ee,sx:{height:56,borderRadius:3,fontSize:"1.1rem",fontWeight:"bold",boxShadow:2},children:x?"Update Product":"Save Product"})})}),e.jsxs(je,{open:$,onClose:()=>j(!1),PaperProps:{sx:{borderRadius:3,p:1}},children:[e.jsx(be,{sx:{fontWeight:"bold"},children:"Delete Product?"}),e.jsx(ve,{children:e.jsx(Ce,{children:"Are you sure you want to delete this product? This action is permanent and cannot be undone."})}),e.jsxs(ye,{sx:{p:2},children:[e.jsx(m,{onClick:()=>j(!1),color:"inherit",sx:{fontWeight:"bold"},children:"Cancel"}),e.jsx(m,{onClick:Z,variant:"contained",color:"error",sx:{fontWeight:"bold",borderRadius:2},children:"Delete"})]})]})]})}export{Ge as component};

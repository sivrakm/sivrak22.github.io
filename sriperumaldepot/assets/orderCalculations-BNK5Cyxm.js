import{b as T,g as k,r as f,c as $,j as t,s as z,e as M,h as G,O as L,m as Y,d as et,f as w,i as H,l as ot,P as rt}from"./index-DtX5KMym.js";import{c as I,B as l,T as a,a as O}from"./Button-ZxXk5NXE.js";import{S as N}from"./Stack-DliPFEgh.js";import{D as st}from"./Divider-B1FYCkTC.js";import{P as nt,H as at}from"./printInvoice-Cj1u0MpQ.js";import{Q as it}from"./QuantitySelector-D8TfKOwS.js";import{D as lt}from"./dividerClasses-uNOcrwxV.js";import{S as ct,D as dt,a as ut,b as xt}from"./DialogTitle-DefX13gx.js";import{u as Z,f as pt,c as mt,a as ft}from"./TextField-eoPkSaiM.js";import{F as q}from"./FormControlLabel-BVGJZrL6.js";import{C as ht}from"./Checkbox-BUmFVTHj.js";function yt(e){return T("MuiFormGroup",e)}k("MuiFormGroup",["root","row","error"]);const gt=e=>{const{classes:o,row:c,error:s}=e;return G({root:["root",c&&"row",s&&"error"]},yt,o)},bt=z("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:c}=e;return[o.root,c.row&&o.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),vt=f.forwardRef(function(o,c){const s=$({props:o,name:"MuiFormGroup"}),{className:n,row:x=!1,...m}=s,h=Z(),y=pt({props:s,muiFormControl:h,states:["error"]}),v={...s,row:x,error:y.error},g=gt(v);return t.jsx(bt,{className:M(g.root,n),ownerState:v,ref:c,...m})}),jt=I(t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),Rt=I(t.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"})),Ct=z("span",{name:"MuiRadioButtonIcon",shouldForwardProp:L})({position:"relative",display:"flex"}),St=z(jt,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),zt=z(Rt,{name:"MuiRadioButtonIcon"})(Y(({theme:e})=>({left:0,position:"absolute",transform:"scale(0)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeIn,duration:e.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.shortest})}}]})));function J(e){const{checked:o=!1,classes:c={},fontSize:s}=e,n={...e,checked:o};return t.jsxs(Ct,{className:c.root,ownerState:n,children:[t.jsx(St,{fontSize:s,className:c.background,ownerState:n}),t.jsx(zt,{fontSize:s,className:c.dot,ownerState:n})]})}const K=f.createContext(void 0);function It(){return f.useContext(K)}function wt(e){return T("MuiRadio",e)}const D=k("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),Pt=e=>{const{classes:o,color:c,size:s}=e,n={root:["root",`color${w(c)}`,s!=="medium"&&`size${w(s)}`]};return{...o,...G(n,wt,o)}},Wt=z(ct,{shouldForwardProp:e=>L(e)||e==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:c}=e;return[o.root,c.size!=="medium"&&o[`size${w(c.size)}`],o[`color${w(c.color)}`]]}})(Y(({theme:e})=>({color:(e.vars||e).palette.text.secondary,[`&.${D.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity)}}},...Object.entries(e.palette).filter(H()).map(([o])=>({props:{color:o,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[o].main,(e.vars||e).palette.action.hoverOpacity)}}})),...Object.entries(e.palette).filter(H()).map(([o])=>({props:{color:o,disabled:!1},style:{[`&.${D.checked}`]:{color:(e.vars||e).palette[o].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));function At(e,o){return typeof o=="object"&&o!==null?e===o:String(e)===String(o)}const Ft=t.jsx(J,{checked:!0}),Tt=t.jsx(J,{}),U=f.forwardRef(function(o,c){const s=$({props:o,name:"MuiRadio"}),{checked:n,checkedIcon:x=Ft,color:m="primary",icon:h=Tt,name:y,onChange:v,size:g="medium",className:b,disabled:C,disableRipple:R=!1,slots:d={},slotProps:u={},inputProps:p,...i}=s,r=Z();let j=C;r&&typeof j>"u"&&(j=r.disabled),j??=!1;const P={...s,disabled:j,disableRipple:R,color:m,size:g},Q=Pt(P),S=It();let W=n;const X=mt(v,S&&S.onChange);let A=y;S&&(typeof W>"u"&&(W=At(S.value,s.value)),typeof A>"u"&&(A=S.name));const F=u.input??p,[_,tt]=et("root",{ref:c,elementType:Wt,className:M(Q.root,b),shouldForwardComponentProp:!0,externalForwardedProps:{slots:d,slotProps:u,...i},getSlotProps:B=>({...B,onChange:(V,...E)=>{B.onChange?.(V,...E),X(V,...E)}}),ownerState:P,additionalProps:{type:"radio",icon:f.cloneElement(h,{fontSize:h.props.fontSize??g}),checkedIcon:f.cloneElement(x,{fontSize:x.props.fontSize??g}),disabled:j,name:A,checked:W,slots:d,slotProps:{input:typeof F=="function"?F(P):F}}});return t.jsx(_,{...tt,classes:Q})});function kt(e){return T("MuiRadioGroup",e)}k("MuiRadioGroup",["root","row","error"]);const Mt=e=>{const{classes:o,row:c,error:s}=e;return G({root:["root",c&&"row",s&&"error"]},kt,o)},Gt=f.forwardRef(function(o,c){const{actions:s,children:n,className:x,defaultValue:m,name:h,onChange:y,value:v,...g}=o,b=f.useRef(null),C=Mt(o),[R,d]=ft({controlled:v,default:m,name:"RadioGroup"});f.useImperativeHandle(s,()=>({focus:()=>{let r=b.current.querySelector("input:not(:disabled):checked");r||(r=b.current.querySelector("input:not(:disabled)")),r&&r.focus()}}),[]);const u=ot(c,b),p=rt(h),i=f.useMemo(()=>({name:p,onChange(r){d(r.target.value),y&&y(r,r.target.value)},value:R}),[p,y,d,R]);return t.jsx(K.Provider,{value:i,children:t.jsx(vt,{role:"radiogroup",ref:u,className:M(C.root,x),...g,children:n})})}),Zt=I(t.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m4 12h-4v3l-5-5 5-5v3h4z"})),Nt=I(t.jsx("path",{d:"M12 7V3H2v18h20V7zM6 19H4v-2h2zm0-4H4v-2h2zm0-4H4V9h2zm0-4H4V5h2zm4 12H8v-2h2zm0-4H8v-2h2zm0-4H8V9h2zm0-4H8V5h2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8zm-2-8h-2v2h2zm0 4h-2v2h2z"})),Qt=I(t.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"})),Jt=({order:e})=>{const o=[{label:"Subtotal",value:e.subtotal||0,color:"text.primary"},{label:"Tax",value:e.tax||0,color:"text.secondary"},{label:"Item Addons",value:e.itemAddons||0,color:"text.secondary"}],c=e.manualAddons||[],s=!e.itemAddons&&!e.manualAddons&&(e.addons||0)>0?e.addons:0;return t.jsxs(l,{sx:{bgcolor:"background.paper",borderRadius:2,border:1,borderColor:"divider",overflow:"hidden"},children:[t.jsx(l,{sx:{px:2,py:1.5,bgcolor:"grey.50",borderBottom:1,borderColor:"divider"},children:t.jsx(a,{variant:"caption",sx:{fontWeight:800,color:"text.secondary",textTransform:"uppercase",letterSpacing:1},children:"Payment Summary"})}),t.jsxs(N,{spacing:1,sx:{p:2},children:[o.map((n,x)=>(n.value>0||x===0)&&t.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontWeight:500},children:n.label}),t.jsxs(a,{variant:"body2",sx:{fontWeight:600,color:n.color},children:["₹",n.value.toFixed(2)]})]},x)),c.map((n,x)=>t.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontWeight:500},children:n.label}),t.jsxs(a,{variant:"body2",sx:{fontWeight:600,color:n.amount<0?"error.main":"success.main"},children:[n.amount<0?"-":"+","₹",Math.abs(n.amount).toFixed(2)]})]},`manual-${x}`)),s!==void 0&&s>0&&t.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontWeight:500},children:"Addons (Legacy)"}),t.jsxs(a,{variant:"body2",sx:{fontWeight:600,color:"text.secondary"},children:["₹",s.toFixed(2)]})]}),(e.deliveryAmount||0)>0&&t.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontWeight:500},children:"Delivery"}),t.jsxs(a,{variant:"body2",sx:{fontWeight:600,color:"text.secondary"},children:["₹",e.deliveryAmount?.toFixed(2)]})]}),(e.returnedAmount||0)>0&&t.jsxs(l,{sx:{mt:1,pt:1,borderTop:"1px dashed",borderColor:"divider"},children:[t.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5},children:[t.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontWeight:600},children:"Original Total"}),t.jsxs(a,{variant:"body2",sx:{fontWeight:600,color:"text.secondary"},children:["₹",((e.total||0)+(e.returnedAmount||0)).toLocaleString(void 0,{minimumFractionDigits:2})]})]}),t.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(a,{variant:"body2",color:"error.main",sx:{fontWeight:700},children:"Returns Info"}),t.jsxs(a,{variant:"body2",sx:{fontWeight:800,color:"error.main"},children:["-₹",e.returnedAmount?.toLocaleString(void 0,{minimumFractionDigits:2})]})]})]}),t.jsx(st,{sx:{my:1}}),t.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[t.jsx(a,{variant:"subtitle1",sx:{fontWeight:800,color:"text.primary"},children:(e.returnedAmount||0)>0?"Net Total":"Total Amount"}),t.jsxs(a,{variant:"h6",sx:{fontWeight:900,color:"primary.main"},children:["₹",e.total.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]})},Kt=({shippingDetails:e})=>t.jsxs(l,{sx:{bgcolor:"background.paper",borderRadius:2,border:1,borderColor:"divider",overflow:"hidden"},children:[t.jsx(l,{sx:{px:2,py:1.5,bgcolor:"grey.50",borderBottom:1,borderColor:"divider"},children:t.jsx(a,{variant:"caption",sx:{fontWeight:800,color:"text.secondary",textTransform:"uppercase",letterSpacing:1},children:"Shipping Information"})}),t.jsxs(N,{spacing:2,sx:{p:2},children:[t.jsxs(l,{sx:{display:"flex",gap:2,alignItems:"center"},children:[t.jsx(l,{sx:{p:1,borderRadius:1.5,bgcolor:"primary.main",color:"primary.contrastText",display:"flex"},children:t.jsx(Qt,{fontSize:"small"})}),t.jsxs(l,{children:[t.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:700,textTransform:"uppercase",fontSize:"0.65rem"},children:"Customer"}),t.jsxs(a,{variant:"body2",sx:{fontWeight:600},children:[e.firstName," ",e.lastName]})]})]}),t.jsxs(l,{sx:{display:"flex",gap:2,alignItems:"center"},children:[t.jsx(l,{sx:{p:1,borderRadius:1.5,bgcolor:"secondary.main",color:"white",display:"flex"},children:t.jsx(nt,{fontSize:"small"})}),t.jsxs(l,{children:[t.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:700,textTransform:"uppercase",fontSize:"0.65rem"},children:"Contact Number"}),t.jsx(a,{variant:"body2",sx:{fontWeight:600,letterSpacing:.5},children:e.phoneNumber})]})]}),(e.address||e.city)&&t.jsxs(l,{sx:{display:"flex",gap:2,alignItems:"flex-start"},children:[t.jsx(l,{sx:{p:1,borderRadius:1.5,bgcolor:"info.main",color:"white",display:"flex",mt:.5},children:t.jsx(at,{fontSize:"small"})}),t.jsxs(l,{children:[t.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:700,textTransform:"uppercase",fontSize:"0.65rem"},children:"Delivery Address"}),t.jsxs(a,{variant:"body2",sx:{fontWeight:600,lineHeight:1.4},children:[e.address,",",t.jsx("br",{}),e.city," ",e.zip&&`- ${e.zip}`]})]})]}),e.orgName&&t.jsxs(l,{sx:{display:"flex",gap:2,alignItems:"center"},children:[t.jsx(l,{sx:{p:1,borderRadius:1.5,bgcolor:"warning.main",color:"white",display:"flex"},children:t.jsx(Nt,{fontSize:"small"})}),t.jsxs(l,{children:[t.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:700,textTransform:"uppercase",fontSize:"0.65rem"},children:"Organization"}),t.jsx(a,{variant:"body2",sx:{fontWeight:600},children:e.orgName})]})]})]})]}),Xt=({open:e,onClose:o,onSave:c,order:s})=>{const[n,x]=f.useState("full"),[m,h]=f.useState({}),[y,v]=f.useState({}),[g,b]=f.useState(!1);f.useEffect(()=>{if(e&&s?.items){x("full");const d={},u={};s.items.forEach((p,i)=>{const r=p.quantity-(p.returnedQuantity||0);d[i]=!1,u[i]=p.isComplexVariant?r:Math.min(1,r)}),h(d),v(u)}},[e,s]);const C=d=>{h(u=>({...u,[d]:!u[d]}))},R=async()=>{b(!0);try{const d=s.items.map((u,p)=>{let i=0;return n==="full"?i=u.quantity-(u.returnedQuantity||0):m[p]&&(i=y[p]||0),i>0?{...u,returnedQuantity:(u.returnedQuantity||0)+i}:u});await c(d),o()}catch(d){console.error("Error saving return:",d),alert("Failed to save return details")}finally{b(!1)}};return s?t.jsxs(lt,{open:e,onClose:o,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:3}},children:[t.jsx(dt,{sx:{fontWeight:"bold"},children:"Process Return"}),t.jsxs(ut,{dividers:!0,children:[t.jsxs(l,{sx:{mb:3},children:[t.jsx(a,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"RETURN TYPE"}),t.jsxs(Gt,{value:n,onChange:d=>x(d.target.value),sx:{flexDirection:"row",gap:2},children:[t.jsx(q,{value:"full",control:t.jsx(U,{}),label:t.jsx(a,{variant:"body2",sx:{fontWeight:600},children:"Full Return"})}),t.jsx(q,{value:"partial",control:t.jsx(U,{}),label:t.jsx(a,{variant:"body2",sx:{fontWeight:600},children:"Partial Return"})})]})]}),n==="partial"&&t.jsxs(l,{children:[t.jsx(a,{variant:"subtitle2",color:"text.secondary",sx:{mb:2},children:"SELECT ITEMS & QUANTITIES"}),t.jsx(N,{spacing:2,children:s.items.map((d,u)=>{const p=d.quantity-(d.returnedQuantity||0);return p<=0?null:t.jsx(l,{sx:{p:1.5,borderRadius:2,border:1,borderColor:m[u]?"primary.main":"divider",bgcolor:m[u]?"primary.main08":"transparent"},children:t.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[t.jsx(ht,{checked:!!m[u],onChange:()=>C(u),size:"small"}),t.jsxs(l,{sx:{flex:1,minWidth:0},children:[t.jsx(a,{variant:"body2",sx:{fontWeight:"bold"},noWrap:!0,children:d.name}),t.jsxs(a,{variant:"caption",color:"text.secondary",children:["Available to return: ",p]})]}),d.isComplexVariant?t.jsxs(a,{variant:"body2",sx:{fontWeight:"bold",bgcolor:"action.hover",px:1.5,py:.5,borderRadius:2},children:[y[u]," ",d.unitName]}):t.jsx(it,{quantity:y[u]||1,onQuantityChange:i=>{h(r=>({...r,[u]:!0})),v(r=>({...r,[u]:i}))},min:1,max:p,compact:!0})]})},u)})})]}),n==="full"&&t.jsx(l,{sx:{py:2,textAlign:"center",bgcolor:"action.hover",borderRadius:2},children:t.jsx(a,{variant:"body2",color:"text.secondary",children:"All eligible items will be marked as fully returned."})})]}),t.jsxs(xt,{sx:{p:2.5},children:[t.jsx(O,{onClick:o,color:"inherit",sx:{fontWeight:"bold"},children:"Cancel"}),t.jsx(O,{onClick:R,variant:"contained",color:"primary",disabled:g||n==="partial"&&!Object.values(m).some(d=>d),sx:{fontWeight:"bold",borderRadius:2,px:3},children:g?"Processing...":"Confirm Return"})]})]}):null},_t=(e,o=[],c=0)=>{const s=i=>i.selectedSize?.price||i.price||i.buyPrice||0,n=e.reduce((i,r)=>i+s(r)*r.quantity,0),x=e.reduce((i,r)=>i+(r.taxAmount||0)*r.quantity,0),m=e.reduce((i,r)=>i+(r.addonAmount||0)*r.quantity,0),h=e.reduce((i,r)=>{const j=r.quantity-(r.returnedQuantity||0);return i+s(r)*j},0),y=e.reduce((i,r)=>{const j=r.quantity-(r.returnedQuantity||0);return i+(r.taxAmount||0)*j},0),v=e.reduce((i,r)=>{const j=r.quantity-(r.returnedQuantity||0);return i+(r.addonAmount||0)*j},0),g=e.length>0&&h===0,b=o.reduce((i,r)=>i+r.amount,0),C=g?0:b,R=g?0:c,d=h+y+v+C+R,p=n+x+m+b+c-d;return{subtotal:n,tax:x,itemAddons:m,orderAddons:b,addons:m+b,deliveryAmount:c,total:d,returnedAmount:p,items:e}};export{Zt as A,Jt as O,Xt as R,Kt as a,_t as c};

import{j as e,r as s,I as M,J as P,C as N,K as D,u as j,a as W}from"./index-BWUmnZ-V.js";import{P as S,H as q}from"./Header-DR-rVa1s.js";import{F as B}from"./FlashOn-Dw3Y8MBB.js";import{c as V,a as I}from"./Button-r8OqXN69.js";import{T as O,I as G}from"./TextField-BdLMYpf_.js";import"./Grid-ClCuWJ6r.js";import"./useThemeProps-FiVEh3N3.js";import"./isMuiElement-Ch3aZhZf.js";import"./Select-CQ15JmlV.js";import"./Modal-le2pR6Rq.js";const J=V([e.jsx("path",{d:"M20 5V4c0-1.1-.9-2-2-2s-2 .9-2 2v1h-1v5h6V5zm-1 0h-2V4c0-.55.45-1 1-1s1 .45 1 1z"},"0"),e.jsx("path",{d:"m15.63 14.4-2.52 2.5c-2.5-1.43-4.57-3.5-6-6l2.5-2.52c.23-.24.33-.57.27-.9L9.13 3.8c-.09-.46-.5-.8-.98-.8H4c-.56 0-1.03.47-1 1.03.17 2.89 1.05 5.6 2.43 7.97 1.58 2.73 3.85 4.99 6.57 6.57 2.37 1.37 5.08 2.26 7.97 2.43.56.03 1.03-.44 1.03-1v-4.15c0-.48-.34-.89-.8-.98l-3.67-.73c-.33-.07-.67.03-.9.26"},"1")]),K=V(e.jsx("path",{d:"M2 17h20v2H2zm1.15-4.05L4 11.47l.85 1.48 1.3-.75-.85-1.48H7v-1.5H5.3l.85-1.47L4.85 7 4 8.47 3.15 7l-1.3.75.85 1.47H1v1.5h1.7l-.85 1.48zm6.7-.75 1.3.75.85-1.48.85 1.48 1.3-.75-.85-1.48H15v-1.5h-1.7l.85-1.47-1.3-.75L12 8.47 11.15 7l-1.3.75.85 1.47H9v1.5h1.7zM23 9.22h-1.7l.85-1.47-1.3-.75L20 8.47 19.15 7l-1.3.75.85 1.47H17v1.5h1.7l-.85 1.48 1.3.75.85-1.48.85 1.48 1.3-.75-.85-1.48H23z"})),T=(c,i,a,r)=>{const n=c.target.value.replace(/\D/g,"");n.length<=a&&(i(n),r?.(!0)),n.length===a&&r?.(!1)},L={"& input[type=number]":{MozAppearance:"textfield"},"& input[type=number]::-webkit-outer-spin-button,                                         & input[type=number]::-webkit-inner-spin-button":{WebkitAppearance:"none",margin:0}};function Q({icon:c=e.jsx(B,{}),title:i="Trial Demo",onSuccess:a,onLoading:r}){const[n,C]=s.useState(!1),[d,H]=s.useState(""),[b,z]=s.useState(""),[F,u]=s.useState(!1),[E,m]=s.useState(!1),[w,g]=s.useState(""),[v,k]=s.useState(null),x=s.useRef(null),[h,f]=s.useState(!1);s.useEffect(()=>{x.current||(x.current=new M(P,"recaptcha-container",{size:"invisible",callback:()=>{}}))},[]);const y=t=>{f(t),r&&r(t)},A=async t=>{if(!v){m(!0);return}y(!0);try{const l=await v.confirm(t);a&&a(l.user)}catch(l){console.error("Error verifying OTP:",l),m(!0),y(!1)}},R=async()=>{if(!d){g("Phone number cannot be empty"),u(!0);return}if(d.length<10){g("Please enter a valid 10-digit mobile number"),u(!0);return}const t=x.current;if(!t)return;f(!0);const l="+91"+d;try{const o=await D(P,l,t);k(o),C(!0)}catch(o){console.error("Error sending OTP:",o);let p="Failed to send OTP. Please try again.";o.code==="auth/billing-not-enabled"?p="Server not enabled. Try again later.":o.code==="auth/invalid-app-credential"?p="Invalid Config. Try again later.":o.code==="auth/too-many-requests"&&(p="Too many attempts. Try again later."),g(p),u(!0)}finally{f(!1)}};return e.jsx(S,{children:e.jsxs("span",{className:"signin-page",children:[e.jsx(q,{icon:c,title:i,rightContent:e.jsxs("span",{className:"header-right-content",children:["Need help?Â ",e.jsx("br",{}),e.jsx("span",{className:"highlighted",children:"Contact Support"})]})}),e.jsxs("div",{className:"signin-content",children:[e.jsx("div",{className:"head-text",children:n?"Verify OTP":"Sign in with Phone"}),e.jsxs(S,{variant:"card1",className:"signin-card",children:[e.jsx("div",{children:n?e.jsx(K,{className:"signin-icon"}):e.jsx(J,{className:"signin-icon"})}),e.jsx("div",{className:"head-text-desc",children:n?"Enter the OTP sent to your mobile number for verification.":"Enter your mobile number to access the platform."}),n?e.jsxs(e.Fragment,{children:[e.jsx(O,{name:"otp",value:b,onChange:t=>{m(!1),T(t,z,6)},label:"One Time Password",color:"secondary",placeholder:"x x x x x x",className:"signin-input",type:"number",sx:L}),e.jsx("br",{}),E&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"invalid-msg",children:"Invalid OTP, Please try again."}),e.jsx("br",{})]}),e.jsx(I,{variant:"contained",color:"success",className:"signin-button",onClick:()=>A(b),disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(N,{size:20,color:"inherit"}),e.jsx("span",{style:{marginLeft:"10px"},children:"Verifying..."})]}):"Verify & Sign In"})]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{label:"Phone Number",color:"secondary",placeholder:" 00000 00000",className:"signin-input",name:"phone",value:d,onChange:t=>T(t,H,10,u),type:"number",sx:L,slotProps:{input:{inputMode:"numeric",startAdornment:e.jsx(G,{position:"start",children:"+91"})}}}),e.jsx("br",{}),F&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"invalid-msg",children:w}),e.jsx("br",{})]}),e.jsx("div",{id:"recaptcha-container"}),e.jsx(I,{variant:"contained",color:"success",className:"signin-button",onClick:R,disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(N,{size:20,color:"inherit"}),e.jsx("span",{style:{marginLeft:"10px"},children:"Sending..."})]}):"Get OTP"})]})]})]})]})})}const ae=()=>{const c=j(n=>n.login),i=j(n=>n.isAuthenticated),a=j(n=>n.setLoading),r=W();return s.useEffect(()=>(i&&(a(!0),r({to:"/shop"})),()=>a(!1)),[i,r,a]),e.jsx(Q,{onSuccess:n=>{c(n),r({to:"/shop"})},onLoading:a})};export{ae as component};

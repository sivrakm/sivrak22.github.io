import{r as i,j as e,B as t,I as d,h as s,C as V,_ as g,S as y}from"./index-DxyCEj15.js";import{u as H}from"./pricingStore-PcBgT_-N.js";import{A as _,T as q,a as J,M as A}from"./ArrowBackIosNew-BGmXEOrO.js";import{P as K}from"./Page-BHx2H6bX.js";import{C as Q,E as W}from"./Edit-CvBaen5L.js";import{G as r}from"./Grid-CT5rJy85.js";import{S as U}from"./Switch-DyZp7sqS.js";import{T as h}from"./TextField-aIIEym9U.js";import{B as c}from"./Button-C0BYlUU1.js";import{D as I}from"./Divider-CmVhtnPA.js";import{A as R}from"./Add-gZqJg1iJ.js";import{C as S}from"./Chip-Dmx1LAXp.js";import{D as z}from"./Delete-DsFLbfXQ.js";import{D as X,a as Y,b as Z,c as ee}from"./DialogTitle-nzooP7jj.js";import"./dividerClasses-ttEJLAcw.js";import"./isMuiElement-BCf5HDxN.js";import"./SwitchBase-C-vypceM.js";function ge(){const{rules:b,fetchRules:P,addRule:E,updateRule:B,deleteRule:F,isLoading:N,deliveryConfig:v,fetchDeliveryConfig:G,updateDeliveryConfig:L}=H();i.useEffect(()=>{P(),G()},[]);const[O,C]=i.useState(!1),[u,D]=i.useState(null),[p,$]=i.useState("tax"),[l,o]=i.useState({label:"",type:"tax",valueType:"percentage",value:0}),[n,m]=i.useState({enabled:!1,amount:0});i.useEffect(()=>{m(v)},[v]);const x=(a,f)=>{f?(D(f),o(f)):(D(null),o({label:"",type:a,valueType:"percentage",value:0})),$(a),C(!0)},j=()=>{C(!1)},M=async()=>{if(!l.label||l.value===void 0){alert("Please fill in all fields");return}const a={label:l.label,type:p,valueType:l.valueType,value:Number(l.value)};u?await B({...a,id:u.id}):await E(a),j()},T=async a=>{confirm("Are you sure you want to delete this rule?")&&await F(a)},w=b.filter(a=>a.type==="tax"),k=b.filter(a=>a.type==="addon");return e.jsxs(t,{sx:{pb:10,bgcolor:"background.default",minHeight:"100vh",color:"text.primary"},children:[e.jsx(_,{position:"sticky",color:"default",elevation:0,sx:{bgcolor:"background.paper",borderBottom:1,borderColor:"divider"},children:e.jsxs(q,{children:[e.jsx(d,{onClick:()=>window.history.back(),edge:"start",children:e.jsx(J,{})}),e.jsx(s,{variant:"h6",component:"h1",sx:{flexGrow:1,textAlign:"center",pr:5,fontWeight:"bold"},children:"Pricing Configuration"})]})}),e.jsx(K,{children:e.jsx(Q,{maxWidth:"md",sx:{py:4},children:N?e.jsx(t,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(V,{})}):e.jsxs(r,{container:!0,spacing:4,children:[e.jsx(r,{size:12,children:e.jsx(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsx(s,{variant:"h6",sx:{fontWeight:"bold",color:"text.secondary",textDecoration:"underline"},children:"Order Level (1 per order)"})})}),e.jsxs(r,{size:12,children:[e.jsx(s,{variant:"h6",sx:{fontWeight:"bold",mb:2},children:"Delivery Charge"}),e.jsxs(g,{sx:{p:2,borderRadius:2},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(s,{variant:"subtitle1",fontWeight:"bold",children:"Enable Delivery Charge"}),e.jsx(U,{checked:n.enabled,onChange:a=>m({...n,enabled:a.target.checked})})]}),e.jsx(h,{label:"Amount",type:"number",fullWidth:!0,value:n.amount,disabled:!n.enabled,onChange:a=>m({...n,amount:Number(a.target.value)}),helperText:"Fixed amount applied to the entire order"}),e.jsx(c,{variant:"contained",color:"primary",sx:{mt:2},onClick:async()=>{try{await L(n),alert("Delivery charge saved successfully!")}catch{alert("Failed to save delivery charge. Please try again.")}},children:"Save Delivery Charge"})]})]}),e.jsxs(r,{size:12,children:[e.jsx(I,{}),e.jsx(I,{sx:{my:2}}),e.jsx(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsx(s,{variant:"h6",sx:{fontWeight:"bold",color:"text.secondary",textDecoration:"underline"},children:"Product Level (for each product)"})})]}),e.jsxs(r,{size:12,children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(s,{variant:"h6",sx:{fontWeight:"bold"},children:"Tax Rules"}),e.jsx(c,{variant:"contained",startIcon:e.jsx(R,{}),onClick:()=>x("tax"),size:"small",children:"Add Tax"})]}),e.jsxs(y,{spacing:2,children:[w.length===0&&e.jsx(s,{color:"text.secondary",children:"No tax rules defined."}),w.map(a=>e.jsxs(g,{sx:{p:2,display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:2},children:[e.jsxs(t,{children:[e.jsx(s,{variant:"subtitle1",fontWeight:"bold",children:a.label}),e.jsx(S,{label:`${a.value}${a.valueType==="percentage"?"%":" Fixed"}`,size:"small",color:"primary",variant:"outlined"})]}),e.jsxs(t,{children:[e.jsx(d,{onClick:()=>x("tax",a),size:"small",color:"primary",children:e.jsx(W,{})}),e.jsx(d,{onClick:()=>T(a.id),size:"small",color:"error",children:e.jsx(z,{})})]})]},a.id))]})]}),e.jsxs(r,{size:12,children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(s,{variant:"h6",sx:{fontWeight:"bold"},children:"Add-on Costs"}),e.jsx(c,{variant:"contained",color:"secondary",startIcon:e.jsx(R,{}),onClick:()=>x("addon"),size:"small",children:"Add Add-on"})]}),e.jsxs(y,{spacing:2,children:[k.length===0&&e.jsx(s,{color:"text.secondary",children:"No add-on rules defined."}),k.map(a=>e.jsxs(g,{sx:{p:2,display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:2},children:[e.jsxs(t,{children:[e.jsx(s,{variant:"subtitle1",fontWeight:"bold",children:a.label}),e.jsx(S,{label:`${a.value}${a.valueType==="percentage"?"%":" Fixed"}`,size:"small",color:"secondary",variant:"outlined"})]}),e.jsxs(t,{children:[e.jsx(d,{onClick:()=>x("addon",a),size:"small",color:"primary",children:e.jsx(W,{})}),e.jsx(d,{onClick:()=>T(a.id),size:"small",color:"error",children:e.jsx(z,{})})]})]},a.id))]})]})]})})}),e.jsxs(X,{open:O,onClose:j,maxWidth:"xs",fullWidth:!0,children:[e.jsxs(Y,{children:[u?"Edit":"Add"," ",p==="tax"?"Tax Rule":"Add-on"]}),e.jsx(Z,{children:e.jsxs(y,{spacing:2,sx:{mt:1},children:[e.jsx(h,{label:"Label",fullWidth:!0,placeholder:p==="tax"?"e.g. VAT, GST":"e.g. Gift Wrap, Service Charge",value:l.label,onChange:a=>o({...l,label:a.target.value})}),e.jsxs(h,{select:!0,label:"Type",fullWidth:!0,value:l.valueType,onChange:a=>o({...l,valueType:a.target.value}),children:[e.jsx(A,{value:"percentage",children:"Percentage (%)"}),e.jsx(A,{value:"fixed",children:"Fixed Amount"})]}),e.jsx(h,{label:"Value",type:"number",fullWidth:!0,value:l.value,onChange:a=>o({...l,value:Number(a.target.value)})})]})}),e.jsxs(ee,{children:[e.jsx(c,{onClick:j,children:"Cancel"}),e.jsx(c,{onClick:M,variant:"contained",disabled:!l.label,children:"Save"})]})]})]})}export{ge as component};

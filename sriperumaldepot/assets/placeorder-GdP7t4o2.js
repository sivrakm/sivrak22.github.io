import{g as ie,b as le,r as l,c as ne,d as de,j as e,e as Q,s as ee,f as re,h as ce,m as te,q as pe,t as xe,a as ue,u as me,v as be,w as he,x as ge,y as fe}from"./index-D8P3JBa-.js";import{u as L}from"./cartStore-D8GNFweh.js";import{u as ye}from"./orderStore-BWB9pVfG.js";import{u as je}from"./pricingStore-CaF0Lhcz.js";import{C as ve,n as Ce}from"./index.browser-4_4n6fT8.js";import{T as s,c as $,B as t,a as U}from"./Button-dvIA4wQD.js";import{I as G}from"./IconButton-uPyCecuf.js";import{G as C}from"./Grid-BmYjfydW.js";import{T as x}from"./TextField-B3L_6u-u.js";import{I as Ie}from"./InputAdornment-7x5ul51W.js";import{u as Se,f as Pe}from"./Select-lz534wB5.js";import{D as ke}from"./Dialog-CVho0_dj.js";import{D as De,a as We,b as we}from"./DialogTitle-D1enqnUO.js";import{D as Ae}from"./Delete-CEH76Xj3.js";import{S as Me}from"./Switch-iypnbkZw.js";import{A as Ne}from"./Add-wp1oRCir.js";import{D as ze}from"./Divider-BJ6QIrjd.js";import{P as Fe}from"./Payments-BvMXn6P0.js";import{C as Re}from"./CheckCircle-CkQjL-V9.js";import{S as Te}from"./ShoppingCart-B8XIcZ2F.js";import{A as Le}from"./ArrowBack-tQtRsbO0.js";import"./useThemeProps-XXHDDOu8.js";import"./Modal-DrnKYS8Q.js";import"./dividerClasses-voxUnvog.js";function Ue(a){return le("MuiFormControlLabel",a)}const N=ie("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),$e=a=>{const{classes:i,disabled:n,labelPlacement:c,error:g,required:b}=a,D={root:["root",n&&"disabled",`labelPlacement${re(c)}`,g&&"error",b&&"required"],label:["label",n&&"disabled"],asterisk:["asterisk",g&&"error"]};return ce(D,Ue,i)},qe=ee("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(a,i)=>{const{ownerState:n}=a;return[{[`& .${N.label}`]:i.label},i.root,i[`labelPlacement${re(n.labelPlacement)}`]]}})(te(({theme:a})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${N.disabled}`]:{cursor:"default"},[`& .${N.label}`]:{[`&.${N.disabled}`]:{color:(a.vars||a).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:i})=>i==="start"||i==="top"||i==="bottom",style:{marginLeft:16}}]}))),Oe=ee("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(te(({theme:a})=>({[`&.${N.error}`]:{color:(a.vars||a).palette.error.main}}))),Y=l.forwardRef(function(i,n){const c=ne({props:i,name:"MuiFormControlLabel"}),{checked:g,className:b,componentsProps:D={},control:I,disabled:q,disableTypography:z,inputRef:f,label:O,labelPlacement:H="end",name:X,onChange:W,required:d,slots:V={},slotProps:y={},value:E,...j}=c,w=Se(),F=q??I.props.disabled??w?.disabled,v=d??I.props.required,A={disabled:F,required:v};["checked","name","onChange","value","inputRef"].forEach(m=>{typeof I.props[m]>"u"&&typeof c[m]<"u"&&(A[m]=c[m])});const R=Pe({props:c,muiFormControl:w,states:["error"]}),h={...c,disabled:F,labelPlacement:H,required:v,error:R.error},S=$e(h),M={slots:V,slotProps:{...D,...y}},[_,u]=de("typography",{elementType:s,externalForwardedProps:M,ownerState:h});let p=O;return p!=null&&p.type!==s&&!z&&(p=e.jsx(_,{component:"span",...u,className:Q(S.label,u?.className),children:p})),e.jsxs(qe,{className:Q(S.root,b),ownerState:h,ref:n,...j,children:[l.cloneElement(I,A),v?e.jsxs("div",{children:[p,e.jsxs(Oe,{ownerState:h,"aria-hidden":!0,className:S.asterisk,children:[" ","*"]})]}):p]})}),He=$(e.jsx("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m0 14H4v-6h16zm0-10H4V6h16z"})),Ve=$(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25"})),Ee=$(e.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"})),_e=$(e.jsx("path",{d:"M17 1.01 7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99M17 19H7V5h10z"})),Be=pe()(xe(a=>({shippingDetails:{firstName:"",orgName:"",address:"",zip:"",city:"",phoneNumber:""},setShippingDetails:i=>a({shippingDetails:i})}),{name:"shipping-storage"})),Ge={arrow_back:e.jsx(Le,{}),shopping_cart:e.jsx(Te,{}),check_circle:e.jsx(Re,{}),credit_card:e.jsx(He,{}),help:e.jsx(Ve,{}),lock:e.jsx(Ee,{}),payments:e.jsx(Fe,{}),upi:e.jsx(_e,{})},k=({name:a,filled:i=!1,className:n=""})=>e.jsx(e.Fragment,{children:Ge[a]});function fr(){const[a,i]=l.useState("upi"),[n,c]=l.useState(!1),g=ue(),b=L(r=>r.items),D=L(r=>r.getTotalItems),I=L(r=>r.getTotalPrice),q=L(r=>r.clearCart),z=me(r=>r.user),{shippingDetails:f,setShippingDetails:O}=Be(),H=ye(r=>r.setLastOrder),{fetchDeliveryConfig:X,deliveryConfig:W}=je();l.useState(()=>{X()});const[d,V]=l.useState({firstName:f.firstName,orgName:f.orgName,address:f.address,zip:f.zip,city:f.city,phoneNumber:f.phoneNumber||z?.phoneNumber||""}),[y,E]=l.useState([]),[j,w]=l.useState(null),[F,v]=l.useState(!1),[A,R]=l.useState(""),[h,S]=l.useState(""),[M,_]=l.useState(!1),u=r=>o=>{V({...d,[r]:o.target.value})},p=I(),m=b.reduce((r,o)=>r+(o.taxAmount||0)*o.quantity,0),Z=b.reduce((r,o)=>r+(o.addonAmount||0)*o.quantity,0),J=y.reduce((r,o)=>r+o.amount,0),P=Z+J,T=j!==null?j:W.enabled?W.amount:0,B=p+m+P+T,oe=D(),se=async()=>{if(!n){c(!0);try{O(d);const r={userId:z?.uid||"guest",shippingDetails:d,items:b,subtotal:p,tax:m,itemAddons:Z,orderAddons:J,addons:P,manualAddons:y,deliveryAmount:T,total:B,paymentMethod:a,status:"pending",timestamp:be()},o=await he(ge(fe,"orders"),r);H({...r,id:o.id}),q(),g({to:"/orders"})}catch(r){console.error("Error placing order:",r),alert("Failed to place order. Please try again.")}finally{c(!1)}}};return e.jsxs(t,{sx:{pb:30,bgcolor:"background.default",minHeight:"100vh",color:"text.primary",position:"relative"},children:[e.jsx(t,{sx:{position:"sticky",top:0,zIndex:1100,bgcolor:"background.default/90",backdropFilter:"blur(20px)",borderBottom:1,borderColor:"divider"},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:2,height:64},children:[e.jsx(G,{sx:{ml:-1,bgcolor:"action.hover"},onClick:()=>g({to:"/checkout"}),children:e.jsx(k,{name:"arrow_back"})}),e.jsx(s,{variant:"h6",sx:{fontWeight:"bold"},children:"Checkout"}),e.jsx(t,{sx:{width:40}})," "]})}),e.jsxs(t,{sx:{p:2,display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1.5},children:[e.jsx(s,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",textTransform:"uppercase",letterSpacing:1},children:"Order Summary"}),e.jsx(U,{size:"small",onClick:()=>g({to:"/checkout"}),sx:{fontSize:"0.75rem",fontWeight:500,color:"info.main",minWidth:"auto",p:0,"&:hover":{color:"text.primary",bgcolor:"transparent"}},children:"Edit Cart"})]}),e.jsx(t,{sx:{bgcolor:"background.paper",borderRadius:3,border:1,borderColor:"divider",p:2,boxShadow:"none"},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(t,{sx:{display:"flex",ml:1.5},children:e.jsx(t,{sx:{width:48,height:48,bgcolor:"action.hover",borderRadius:2,border:2,borderColor:"background.paper",display:"flex",alignItems:"center",justifyContent:"center",zIndex:30,ml:-1.5},children:e.jsx(k,{name:"shopping_cart",className:"!text-xl text-text-secondary"})})}),e.jsxs(t,{sx:{flex:1,minWidth:0,display:"flex",flexDirection:"column",justifyContent:"center"},children:[e.jsxs(s,{variant:"body2",style:{fontWeight:"bold",whiteSpace:"nowrap"},children:[oe," Items"]}),e.jsx(t,{style:{color:"text.secondary",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:b.map((r,o)=>e.jsxs(s,{variant:"body2",children:[r.quantity," x ",r.selectedSize?.label.slice(0,5),"..,",r.name.slice(0,10),".."]},`${r.id}-${r.selectedSize?.label||"default"}-${o}`))})]})]})}),e.jsxs(t,{sx:{mb:2.5,px:0,pt:2},children:[e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:1,mb:1.5},children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(s,{variant:"body2",color:"text.secondary",sx:{minWidth:100},children:"Subtotal"}),e.jsxs(s,{variant:"body2",color:"text.primary",sx:{fontWeight:500,textAlign:"right"},children:["₹",p.toFixed(2)]})]}),m>0&&e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(s,{variant:"body2",color:"text.secondary",sx:{minWidth:100},children:"Tax"}),e.jsxs(s,{variant:"body2",color:"text.primary",sx:{fontWeight:500,textAlign:"right"},children:["₹",m.toFixed(2)]})]}),P!==0&&e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(s,{variant:"body2",color:"text.secondary",sx:{minWidth:100},children:"Add-ons/Discounts"}),e.jsxs(s,{variant:"body2",color:P>0?"text.primary":"error.main",sx:{fontWeight:500,textAlign:"right"},children:[P<0?"-":"","₹",Math.abs(P).toFixed(2)]})]}),(T!==0||j!==null)&&e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(s,{variant:"body2",color:"text.secondary",sx:{minWidth:100},children:"Delivery"}),e.jsxs(s,{variant:"body2",color:"text.primary",sx:{fontWeight:500,textAlign:"right"},children:["₹",T.toFixed(2)]})]})]}),e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pt:1.5,borderTop:"1px dashed",borderColor:"divider"},children:[e.jsx(s,{variant:"body1",sx:{fontWeight:"bold",minWidth:100},children:"Total"}),e.jsxs(s,{variant:"h6",sx:{fontWeight:"bold",color:"primary.main",textAlign:"right"},children:["₹",B.toFixed(2)]})]}),e.jsx(t,{sx:{display:"flex",justifyContent:"flex-end",mt:1},children:e.jsx(U,{size:"small",onClick:()=>{j===null&&w(W.enabled?W.amount:0),v(!0)},sx:{fontSize:"0.75rem",fontWeight:500,color:"primary.main",p:0},children:"Edit Pricing"})})]})]}),e.jsxs(t,{children:[e.jsx(s,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",textTransform:"uppercase",letterSpacing:1,display:"block",mb:1.5},children:"Shipping Address"}),e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[e.jsxs(C,{container:!0,spacing:1.5,children:[e.jsx(C,{size:12,children:e.jsx(x,{label:"First Name",variant:"filled",fullWidth:!0,value:d.firstName,onChange:u("firstName"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})}),e.jsx(C,{size:12,children:e.jsx(x,{label:"Organization Name",variant:"filled",fullWidth:!0,value:d.orgName,onChange:u("orgName"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})}),e.jsx(C,{size:12,children:e.jsx(x,{label:"Phone Number",variant:"filled",fullWidth:!0,placeholder:"+91 99999 99999",value:d.phoneNumber,onChange:u("phoneNumber"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})})]}),e.jsx(x,{label:"Address",variant:"filled",fullWidth:!0,value:d.address,onChange:u("address"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}}),e.jsxs(C,{container:!0,spacing:1.5,children:[e.jsx(C,{size:4,children:e.jsx(x,{label:"Zip Code",variant:"filled",fullWidth:!0,value:d.zip,onChange:u("zip"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})}),e.jsx(C,{size:8,children:e.jsx(x,{label:"City",variant:"filled",fullWidth:!0,value:d.city,onChange:u("city"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})})]})]})]}),e.jsxs(t,{children:[e.jsx(s,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",textTransform:"uppercase",letterSpacing:1,display:"block",mb:1.5},children:"Payment Method"}),e.jsx(t,{sx:{display:"flex",gap:1.5,mb:2,overflowX:"auto",pb:.5},children:["upi","payments"].map(r=>{const o=a===r,K={upi:"UPI",payments:"Cash"};return e.jsxs(t,{component:"button",onClick:()=>i(r),sx:{flex:1,minWidth:110,p:1.5,borderRadius:3,border:o?2:1,borderColor:o?"primary.main":"divider",bgcolor:o?"rgba(103, 103, 103, 0.1)":"background.paper",display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",height:80,position:"relative",transition:"all 0.2s","&:active":{transform:"scale(0.95)"}},children:[o&&e.jsx(t,{sx:{position:"absolute",top:8,right:8,color:"primary.main"},children:e.jsx(k,{name:"check_circle",filled:!0})}),e.jsx(t,{sx:{color:o?"primary.main":"text.secondary"},children:e.jsx(k,{name:r})}),e.jsx(s,{variant:"caption",sx:{fontWeight:o?"bold":"medium",color:o?"text.primary":"text.secondary"},children:K[r]})]},r)})}),a==="upi"&&e.jsxs(t,{sx:{bgcolor:"background.paper",borderRadius:3,border:1,borderColor:"divider",p:2,display:"flex",flexDirection:"column",gap:1.5},children:[e.jsx(x,{label:"UPI ID",variant:"filled",fullWidth:!0,placeholder:"username@bank",defaultValue:"mystore@a123bank",disabled:!0,sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"action.hover",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0,endAdornment:e.jsx(Ie,{position:"end",children:e.jsx(k,{name:"upi",className:"text-text-disabled"})})}}),e.jsx(s,{variant:"caption",color:"text.secondary",sx:{px:.5},children:"Securely pay using your favorite UPI app (GPay, PhonePe, Paytm, etc)."})]}),e.jsx(t,{sx:{display:"flex",alignItems:"center",mt:2},children:e.jsx(Y,{control:e.jsx(ve,{defaultChecked:!0,sx:{color:"text.secondary","&.Mui-checked":{color:"primary.main"}}}),label:e.jsx(s,{variant:"body2",color:"text.secondary",children:"Save this VPA for future purchases"})})})]})]}),e.jsx(t,{sx:{position:"fixed",bottom:0,left:0,right:0,bgcolor:"background.paper",borderTop:1,borderColor:"divider",p:3,pb:4,borderTopLeftRadius:24,borderTopRightRadius:24,boxShadow:"0 -8px 30px rgba(0,0,0,0.1)",zIndex:1e3},children:e.jsxs(U,{variant:"contained",color:"primary",fullWidth:!0,size:"large",sx:{borderRadius:4,py:2,variant:"contained",color:"primary",fontSize:"1rem",fontWeight:"bold",textTransform:"none",boxShadow:"0 8px 20px -4px rgba(242, 238, 13, 0.3)",display:"flex",justifyContent:"center",gap:1.5},onClick:se,disabled:n,children:[e.jsx(k,{name:"lock"}),n?"Processing...":`Place Order • Rs ${B.toFixed(2)}`]})}),e.jsxs(ke,{open:F,onClose:()=>v(!1),maxWidth:"xs",fullWidth:!0,PaperProps:{sx:{borderRadius:4,bgcolor:"background.paper"}},children:[e.jsx(De,{sx:{fontWeight:"bold"},children:"Edit Pricing"}),e.jsx(We,{children:e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsx(s,{variant:"subtitle2",sx:{fontWeight:"bold",color:"text.secondary"},children:"Addons / Discounts"}),e.jsx(t,{sx:{display:"flex",flexDirection:"column",gap:1},children:y.map((r,o)=>e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",bgcolor:"action.hover",p:1,borderRadius:2},children:[e.jsx(s,{variant:"body2",children:r.label}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsxs(s,{variant:"body2",sx:{fontWeight:"bold"},children:["₹",r.amount.toFixed(2)]}),e.jsx(G,{size:"small",color:"error",onClick:()=>E(y.filter((K,ae)=>ae!==o)),children:e.jsx(Ae,{fontSize:"small"})})]})]},o))}),e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsx(t,{sx:{display:"flex",gap:1},children:e.jsx(x,{label:"Description(optional)",variant:"outlined",size:"small",fullWidth:!0,value:A,onChange:r=>R(r.target.value)})}),e.jsx(t,{sx:{display:"flex",gap:1},children:e.jsx(x,{label:"Amount",type:"number",variant:"outlined",size:"small",fullWidth:!0,value:h,onChange:r=>S(r.target.value)})}),e.jsx(t,{sx:{display:"flex",gap:1,justifyContent:"center"},children:e.jsx(Y,{control:e.jsx(Me,{size:"small",checked:M,onChange:r=>_(r.target.checked),color:"error"}),label:e.jsx(s,{variant:"caption",color:M?"error":"text.secondary",children:"Treat as Discount"})})}),e.jsx(G,{color:"primary",sx:{border:"2px solid #ccc",borderRadius:2},onClick:()=>{if(h){const r=A||`manual-${Ce(5)}`,o=Number(h)*(M?-1:1);E([...y,{label:r,amount:o}]),R(""),S("")}},children:e.jsx(Ne,{})})]}),e.jsx(ze,{sx:{my:1}}),e.jsx(s,{variant:"subtitle2",sx:{fontWeight:"bold",color:"text.secondary"},children:"Delivery Charge"}),e.jsx(x,{label:"Delivery Amount",type:"number",variant:"outlined",fullWidth:!0,value:j??0,onChange:r=>w(Number(r.target.value)),helperText:"Set to 0 to remove delivery charge"})]})}),e.jsx(we,{sx:{p:2},children:e.jsx(U,{onClick:()=>v(!1),fullWidth:!0,variant:"contained",sx:{borderRadius:3,py:1.5,fontWeight:"bold"},children:"Done"})})]})]})}export{fr as component};

import{y as h,Z as u,G as i,a0 as m,_ as f,F as g,E as D,N as I}from"./index-Bkxv6Uxe.js";const S=h(c=>({categories:[],activeCategory:"All Items",products:[],categoryItems:[],isLoading:!1,error:null,setActiveCategory:t=>c({activeCategory:t}),fetchProducts:async()=>{c({isLoading:!0,error:null});try{const t=g(i,"products"),o=(await I(t)).docs.map(a=>({...a.data(),id:a.id})),r=await w();c({categoryItems:r}),c({categories:["All Items",...r.map(a=>a.name)]}),c({products:o,isLoading:!1})}catch(t){console.error("Error fetching products:",t),c({error:t.message,isLoading:!1})}},pushProducttoDb:async t=>{const e=g(i,"products");await D(e,t)},updateProduct:async t=>{const{id:e,...o}=t;if(!e||typeof e!="string"){console.error("Cannot update product without a valid Firestore ID string:",e);return}const r=u(i,"products",e);await f(r,o),c(a=>({products:a.products.map(n=>n.id===e?{...n,...o}:n)}))},deleteProduct:async t=>{const e=String(t),o=u(i,"products",e);await m(o),c(r=>({products:r.products.filter(a=>a.id!==t)}))},pushCategorytoDb:async t=>{const e=g(i,"categories");await D(e,t)},updateCategory:async t=>{const{id:e,...o}=t;if(!e||typeof e!="string"){console.error("Cannot update category without a valid Firestore ID string:",e);return}const r=u(i,"categories",e);await f(r,o),c(a=>{const n=a.categoryItems.map(s=>s.id===e?{...s,...o}:s),d=a.products.map(s=>s.id===e?{...s,...o}:s),p=a.categoryItems.find(s=>s.id===e)?.name,y=o.name;let l=a.categories;return p&&y&&p!==y&&(l=a.categories.map(s=>s===p?y:s)),{categoryItems:n,products:d,categories:l}})},deleteCategory:async t=>{const e=String(t),o=u(i,"categories",e);await m(o),c(r=>{const n=r.categoryItems.find(d=>d.id===t)?.name;return{categoryItems:r.categoryItems.filter(d=>d.id!==t),products:r.products.filter(d=>d.id!==t),categories:r.categories.filter(d=>d!==n)}})}})),w=async()=>{const c=g(i,"categories");return(await I(c)).docs.map(o=>({...o.data(),id:o.id}))};export{S as u};

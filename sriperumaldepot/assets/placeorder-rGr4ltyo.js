import{v as G,t as X,r as v,x as Z,E as J,j as e,z as H,y as V,D as B,A as K,B as E,c as Q,p as Y,a as ee,u as re,a2 as oe,n as te,b as se,d as ae}from"./index-jkkTBVtM.js";import{u as N}from"./cartStore-pZJ3w07c.js";import{u as ie}from"./orderStore-DELeE4h6.js";import{u as le}from"./pricingStore-C-tbukPv.js";import{T as i,c as w,B as o,a as O}from"./Button-DyWE-TO5.js";import{I as ne}from"./IconButton-bdtkLUFW.js";import{G as h}from"./Grid-DCSbaDKa.js";import{T as f}from"./TextField-GSq9JZz_.js";import{I as de}from"./InputAdornment-CJu-REmS.js";import{u as ce,f as pe}from"./Select-BQ32v_-G.js";import{C as ue}from"./Checkbox-Bzc4TnDB.js";import{P as xe}from"./Payments-Cc4gf6S7.js";import{C as me}from"./CheckCircle-CmKJvVu_.js";import{S as be}from"./ShoppingCart-Bh_hawVn.js";import{A as he}from"./ArrowBack-Bodv_Abl.js";import"./useThemeProps-CaWGZOjg.js";import"./Modal-BAVllA8P.js";import"./SwitchBase-B_-h0qfG.js";function fe(s){return X("MuiFormControlLabel",s)}const S=G("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),ge=s=>{const{classes:a,disabled:l,labelPlacement:d,error:u,required:c}=s,C={root:["root",l&&"disabled",`labelPlacement${B(d)}`,u&&"error",c&&"required"],label:["label",l&&"disabled"],asterisk:["asterisk",u&&"error"]};return K(C,fe,a)},ye=V("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(s,a)=>{const{ownerState:l}=s;return[{[`& .${S.label}`]:a.label},a.root,a[`labelPlacement${B(l.labelPlacement)}`]]}})(E(({theme:s})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${S.disabled}`]:{cursor:"default"},[`& .${S.label}`]:{[`&.${S.disabled}`]:{color:(s.vars||s).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:a})=>a==="start"||a==="top"||a==="bottom",style:{marginLeft:16}}]}))),je=V("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(E(({theme:s})=>({[`&.${S.error}`]:{color:(s.vars||s).palette.error.main}}))),ve=v.forwardRef(function(a,l){const d=Z({props:a,name:"MuiFormControlLabel"}),{checked:u,className:c,componentsProps:C={},control:g,disabled:R,disableTypography:k,inputRef:x,label:L,labelPlacement:T="end",name:$,onChange:D,required:n,slots:W={},slotProps:p={},value:F,...I}=d,m=ce(),P=R??g.props.disabled??m?.disabled,b=n??g.props.required,M={disabled:P,required:b};["checked","name","onChange","value","inputRef"].forEach(z=>{typeof g.props[z]>"u"&&typeof d[z]<"u"&&(M[z]=d[z])});const A=pe({props:d,muiFormControl:m,states:["error"]}),r={...d,disabled:P,labelPlacement:T,required:b,error:A.error},t=ge(r),U={slots:W,slotProps:{...C,...p}},[_,q]=J("typography",{elementType:i,externalForwardedProps:U,ownerState:r});let y=L;return y!=null&&y.type!==i&&!k&&(y=e.jsx(_,{component:"span",...q,className:H(t.label,q?.className),children:y})),e.jsxs(ye,{className:H(t.root,c),ownerState:r,ref:l,...I,children:[v.cloneElement(g,M),b?e.jsxs("div",{children:[y,e.jsxs(je,{ownerState:r,"aria-hidden":!0,className:t.asterisk,children:[" ","*"]})]}):y]})}),Ce=w(e.jsx("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m0 14H4v-6h16zm0-10H4V6h16z"})),Ie=w(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25"})),Pe=w(e.jsx("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"})),Se=w(e.jsx("path",{d:"M17 1.01 7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99M17 19H7V5h10z"})),ke=Q()(Y(s=>({shippingDetails:{firstName:"",orgName:"",address:"",zip:"",city:"",phoneNumber:""},setShippingDetails:a=>s({shippingDetails:a})}),{name:"shipping-storage"})),Fe={arrow_back:e.jsx(he,{}),shopping_cart:e.jsx(be,{}),check_circle:e.jsx(me,{}),credit_card:e.jsx(Ce,{}),help:e.jsx(Ie,{}),lock:e.jsx(Pe,{}),payments:e.jsx(xe,{}),upi:e.jsx(Se,{})},j=({name:s,filled:a=!1,className:l=""})=>e.jsx(e.Fragment,{children:Fe[s]});function _e(){const[s,a]=v.useState("upi"),[l,d]=v.useState(!1),u=ee(),c=N(r=>r.items),C=N(r=>r.getTotalItems),g=N(r=>r.getTotalPrice),R=N(r=>r.clearCart),k=re(r=>r.user),{shippingDetails:x,setShippingDetails:L}=ke(),T=ie(r=>r.setLastOrder),{fetchDeliveryConfig:$,deliveryConfig:D}=le();v.useState(()=>{$()});const[n,W]=v.useState({firstName:x.firstName,orgName:x.orgName,address:x.address,zip:x.zip,city:x.city,phoneNumber:x.phoneNumber||k?.phoneNumber||""}),p=r=>t=>{W({...n,[r]:t.target.value})},F=g(),I=c.reduce((r,t)=>r+(t.taxAmount||0)*t.quantity,0),m=c.reduce((r,t)=>r+(t.addonAmount||0)*t.quantity,0),P=D.enabled?D.amount:0,b=F+I+m+P,M=C(),A=async()=>{if(!l){d(!0);try{L(n);const r={userId:k?.uid||"guest",shippingDetails:n,items:c,subtotal:F,tax:I,addons:m,deliveryAmount:P,total:b,paymentMethod:s,status:"pending",timestamp:oe()};await te(se(ae,"orders"),r),T(r),R(),u({to:"/orders"})}catch(r){console.error("Error placing order:",r),alert("Failed to place order. Please try again.")}finally{d(!1)}}};return e.jsxs(o,{sx:{pb:30,bgcolor:"background.default",minHeight:"100vh",color:"text.primary",position:"relative"},children:[e.jsx(o,{sx:{position:"sticky",top:0,zIndex:1100,bgcolor:"background.default/90",backdropFilter:"blur(20px)",borderBottom:1,borderColor:"divider"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:2,height:64},children:[e.jsx(ne,{sx:{ml:-1,bgcolor:"action.hover"},onClick:()=>u({to:"/checkout"}),children:e.jsx(j,{name:"arrow_back"})}),e.jsx(i,{variant:"h6",sx:{fontWeight:"bold"},children:"Checkout"}),e.jsx(o,{sx:{width:40}})," "]})}),e.jsxs(o,{sx:{p:2,display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(o,{children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1.5},children:[e.jsx(i,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",textTransform:"uppercase",letterSpacing:1},children:"Order Summary"}),e.jsx(O,{size:"small",onClick:()=>u({to:"/checkout"}),sx:{fontSize:"0.75rem",fontWeight:500,color:"info.main",minWidth:"auto",p:0,"&:hover":{color:"text.primary",bgcolor:"transparent"}},children:"Edit Cart"})]}),e.jsx(o,{sx:{bgcolor:"background.paper",borderRadius:3,border:1,borderColor:"divider",p:2,boxShadow:"none"},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(o,{sx:{display:"flex",ml:1.5},children:e.jsx(o,{sx:{width:48,height:48,bgcolor:"action.hover",borderRadius:2,border:2,borderColor:"background.paper",display:"flex",alignItems:"center",justifyContent:"center",zIndex:30,ml:-1.5},children:e.jsx(j,{name:"shopping_cart",className:"!text-xl text-text-secondary"})})}),e.jsxs(o,{sx:{flex:1,minWidth:0,display:"flex",flexDirection:"column",justifyContent:"center"},children:[e.jsxs(i,{variant:"body2",style:{fontWeight:"bold",whiteSpace:"nowrap"},children:[M," Items"]}),e.jsx(o,{style:{color:"text.secondary",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:c.map((r,t)=>e.jsxs(i,{variant:"body2",children:[r.quantity," x ",r.selectedSize?.label.slice(0,5),"..,",r.name.slice(0,10),".."]},`${r.id}-${r.selectedSize?.label||"default"}-${t}`))})]})]})}),e.jsxs(o,{sx:{mb:2.5,px:0,pt:2},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"baseline",mb:.5},children:[e.jsx(i,{variant:"body2",sx:{fontWeight:500,color:"text.secondary"},children:"Total Amount"}),e.jsxs(i,{variant:"h5",sx:{fontWeight:"bold",color:"primary.main"},children:["₹",b.toFixed(2)]})]}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-end",gap:1,fontSize:"0.75rem",color:"text.disabled"},children:[e.jsxs(i,{variant:"caption",color:"inherit",children:["Subtotal: ₹",F.toFixed(2)]}),e.jsxs(i,{variant:"caption",color:"inherit",children:["Tax: ₹",I.toFixed(2)]}),m>0&&e.jsxs(i,{variant:"caption",color:"inherit",children:["Addons: ₹",m.toFixed(2)]})]})]})]}),e.jsxs(o,{children:[e.jsx(i,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",textTransform:"uppercase",letterSpacing:1,display:"block",mb:1.5},children:"Shipping Address"}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column",gap:1.5},children:[e.jsxs(h,{container:!0,spacing:1.5,children:[e.jsx(h,{size:12,children:e.jsx(f,{label:"First Name",variant:"filled",fullWidth:!0,value:n.firstName,onChange:p("firstName"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})}),e.jsx(h,{size:12,children:e.jsx(f,{label:"Organization Name",variant:"filled",fullWidth:!0,value:n.orgName,onChange:p("orgName"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})}),e.jsx(h,{size:12,children:e.jsx(f,{label:"Phone Number",variant:"filled",fullWidth:!0,placeholder:"+91 99999 99999",value:n.phoneNumber,onChange:p("phoneNumber"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})})]}),e.jsx(f,{label:"Address",variant:"filled",fullWidth:!0,value:n.address,onChange:p("address"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}}),e.jsxs(h,{container:!0,spacing:1.5,children:[e.jsx(h,{size:4,children:e.jsx(f,{label:"Zip Code",variant:"filled",fullWidth:!0,value:n.zip,onChange:p("zip"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})}),e.jsx(h,{size:8,children:e.jsx(f,{label:"City",variant:"filled",fullWidth:!0,value:n.city,onChange:p("city"),sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"background.paper",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0}})})]})]})]}),e.jsxs(o,{children:[e.jsx(i,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",textTransform:"uppercase",letterSpacing:1,display:"block",mb:1.5},children:"Payment Method"}),e.jsx(o,{sx:{display:"flex",gap:1.5,mb:2,overflowX:"auto",pb:.5},children:["upi","payments"].map(r=>{const t=s===r,U={upi:"UPI",payments:"Cash"};return e.jsxs(o,{component:"button",onClick:()=>a(r),sx:{flex:1,minWidth:110,p:1.5,borderRadius:3,border:t?2:1,borderColor:t?"primary.main":"divider",bgcolor:t?"rgba(103, 103, 103, 0.1)":"background.paper",display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",height:80,position:"relative",transition:"all 0.2s","&:active":{transform:"scale(0.95)"}},children:[t&&e.jsx(o,{sx:{position:"absolute",top:8,right:8,color:"primary.main"},children:e.jsx(j,{name:"check_circle",filled:!0})}),e.jsx(o,{sx:{color:t?"primary.main":"text.secondary"},children:e.jsx(j,{name:r})}),e.jsx(i,{variant:"caption",sx:{fontWeight:t?"bold":"medium",color:t?"text.primary":"text.secondary"},children:U[r]})]},r)})}),s==="upi"&&e.jsxs(o,{sx:{bgcolor:"background.paper",borderRadius:3,border:1,borderColor:"divider",p:2,display:"flex",flexDirection:"column",gap:1.5},children:[e.jsx(f,{label:"UPI ID",variant:"filled",fullWidth:!0,placeholder:"username@bank",defaultValue:"mystore@a123bank",disabled:!0,sx:{"& .MuiFilledInput-root":{borderRadius:3,bgcolor:"action.hover",border:1,borderColor:"divider"},"& .MuiInputLabel-root":{color:"text.secondary"}},InputProps:{disableUnderline:!0,endAdornment:e.jsx(de,{position:"end",children:e.jsx(j,{name:"upi",className:"text-text-disabled"})})}}),e.jsx(i,{variant:"caption",color:"text.secondary",sx:{px:.5},children:"Securely pay using your favorite UPI app (GPay, PhonePe, Paytm, etc)."})]}),e.jsx(o,{sx:{display:"flex",alignItems:"center",mt:2},children:e.jsx(ve,{control:e.jsx(ue,{defaultChecked:!0,sx:{color:"text.secondary","&.Mui-checked":{color:"primary.main"}}}),label:e.jsx(i,{variant:"body2",color:"text.secondary",children:"Save this VPA for future purchases"})})})]})]}),e.jsx(o,{sx:{position:"fixed",bottom:0,left:0,right:0,bgcolor:"background.paper",borderTop:1,borderColor:"divider",p:3,pb:4,borderTopLeftRadius:24,borderTopRightRadius:24,boxShadow:"0 -8px 30px rgba(0,0,0,0.1)",zIndex:1e3},children:e.jsxs(O,{variant:"contained",color:"primary",fullWidth:!0,size:"large",sx:{borderRadius:4,py:2,variant:"contained",color:"primary",fontSize:"1rem",fontWeight:"bold",textTransform:"none",boxShadow:"0 8px 20px -4px rgba(242, 238, 13, 0.3)",display:"flex",justifyContent:"center",gap:1.5},onClick:A,disabled:l,children:[e.jsx(j,{name:"lock"}),l?"Processing...":`Place Order • Rs ${b.toFixed(2)}`]})})]})}export{_e as component};

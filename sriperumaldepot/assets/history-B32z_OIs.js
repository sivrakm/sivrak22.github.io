import{a as W,u as z,r as c,j as e,B as s,I as h,A as L,h as o,C as O,l as E,i as B,E as u,k as F,S as f,n as N,o as H,y as P,z as R,D as $,F as Y,x as q}from"./index-DHY1Ru8d.js";import{O as M}from"./OrderItem-WTZeaSz2.js";import{Y as U}from"./index-Dlhn0XRi.js";import{S as G}from"./Search-CUtR-E3e.js";import{B as y}from"./Button-I2KpT16O.js";import{C as J}from"./CheckCircle-DM50iUtf.js";import{C as V,I as X,H as _}from"./Inventory2-C_mMwiW1.js";import{L as K}from"./LocalShipping-DMwRZZut.js";import"./ShoppingCart-CYGP5sj6.js";const d=q`
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
`;function ae(){const j=W(),x=z(r=>r.user),[v,C]=c.useState([]),[S,m]=c.useState(!0),[i,w]=c.useState("All"),[p,k]=c.useState(null),D=["All","Processing","Delivered","Cancelled"];c.useEffect(()=>{(async()=>{if(!x){m(!1);return}try{const t=N(H,"orders"),n=P(t,R("userId","==",x.uid),$("timestamp","desc")),l=(await Y(n)).docs.map(g=>({id:g.id,...g.data()}));C(l)}catch(t){console.error("Error fetching orders:",t)}finally{m(!1)}})()},[x]);const b=v.filter(r=>i==="All"?!0:(r.status==="pending"?"Processing":r.status).toLowerCase()===i.toLowerCase()),I=r=>{switch(r.toLowerCase()){case"pending":case"processing":return{label:"Processing",icon:e.jsx(_,{fontSize:"small"}),color:"warning.main",bgcolor:"rgba(237, 108, 2, 0.1)",borderColor:"rgba(237, 108, 2, 0.2)"};case"shipped":return{label:"Shipped",icon:e.jsx(K,{fontSize:"small"}),color:"info.main",bgcolor:"rgba(2, 136, 209, 0.1)",borderColor:"rgba(2, 136, 209, 0.2)"};case"delivered":return{label:"Delivered",icon:e.jsx(X,{fontSize:"small"}),color:"success.main",bgcolor:"rgba(46, 125, 50, 0.1)",borderColor:"rgba(46, 125, 50, 0.2)"};case"cancelled":return{label:"Cancelled",icon:e.jsx(V,{fontSize:"small"}),color:"error.main",bgcolor:"rgba(211, 47, 47, 0.1)",borderColor:"rgba(211, 47, 47, 0.2)"};default:return{label:"Completed",icon:e.jsx(J,{fontSize:"small"}),color:"text.secondary",bgcolor:"action.hover",borderColor:"divider"}}},T=r=>{if(!r)return"Just now";const t=r.toDate(),a=new Date().getTime()-t.getTime(),l=Math.floor(a/(1e3*60*60*24));return l===0?`Today, ${t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:l===1?`Yesterday, ${t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},A=r=>{k(p===r?null:r)};return e.jsxs(s,{sx:{pb:10,bgcolor:"background.default",minHeight:"100vh",color:"text.primary"},children:[e.jsx(s,{sx:{position:"sticky",top:0,zIndex:1100,bgcolor:"background.default",borderBottom:1,borderColor:"divider"},children:e.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:2,height:60},children:[e.jsx(h,{sx:{ml:-1},onClick:()=>j({to:"/shop"}),children:e.jsx(L,{})}),e.jsxs(o,{variant:"h6",sx:{fontWeight:"bold"},children:["Estimate"," History"]}),e.jsx(h,{sx:{mr:-1},children:e.jsx(G,{})})]})}),e.jsxs(s,{sx:{p:2},children:[e.jsx(s,{sx:{display:"flex",gap:1.5,overflowX:"auto",p:2,mb:2,"&::-webkit-scrollbar":{display:"none"},animation:`${d} 0.6s ease-out forwards`},children:D.map(r=>e.jsx(y,{variant:i===r?"contained":"outlined",onClick:()=>w(r),sx:{flexShrink:0,borderRadius:50,textTransform:"none",fontWeight:"bold",fontSize:"0.875rem",px:3,py:1,bgcolor:i===r?"primary.main":"background.paper",color:i===r?"black":"text.secondary",borderColor:i===r?"primary.main":"divider",boxShadow:i===r?"0 4px 12px rgba(242, 215, 13, 0.2)":"none","&:hover":{bgcolor:i===r?"primary.main":"action.hover",borderColor:i===r?"primary.main":"divider"}},children:r},r))}),S?e.jsx(s,{sx:{display:"flex",justifyContent:"center",py:8},children:e.jsx(O,{})}):b.length===0?e.jsx(s,{sx:{textAlign:"center",py:8,animation:`${d} 0.6s ease-out forwards`},children:e.jsx(o,{color:"text.secondary",children:"No orders found."})}):e.jsx(s,{sx:{width:"100%",animation:`${d} 0.6s ease-out forwards`,animationDelay:"0.1s"},children:e.jsx(U,{useWindowScroll:!0,increaseViewportBy:300,data:b,itemContent:(r,t)=>{const n=I(t.status);return e.jsx(s,{sx:{pb:2},children:e.jsx(E,{sx:{p:2,borderRadius:3,border:1,borderColor:"divider",boxShadow:"none",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",transition:"all 0.2s","&:active":{transform:"scale(0.98)"}},onClick:()=>A(t.id),children:e.jsxs(s,{sx:{width:"100%"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(s,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(B,{sx:{width:48,height:48,bgcolor:n.bgcolor,color:n.color,border:1,borderColor:n.borderColor},children:n.icon}),e.jsxs(s,{children:[e.jsxs(o,{variant:"body2",sx:{fontWeight:"bold"},children:["Estimate"," #",t.id.slice(0,5).toUpperCase()]}),e.jsx(o,{variant:"caption",sx:{color:"text.secondary",mt:.5,display:"block"},children:T(t.timestamp)})]})]}),e.jsxs(s,{sx:{textAlign:"right",display:"flex",alignItems:"center",gap:1},children:[e.jsxs(s,{children:[e.jsxs(o,{variant:"body2",sx:{fontWeight:"bold"},children:["₹",t.total.toLocaleString()]}),e.jsx(s,{sx:{display:"inline-block",mt:.5,px:1.5,py:.25,borderRadius:10,bgcolor:n.bgcolor,color:n.color,fontSize:"0.625rem",fontWeight:"bold",textTransform:"uppercase",letterSpacing:.5},children:n.label})]}),e.jsx(h,{size:"small",sx:{transform:p===t.id?"rotate(180deg)":"none",transition:"transform 0.3s"},children:e.jsx(u,{})})]})]}),e.jsxs(F,{in:p===t.id,timeout:"auto",unmountOnExit:!0,children:[e.jsxs(s,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:[e.jsx(o,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",mb:1.5,display:"block",textTransform:"uppercase",letterSpacing:.5},children:"Shipping Details"}),e.jsxs(o,{variant:"caption",sx:{color:"text.primary",display:"block",mb:2,fontSize:"0.8rem",lineHeight:1.6},children:[e.jsx("strong",{children:"Name:"})," ",t.shippingDetails?.firstName," ",t.shippingDetails?.orgName?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("strong",{children:"Org:"})," ",t.shippingDetails.orgName]}):"",e.jsx("br",{}),e.jsx("strong",{children:"Phone:"})," ",t.shippingDetails?.phoneNumber,e.jsx("br",{}),e.jsx("strong",{children:"Address:"})," ",t.shippingDetails?.address,", ",t.shippingDetails?.city,", ",t.shippingDetails?.zip]})]}),e.jsxs(s,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:[e.jsxs(o,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",mb:1.5,display:"block",textTransform:"uppercase",letterSpacing:.5},children:["Estimate"," Items"]}),e.jsx(f,{spacing:2,sx:{mb:3},children:t.items?.map((a,l)=>e.jsx(M,{item:a},l))}),e.jsxs(s,{sx:{p:2,borderRadius:2,bgcolor:"action.hover"},children:[e.jsx(o,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",textTransform:"uppercase",mb:1.5,display:"block",letterSpacing:1},children:"Pricing Details"}),e.jsxs(f,{spacing:1,children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(o,{variant:"body2",sx:{color:"text.secondary"},children:"Subtotal"}),e.jsxs(o,{variant:"body2",sx:{fontWeight:500},children:["₹",t.subtotal?.toFixed(2)]})]}),(t.tax??0)>0&&e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(o,{variant:"body2",sx:{color:"text.secondary"},children:"Tax"}),e.jsxs(o,{variant:"body2",sx:{fontWeight:500},children:["₹",t.tax?.toFixed(2)]})]}),(t.itemAddons??0)>0&&e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(o,{variant:"body2",sx:{color:"text.secondary"},children:"Item Add-ons"}),e.jsxs(o,{variant:"body2",sx:{fontWeight:500},children:["₹",t.itemAddons?.toFixed(2)]})]}),t.manualAddons?.map((a,l)=>e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(o,{variant:"body2",sx:{color:"text.secondary"},children:a.label}),e.jsxs(o,{variant:"body2",sx:{fontWeight:600,color:a.amount<0?"error.main":"text.primary"},children:[a.amount<0?"-":"+","₹",Math.abs(a.amount).toFixed(2)]})]},l)),(t.deliveryAmount??0)>0&&e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(o,{variant:"body2",sx:{color:"text.secondary"},children:"Delivery Charge"}),e.jsxs(o,{variant:"body2",sx:{fontWeight:500},children:["₹",t.deliveryAmount?.toFixed(2)]})]}),e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",mt:.5,pt:1,borderTop:"1px dashed",borderColor:"divider"},children:[e.jsx(o,{variant:"body2",sx:{fontWeight:"bold"},children:"Grand Total"}),e.jsxs(o,{variant:"body2",sx:{fontWeight:"bold"},children:["₹",t.total?.toLocaleString()]})]})]})]})]})]})]})},t.id)})}})}),e.jsx(s,{sx:{mt:4,textAlign:"center",animation:`${d} 0.6s ease-out forwards`,animationDelay:"0.3s"},children:e.jsx(y,{size:"small",endIcon:e.jsx(u,{}),sx:{color:"primary.main",fontWeight:"bold",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:1,"&:hover":{bgcolor:"transparent",color:"primary.dark"}},children:"Load More"})})]})]})}export{ae as component};

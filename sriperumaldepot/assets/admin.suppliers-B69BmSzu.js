import{f as ge,j as e,H as Me,G as ke,r as p,J as De,$ as ve,K as Le,c as He,a0 as J,L as ne,M as te,N as be,O as Oe,P as ye,a1 as $e,a2 as me,a3 as Be,B as b,I as Q,h as U,S as Z,E as We,k as Ge,a4 as Ue}from"./index-CVOYqxVk.js";import{u as _e}from"./supplierStore-B59sWNYl.js";import{Y as Xe}from"./index-DTSwwmmC.js";import{A as Ye,T as Qe,a as qe}from"./ArrowBackIosNew-BrM5wba8.js";import{C as Je,E as Ke}from"./Edit-DIyZpW0K.js";import{A as Ze}from"./AddCircle-D9NX91wj.js";import{G as ee}from"./Grid-By9dYrMs.js";import{u as eo,T as oe}from"./TextField-CK-tdFxC.js";import{R as oo}from"./RemoveCircleOutline-DWbOJM6Y.js";import{B as se}from"./Button-oePJF6-6.js";import{A as so}from"./Add-H9H12F4t.js";import{S as to}from"./Save-DYk4geYf.js";import{I as no}from"./InputAdornment-CZMMddfJ.js";import{S as ao}from"./Search-CBW0eGzz.js";import{C as he}from"./Chip-GzsU5rYQ.js";import{D as lo}from"./Delete-BlsjwF_6.js";import{D as io,a as ro,b as co,c as uo}from"./DialogTitle-oCC_8iLA.js";import{D as po}from"./DialogContentText-DEu2WO4n.js";import"./isMuiElement-DXYZu6PE.js";const mo={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},ho=ge(e.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})),fo=ge(e.jsx("path",{d:"M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"}));function xo(t){return ke("MuiRating",t)}const q=Me("MuiRating",["root","sizeSmall","sizeMedium","sizeLarge","readOnly","disabled","focusVisible","visuallyHidden","pristine","label","labelEmptyValueActive","icon","iconEmpty","iconFilled","iconHover","iconFocus","iconActive","decimal"]);function go(t){const s=t.toString().split(".")[1];return s?s.length:0}function re(t,s){if(t==null)return t;const l=Math.round(t/s)*s;return Number(l.toFixed(go(s)))}const vo=t=>{const{classes:s,size:l,readOnly:j,disabled:I,emptyValueFocused:S,focusVisible:C}=t,f={root:["root",`size${be(l)}`,I&&"disabled",C&&"focusVisible",j&&"readOnly"],label:["label","pristine"],labelEmptyValue:[S&&"labelEmptyValueActive"],icon:["icon"],iconEmpty:["iconEmpty"],iconFilled:["iconFilled"],iconHover:["iconHover"],iconFocus:["iconFocus"],iconActive:["iconActive"],decimal:["decimal"],visuallyHidden:["visuallyHidden"]};return Oe(f,xo,s)},bo=ne("span",{name:"MuiRating",slot:"Root",overridesResolver:(t,s)=>{const{ownerState:l}=t;return[{[`& .${q.visuallyHidden}`]:s.visuallyHidden},s.root,s[`size${be(l.size)}`],l.readOnly&&s.readOnly]}})(ye(({theme:t})=>({display:"inline-flex",position:"relative",fontSize:t.typography.pxToRem(24),color:"#faaf00",cursor:"pointer",textAlign:"left",width:"min-content",WebkitTapHighlightColor:"transparent",[`&.${q.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${q.focusVisible} .${q.iconActive}`]:{outline:"1px solid #999"},[`& .${q.visuallyHidden}`]:mo,variants:[{props:{size:"small"},style:{fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{fontSize:t.typography.pxToRem(30)}},{props:({ownerState:s})=>s.readOnly,style:{pointerEvents:"none"}}]}))),je=ne("label",{name:"MuiRating",slot:"Label",overridesResolver:({ownerState:t},s)=>[s.label,t.emptyValueFocused&&s.labelEmptyValueActive]})({cursor:"inherit",variants:[{props:({ownerState:t})=>t.emptyValueFocused,style:{top:0,bottom:0,position:"absolute",outline:"1px solid #999",width:"100%"}}]}),yo=ne("span",{name:"MuiRating",slot:"Icon",overridesResolver:(t,s)=>{const{ownerState:l}=t;return[s.icon,l.iconEmpty&&s.iconEmpty,l.iconFilled&&s.iconFilled,l.iconHover&&s.iconHover,l.iconFocus&&s.iconFocus,l.iconActive&&s.iconActive]}})(ye(({theme:t})=>({display:"flex",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest}),pointerEvents:"none",variants:[{props:({ownerState:s})=>s.iconActive,style:{transform:"scale(1.2)"}},{props:({ownerState:s})=>s.iconEmpty,style:{color:(t.vars||t).palette.action.disabled}}]}))),jo=ne("span",{name:"MuiRating",slot:"Decimal",shouldForwardProp:t=>$e(t)&&t!=="iconActive",overridesResolver:(t,s)=>{const{iconActive:l}=t;return[s.decimal,l&&s.iconActive]}})({position:"relative",variants:[{props:({iconActive:t})=>t,style:{transform:"scale(1.2)"}}]});function So(t){const{value:s,...l}=t;return e.jsx("span",{...l})}function fe(t){const{classes:s,disabled:l,emptyIcon:j,focus:I,getLabelText:S,highlightSelectedOnly:C,hover:f,icon:P,IconContainerComponent:L,isActive:x,itemValue:m,labelProps:E,name:w,onBlur:z,onChange:d,onClick:h,onFocus:y,readOnly:H,ownerState:V,ratingValue:u,ratingValueRounded:F,slots:_={},slotProps:X={}}=t,R=C?m===u:m<=u,M=m<=f,O=m<=I,o=m===F,n=`${w}-${ve()}`,i={slots:_,slotProps:X},[c,k]=J("icon",{elementType:yo,className:te(s.icon,R?s.iconFilled:s.iconEmpty,M&&s.iconHover,O&&s.iconFocus,x&&s.iconActive),externalForwardedProps:i,ownerState:{...V,iconEmpty:!R,iconFilled:R,iconHover:M,iconFocus:O,iconActive:x},additionalProps:{value:m},internalForwardedProps:{as:L}}),[g,$]=J("label",{elementType:je,externalForwardedProps:i,ownerState:{...V,emptyValueFocused:void 0},additionalProps:{style:E?.style,htmlFor:n}}),N=e.jsx(c,{...k,children:j&&!R?j:P});return H?e.jsx("span",{...E,children:N}):e.jsxs(p.Fragment,{children:[e.jsxs(g,{...$,children:[N,e.jsx("span",{className:s.visuallyHidden,children:S(m)})]}),e.jsx("input",{className:s.visuallyHidden,onFocus:y,onBlur:z,onChange:d,onClick:h,disabled:l,value:m,id:n,type:"radio",name:w,checked:o})]})}const Co=e.jsx(ho,{fontSize:"inherit"}),wo=e.jsx(fo,{fontSize:"inherit"});function Fo(t){return`${t||"0"} Star${t!==1?"s":""}`}const xe=p.forwardRef(function(s,l){const j=De({name:"MuiRating",props:s}),{component:I="span",className:S,defaultValue:C=null,disabled:f=!1,emptyIcon:P=wo,emptyLabelText:L="Empty",getLabelText:x=Fo,highlightSelectedOnly:m=!1,icon:E=Co,IconContainerComponent:w=So,max:z=5,name:d,onChange:h,onChangeActive:y,onMouseLeave:H,onMouseMove:V,precision:u=1,readOnly:F=!1,size:_="medium",value:X,slots:R={},slotProps:M={},...O}=j,o=ve(d),[n,i]=eo({controlled:X,default:C,name:"Rating"}),c=re(n,u),k=Le(),[{hover:g,focus:$},N]=p.useState({hover:-1,focus:-1});let B=c;g!==-1&&(B=g),$!==-1&&(B=$);const[Se,ae]=p.useState(!1),ce=p.useRef(),Ce=He(ce,l),we=a=>{V&&V(a);const r=ce.current,{right:v,left:K,width:W}=r.getBoundingClientRect();let G;k?G=(v-a.clientX)/W:G=(a.clientX-K)/W;let A=re(z*G+u/2,u);A=Be(A,u,z),N(D=>D.hover===A&&D.focus===A?D:{hover:A,focus:A}),ae(!1),y&&g!==A&&y(a,A)},Fe=a=>{H&&H(a);const r=-1;N({hover:r,focus:r}),y&&g!==r&&y(a,r)},de=a=>{let r=a.target.value===""?null:parseFloat(a.target.value);g!==-1&&(r=g),i(r),h&&h(a,r)},Re=a=>{a.clientX===0&&a.clientY===0||(N({hover:-1,focus:-1}),i(null),h&&parseFloat(a.target.value)===c&&h(a,null))},Ae=a=>{me(a.target)&&ae(!0);const r=parseFloat(a.target.value);N(v=>({hover:v.hover,focus:r}))},Ie=a=>{if(g!==-1)return;me(a.target)||ae(!1);const r=-1;N(v=>({hover:v.hover,focus:r}))},[Pe,ue]=p.useState(!1),Y={...j,component:I,defaultValue:C,disabled:f,emptyIcon:P,emptyLabelText:L,emptyValueFocused:Pe,focusVisible:Se,getLabelText:x,icon:E,IconContainerComponent:w,max:z,precision:u,readOnly:F,size:_},T=vo(Y),le={slots:R,slotProps:M},[Ee,ze]=J("root",{ref:Ce,className:te(T.root,S),elementType:bo,externalForwardedProps:{...le,...O,component:I},getSlotProps:a=>({...a,onMouseMove:r=>{we(r),a.onMouseMove?.(r)},onMouseLeave:r=>{Fe(r),a.onMouseLeave?.(r)}}),ownerState:Y,additionalProps:{role:F?"img":null,"aria-label":F?x(B):null}}),[Ne,Te]=J("label",{className:te(T.label,T.labelEmptyValue),elementType:je,externalForwardedProps:le,ownerState:Y}),[Ve,pe]=J("decimal",{className:T.decimal,elementType:jo,externalForwardedProps:le,ownerState:Y});return e.jsxs(Ee,{...ze,children:[Array.from(new Array(z)).map((a,r)=>{const v=r+1,K={classes:T,disabled:f,emptyIcon:P,focus:$,getLabelText:x,highlightSelectedOnly:m,hover:g,icon:E,IconContainerComponent:w,name:o,onBlur:Ie,onChange:de,onClick:Re,onFocus:Ae,ratingValue:B,ratingValueRounded:c,readOnly:F,ownerState:Y,slots:R,slotProps:M},W=v===Math.ceil(B)&&(g!==-1||$!==-1);if(u<1){const G=Array.from(new Array(1/u));return p.createElement(Ve,{...pe,key:v,className:te(pe.className,W&&T.iconActive),iconActive:W},G.map((A,D)=>{const ie=re(v-1+(D+1)*u,u);return e.jsx(fe,{...K,isActive:!1,itemValue:ie,labelProps:{style:G.length-1===D?{}:{width:ie===B?`${(D+1)*u*100}%`:"0%",overflow:"hidden",position:"absolute"}}},ie)}))}return e.jsx(fe,{...K,isActive:W,itemValue:v},v)}),!F&&!f&&e.jsxs(Ne,{...Te,children:[e.jsx("input",{className:T.visuallyHidden,value:"",id:`${o}-empty`,type:"radio",name:o,checked:c==null,onFocus:()=>ue(!0),onBlur:()=>ue(!1),onChange:de}),e.jsx("span",{className:T.visuallyHidden,children:L})]})]})});function Uo(){const{suppliers:t,fetchSuppliers:s,addSupplier:l,updateSupplier:j,deleteSupplier:I}=_e();p.useEffect(()=>{s()},[]);const[S,C]=p.useState(null),[f,P]=p.useState(!1),[L,x]=p.useState(!1),[m,E]=p.useState(null),[w,z]=p.useState(""),[d,h]=p.useState({id:"",name:"",contactPerson:"",phoneNumbers:[""],emails:[""],addresses:[""],gstins:[""],rating:0}),y=(o,n)=>{h(i=>({...i,[o]:n}))},H=(o,n,i)=>{const c=[...d[o]];c[n]=i,h(k=>({...k,[o]:c}))},V=o=>{h(n=>({...n,[o]:[...n[o],""]}))},u=(o,n)=>{h(i=>({...i,[o]:i[o].filter((c,k)=>k!==n)}))},F=async()=>{const o={...d,phoneNumbers:d.phoneNumbers.filter(n=>n.trim()!==""),emails:d.emails.filter(n=>n.trim()!==""),addresses:d.addresses.filter(n=>n.trim()!==""),gstins:d.gstins.filter(n=>n.trim()!=="")};if(!o.name){alert("Supplier Name is required");return}try{S?await j(o):await l(o),M()}catch(n){console.error("Error saving supplier:",n),alert("Failed to save supplier")}},_=o=>{h({...o,phoneNumbers:o.phoneNumbers.length?o.phoneNumbers:[""],emails:o.emails.length?o.emails:[""],addresses:o.addresses.length?o.addresses:[""],gstins:o.gstins.length?o.gstins:[""]}),C(o.id),P(!0),window.scrollTo({top:0,behavior:"smooth"})},X=o=>{E(o),x(!0)},R=async()=>{m&&(await I(m),x(!1),E(null))},M=()=>{h({id:"",name:"",contactPerson:"",phoneNumbers:[""],emails:[""],addresses:[""],gstins:[""],rating:0}),C(null),P(!1),window.scrollTo({top:0,behavior:"smooth"})},O=t.filter(o=>o.name.toLowerCase().includes(w.toLowerCase())||o.contactPerson.toLowerCase().includes(w.toLowerCase()));return e.jsxs(b,{sx:{minHeight:"100vh",bgcolor:"background.default",pb:10},children:[e.jsx(Ye,{position:"sticky",color:"default",elevation:0,sx:{bgcolor:"background.paper",borderBottom:1,borderColor:"divider"},children:e.jsxs(Qe,{children:[e.jsx(Q,{onClick:()=>window.history.back(),edge:"start",children:e.jsx(qe,{})}),e.jsx(U,{variant:"h6",component:"h1",sx:{flexGrow:1,textAlign:"center",pr:5,fontWeight:"bold"},children:"Manage Suppliers"})]})}),e.jsxs(Je,{maxWidth:"md",sx:{py:3,display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(b,{sx:{border:1,borderColor:"divider",borderRadius:3,overflow:"hidden",bgcolor:"background.paper"},children:[e.jsxs(b,{onClick:()=>P(!f),sx:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",p:2,bgcolor:"action.hover",transition:"background-color 0.2s","&:hover":{bgcolor:"action.selected"}},children:[e.jsxs(Z,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(Ze,{color:"primary"}),e.jsx(U,{variant:"subtitle1",sx:{fontWeight:"bold"},children:S?"Edit Supplier":"Add New Supplier"})]}),e.jsx(Q,{size:"small",sx:{transform:f?"rotate(180deg)":"none",transition:"transform 0.3s"},children:e.jsx(We,{})})]}),e.jsx(Ge,{in:f,children:e.jsxs(b,{sx:{p:3,display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(ee,{container:!0,spacing:2,children:[e.jsx(ee,{size:{xs:12,sm:6},children:e.jsx(oe,{fullWidth:!0,label:"Supplier Name",value:d.name,onChange:o=>y("name",o.target.value)})}),e.jsx(ee,{size:{xs:12,sm:6},children:e.jsx(oe,{fullWidth:!0,label:"Contact Person",value:d.contactPerson,onChange:o=>y("contactPerson",o.target.value)})}),e.jsx(ee,{size:12,children:e.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(U,{component:"legend",children:"Rating"}),e.jsx(xe,{value:d.rating,onChange:(o,n)=>y("rating",n)})]})})]}),[{label:"Phone Numbers",field:"phoneNumbers",placeholder:"+91..."},{label:"Emails",field:"emails",placeholder:"name@example.com"},{label:"Addresses",field:"addresses",placeholder:"Full address..."},{label:"GSTINs",field:"gstins",placeholder:"GSTIN Number..."}].map(o=>e.jsxs(b,{children:[e.jsx(U,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:o.label}),e.jsxs(Z,{spacing:1,children:[d[o.field].map((n,i)=>e.jsxs(Z,{direction:"row",spacing:1,children:[e.jsx(oe,{fullWidth:!0,size:"small",placeholder:o.placeholder,value:n,onChange:c=>H(o.field,i,c.target.value)}),e.jsx(Q,{color:"error",onClick:()=>u(o.field,i),disabled:d[o.field].length===1&&n==="",children:e.jsx(oo,{})})]},i)),e.jsxs(se,{startIcon:e.jsx(so,{}),size:"small",onClick:()=>V(o.field),sx:{alignSelf:"flex-start"},children:["Add ",o.label.slice(0,-1)]})]})]},o.field)),e.jsx(se,{fullWidth:!0,variant:"contained",size:"large",startIcon:e.jsx(to,{}),onClick:F,sx:{borderRadius:2,height:48},children:S?"Update Supplier":"Save Supplier"})]})})]}),e.jsxs(b,{children:[e.jsx(oe,{size:"small",fullWidth:!0,placeholder:"Search suppliers...",value:w,onChange:o=>z(o.target.value),InputProps:{startAdornment:e.jsx(no,{position:"start",children:e.jsx(ao,{sx:{opacity:.5}})}),sx:{borderRadius:2,bgcolor:"background.paper",mb:2}}}),e.jsx(Xe,{useWindowScroll:!0,data:O,itemContent:(o,n)=>e.jsx(Ue,{sx:{p:2,mb:2,borderRadius:2},variant:"outlined",children:e.jsxs(b,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(b,{children:[e.jsx(U,{variant:"h6",fontWeight:"bold",children:n.name}),e.jsxs(U,{variant:"body2",color:"text.secondary",children:["Contact: ",n.contactPerson]}),e.jsxs(b,{sx:{display:"flex",gap:1,mt:1,flexWrap:"wrap"},children:[n.phoneNumbers.map((i,c)=>i&&e.jsx(he,{label:i,size:"small"},c)),n.gstins.map((i,c)=>i&&e.jsx(he,{label:`GST: ${i}`,size:"small",color:"info",variant:"outlined"},c))]})]}),e.jsxs(b,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:1},children:[e.jsx(xe,{value:n.rating,readOnly:!0,size:"small"}),e.jsxs(Z,{direction:"row",children:[e.jsx(Q,{size:"small",onClick:()=>_(n),children:e.jsx(Ke,{})}),e.jsx(Q,{size:"small",color:"error",onClick:()=>X(n.id),children:e.jsx(lo,{})})]})]})]})})})]})]}),e.jsxs(io,{open:L,onClose:()=>x(!1),children:[e.jsx(ro,{children:"Delete Supplier?"}),e.jsx(co,{children:e.jsx(po,{children:"This action cannot be undone."})}),e.jsxs(uo,{children:[e.jsx(se,{onClick:()=>x(!1),children:"Cancel"}),e.jsx(se,{onClick:R,color:"error",variant:"contained",children:"Delete"})]})]})]})}export{Uo as component};

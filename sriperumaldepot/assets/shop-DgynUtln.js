import{r as p,b as ve,T as Ce,c as Se,g as we,j as e,d as te,e as ke,f as N,a as ae,I as Y,B as n,R as H,A as Ie,h,C as le,i as ce,k as ze,l as de}from"./index-DHY1Ru8d.js";import{A as xe,T as he,a as We}from"./ArrowBackIosNew-Cp76FO56.js";import{C as Re}from"./CheckCircle-DM50iUtf.js";import{S as Te}from"./Straighten-C2su1i1z.js";import{L as Ee}from"./LocalShipping-DMwRZZut.js";import{u as $}from"./productStore-Cq9W54EL.js";import{u as _}from"./cartStore-DEknEMG5.js";import{u as me}from"./pricingStore-lujHIBku.js";import{u as pe}from"./supplierStore-BxJZkzDL.js";import{Q as Ae,p as Pe}from"./profile-B4btojmQ.js";import{A as Fe}from"./Add-Bsie2-Y-.js";import{S as Oe}from"./Search-CUtR-E3e.js";import{S as fe}from"./ShoppingCart-CYGP5sj6.js";import{F as Le}from"./FitnessCenter-9aZ1ZLHN.js";import{B as Me,E as De}from"./EnergySavingsLeaf-BfXiamww.js";import{C as Ve}from"./Close-DJmNvbFf.js";import{F as Be}from"./FlashOn-DJgjoZkv.js";import{D as ue}from"./DialogTitle-8O5OVP0U.js";import{A as re}from"./Alert-BkQlJP9t.js";import{B as U}from"./Button-I2KpT16O.js";import{d as Ne,o as ge,I as G,F as $e,S as He}from"./TextField-guTU_i3M.js";import{Q as Ue}from"./QuantitySelector-B86LQTGX.js";import{O as Ye}from"./OfflineDialog-CoxoVtUY.js";import{Q as oe,Y as _e}from"./index-Dlhn0XRi.js";import{H as Qe}from"./Header--SsLVr8l.js";import{P as Xe}from"./Page-D11jEEtq.js";import{C as Z}from"./Chip-BDCp8Dav.js";import{D as q}from"./Divider-CY8HECq5.js";import{G as ee}from"./Grid-CW8kZ2Pf.js";import{M as Ge}from"./MenuItem-BGzshJjr.js";import"./isMuiElement-cndmTMkq.js";import"./DialogContentText-XWRJod8d.js";import"./dividerClasses-COgMgFGY.js";function Ze(o,d,t){const i=d.getBoundingClientRect(),x=t&&t.getBoundingClientRect(),C=ge(d);let u;if(d.fakeTransform)u=d.fakeTransform;else{const m=C.getComputedStyle(d);u=m.getPropertyValue("-webkit-transform")||m.getPropertyValue("transform")}let z=0,I=0;if(u&&u!=="none"&&typeof u=="string"){const m=u.split("(")[1].split(")")[0].split(",");z=parseInt(m[4],10),I=parseInt(m[5],10)}return o==="left"?x?`translateX(${x.right+z-i.left}px)`:`translateX(${C.innerWidth+z-i.left}px)`:o==="right"?x?`translateX(-${i.right-x.left-z}px)`:`translateX(-${i.left+i.width-z}px)`:o==="up"?x?`translateY(${x.bottom+I-i.top}px)`:`translateY(${C.innerHeight+I-i.top}px)`:x?`translateY(-${i.top-x.top+i.height-I}px)`:`translateY(-${i.top+i.height-I}px)`}function qe(o){return typeof o=="function"?o():o}function X(o,d,t){const i=qe(t),x=Ze(o,d,i);x&&(d.style.webkitTransform=x,d.style.transform=x)}const be=p.forwardRef(function(d,t){const i=ve(),x={enter:i.transitions.easing.easeOut,exit:i.transitions.easing.sharp},C={enter:i.transitions.duration.enteringScreen,exit:i.transitions.duration.leavingScreen},{addEndListener:u,appear:z=!0,children:I,container:m,direction:W="down",easing:F=x,in:T,onEnter:M,onEntered:S,onEntering:D,onExit:B,onExited:R,onExiting:P,style:L,timeout:w=C,TransitionComponent:O=Ce,...k}=d,g=p.useRef(null),y=Se(we(I),g,t),E=a=>v=>{a&&(v===void 0?a(g.current):a(g.current,v))},b=E((a,v)=>{X(W,a,m),ke(a),M&&M(a,v)}),s=E((a,v)=>{const V=te({timeout:w,style:L,easing:F},{mode:"enter"});a.style.webkitTransition=i.transitions.create("-webkit-transform",{...V}),a.style.transition=i.transitions.create("transform",{...V}),a.style.webkitTransform="none",a.style.transform="none",D&&D(a,v)}),r=E(S),c=E(P),l=E(a=>{const v=te({timeout:w,style:L,easing:F},{mode:"exit"});a.style.webkitTransition=i.transitions.create("-webkit-transform",v),a.style.transition=i.transitions.create("transform",v),X(W,a,m),B&&B(a)}),f=E(a=>{a.style.webkitTransition="",a.style.transition="",R&&R(a)}),A=a=>{u&&u(g.current,a)},j=p.useCallback(()=>{g.current&&X(W,g.current,m)},[W,m]);return p.useEffect(()=>{if(T||W==="down"||W==="right")return;const a=Ne(()=>{g.current&&X(W,g.current,m)}),v=ge(g.current);return v.addEventListener("resize",a),()=>{a.clear(),v.removeEventListener("resize",a)}},[W,T,m]),p.useEffect(()=>{T||j()},[T,j]),e.jsx(O,{nodeRef:g,onEnter:b,onEntered:r,onEntering:s,onExit:l,onExited:f,onExiting:c,addEndListener:A,appear:z,in:T,timeout:w,...k,children:(a,{ownerState:v,...V})=>p.cloneElement(I,{ref:y,style:{visibility:a==="exited"&&!T?"hidden":void 0,...L,...I.props.style},...V})})}),Ke=N(e.jsx("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"})),Je=N(e.jsx("path",{d:"M21.6 18.2 13 11.75v-.91c1.65-.49 2.8-2.17 2.43-4.05-.26-1.31-1.3-2.4-2.61-2.7C10.54 3.57 8.5 5.3 8.5 7.5h2c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5c0 .84-.69 1.52-1.53 1.5-.54-.01-.97.45-.97.99v1.76L2.4 18.2c-.77.58-.36 1.8.6 1.8h18c.96 0 1.37-1.22.6-1.8M6 18l6-4.5 6 4.5z"})),et=N(e.jsx("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54z"})),tt=N(e.jsx("path",{d:"M3.27 3 2 4.27l5 5V13h3v9l3.58-6.14L17.73 20 19 18.73zM17 10h-4l4-8H7v2.18l8.46 8.46z"})),se=N(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"})),rt=N(e.jsx("path",{d:"M3 6c-.55 0-1 .45-1 1v13c0 1.1.9 2 2 2h13c.55 0 1-.45 1-1s-.45-1-1-1H5c-.55 0-1-.45-1-1V7c0-.55-.45-1-1-1m17-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-2 9h-8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1m-4 4h-4c-.55 0-1-.45-1-1s.45-1 1-1h4c.55 0 1 .45 1 1s-.45 1-1 1m4-8h-8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1"})),ot=N(e.jsx("path",{d:"m3 2 2.01 18.23C5.13 21.23 5.97 22 7 22h10c1.03 0 1.87-.77 1.99-1.77L21 2zm9 17c-1.66 0-3-1.34-3-3 0-2 3-5.4 3-5.4s3 3.4 3 5.4c0 1.66-1.34 3-3 3m6.33-11H5.67l-.44-4h13.53z"})),st=N(e.jsx("path",{d:"M3 17v2h6v-2zM3 5v2h10V5zm10 16v-2h8v-2h-8v-2h-2v6zM7 9v2H3v2h4v2h2V9zm14 4v-2H11v2zm-6-4h2V7h4V5h-4V3h-2z"})),nt=N(e.jsx("path",{d:"M12 2c-5.33 4.55-8 8.48-8 11.8 0 4.98 3.8 8.2 8 8.2s8-3.22 8-8.2c0-3.32-2.67-7.25-8-11.8M7.83 14c.37 0 .67.26.74.62.41 2.22 2.28 2.98 3.64 2.87.43-.02.79.32.79.75 0 .4-.32.73-.72.75-2.13.13-4.62-1.09-5.19-4.12-.08-.45.28-.87.74-.87"})),ye=()=>{const d=_(i=>i.items).length,t=ae();return e.jsxs(Y,{sx:{bgcolor:"action.hover"},onClick:()=>t({to:"/checkout"}),children:[e.jsx(fe,{}),d>0&&e.jsx(n,{sx:{position:"absolute",top:0,right:0,width:16,height:16,bgcolor:"red",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.65rem",color:"white",fontWeight:"bold",border:"2px solid",borderColor:"background.paper"},children:d})]})},it=H.forwardRef(function(d,t){return e.jsx(be,{direction:"up",ref:t,...d})}),at=({open:o,onClose:d,onScanSuccess:t})=>{const i=p.useRef(null),[x,C]=p.useState(null),[u,z]=p.useState(!0),[I,m]=p.useState(!1),[W,F]=p.useState(!0),[T,M]=p.useState(!1),[S,D]=p.useState(null),[B,R]=p.useState(1),[P,L]=p.useState(1),[w,O]=p.useState(!1),k=p.useCallback(()=>{M(!1),S&&S.stop(),i.current&&i.current.srcObject&&(i.current.srcObject.getTracks().forEach(s=>s.stop()),i.current.srcObject=null)},[S]),g=p.useCallback(async()=>{if(F(!0),C(null),!("BarcodeDetector"in window)){z(!1),F(!1);return}try{const b=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{min:1280,ideal:3840,max:4096},height:{min:720,ideal:2160,max:2160},frameRate:{ideal:30,max:60}}});if(i.current){i.current.srcObject=b;const s=b.getVideoTracks()[0];D(s),await i.current.play();try{const r=s.getCapabilities(),c={advanced:[]};r.zoom&&(O(!0),L(r.zoom.max),R(r.zoom.min||1)),r.focusMode?.includes("continuous")&&c.advanced.push({focusMode:"continuous"}),r.whiteBalanceMode?.includes("continuous")&&c.advanced.push({whiteBalanceMode:"continuous"}),r.exposureMode?.includes("continuous")&&c.advanced.push({exposureMode:"continuous"}),c.advanced.length>0&&await s.applyConstraints(c)}catch(r){console.warn("Advanced constraints not supported:",r)}F(!1),M(!0)}}catch(b){console.error("Error accessing camera:",b),C(b.name==="NotAllowedError"?"Camera permission denied":"Could not access camera"),F(!1)}},[]);p.useEffect(()=>{o?g():k()},[o,g,k]),p.useEffect(()=>{let b,s=0;const r=300,c="BarcodeDetector"in window?new window.BarcodeDetector({formats:["qr_code","ean_13","ean_8","code_128","code_39","upc_a","upc_e"]}):null,l=async f=>{if(!(!T||!i.current||!c)){if(f-s>r){s=f;try{if(i.current.readyState===i.current.HAVE_ENOUGH_DATA){const A=await c.detect(i.current);if(A.length>0){const j=A[0].rawValue;t(j),k();return}}}catch(A){console.error("Detection error:",A)}}b=requestAnimationFrame(l)}};return T&&(b=requestAnimationFrame(l)),()=>{b&&cancelAnimationFrame(b)}},[T,t,k]);const y=async()=>{if(S&&"applyConstraints"in S)try{await S.applyConstraints({advanced:[{torch:!I}]}),m(!I)}catch(b){console.error("Error toggling torch:",b)}},E=async b=>{if(S&&"applyConstraints"in S)try{await S.applyConstraints({advanced:[{zoom:b}]}),R(b)}catch(s){console.error("Error adjusting zoom:",s)}};return e.jsxs(ue,{fullScreen:!0,open:o,onClose:d,TransitionComponent:it,PaperProps:{sx:{bgcolor:"#000",color:"white",overflow:"hidden"}},children:[e.jsx(xe,{sx:{position:"relative",bgcolor:"transparent",boxShadow:"none"},children:e.jsxs(he,{children:[e.jsx(Y,{edge:"start",color:"inherit",onClick:d,"aria-label":"close",children:e.jsx(Ie,{})}),e.jsx(h,{sx:{ml:2,flex:1,fontWeight:700},variant:"h6",children:"Scan Barcode"}),S&&e.jsx(Y,{color:"inherit",onClick:y,children:I?e.jsx(Be,{sx:{color:"primary.main"}}):e.jsx(tt,{})})]})}),e.jsxs(n,{sx:{flex:1,position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",bgcolor:"#000"},children:[W&&e.jsx(n,{sx:{position:"absolute",zIndex:2,display:"flex",flexDirection:"column",alignItems:"center"},children:e.jsx(le,{color:"primary"})}),x&&e.jsxs(n,{sx:{p:4,textAlign:"center",zIndex:2},children:[e.jsx(re,{severity:"error",sx:{mb:2},children:x}),e.jsx(U,{variant:"contained",onClick:g,children:"Retry"})]}),!u&&e.jsxs(n,{sx:{p:4,textAlign:"center",zIndex:2},children:[e.jsx(re,{severity:"warning",sx:{mb:2},children:"Native barcode scanning is not supported in this browser. Please use Chrome or Edge."}),e.jsx(U,{variant:"outlined",color:"inherit",onClick:d,children:"Close"})]}),e.jsxs(n,{sx:{position:"relative",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx("video",{ref:i,style:{width:"100%",height:"100%",objectFit:"cover"},playsInline:!0,muted:!0}),e.jsx(n,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:e.jsx(n,{sx:{width:"280px",height:"280px",border:"2px solid rgba(255, 255, 255, 0.5)",borderRadius:"24px",position:"relative","&::before, &::after":{content:'""',position:"absolute",width:"40px",height:"40px",borderColor:"primary.main",borderStyle:"solid"},"&::before":{top:-2,left:-2,borderTopWidth:4,borderLeftWidth:4,borderBottomWidth:0,borderRightWidth:0,borderTopLeftRadius:"24px"},"&::after":{bottom:-2,right:-2,borderBottomWidth:4,borderRightWidth:4,borderTopWidth:0,borderLeftWidth:0,borderBottomRightRadius:"24px"}},children:e.jsx(n,{sx:{position:"absolute",top:0,left:"10%",width:"80%",height:"2px",bgcolor:"primary.main",boxShadow:"0 0 15px #2196f3",willChange:"transform",animation:"scan 2.5s ease-in-out infinite","@keyframes scan":{"0%":{transform:"translateY(28px)",opacity:0},"50%":{transform:"translateY(140px)",opacity:1},"100%":{transform:"translateY(252px)",opacity:0}}}})})}),e.jsxs(n,{sx:{position:"absolute",bottom:40,display:"flex",gap:2,zIndex:3},children:[w&&e.jsx(U,{variant:"contained",sx:{borderRadius:"20px",bgcolor:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)","&:hover":{bgcolor:"rgba(255,255,255,0.3)"}},onClick:()=>E(B===1?Math.min(2,P):1),children:B===1?"2x Zoom":"1x Zoom"}),e.jsx(U,{variant:"contained",sx:{borderRadius:"20px",bgcolor:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)","&:hover":{bgcolor:"rgba(255,255,255,0.3)"}},onClick:y,children:I?"Flash Off":"Flash On"})]})]})]})]})},lt=(o,d)=>{if(o===void 0||d===void 0)return"";const t=Math.floor(o-d),i=Math.floor(Math.random()*9+1),x=`${i}${i}1`,C=Math.floor(Math.random()*90+10);return`${x}${t}${C}`},ct={shopping_cart:e.jsx(fe,{}),search:e.jsx(Oe,{}),tune:e.jsx(st,{}),favorite:e.jsx(et,{}),nutrition:e.jsx(De,{}),bolt:e.jsx(Me,{}),checkroom:e.jsx(Je,{}),water_drop:e.jsx(nt,{}),local_drink:e.jsx(ot,{}),fitness_center:e.jsx(Le,{})},dt=H.forwardRef(function(d,t){return e.jsx(be,{direction:"up",ref:t,...d})}),K=({name:o,filled:d=!1,className:t=""})=>e.jsx(e.Fragment,{children:ct[o]}),ne=H.forwardRef(({style:o,children:d,...t},i)=>e.jsx(ee,{container:!0,spacing:2,...t,ref:i,style:{...o,display:"flex",flexWrap:"wrap",width:"100%",margin:0},children:d})),xt=({children:o,...d})=>e.jsx(ee,{item:!0,size:{xs:6,sm:6,md:3,lg:2,xl:2},...d,sx:{display:"flex",flexDirection:"column",p:1},children:o}),ht=({children:o,...d})=>e.jsx(ee,{item:!0,size:{xs:6,sm:6,md:6,lg:4,xl:4},...d,sx:{display:"flex",flexDirection:"column",p:1},children:o});function Xt(){const o=$(s=>s.activeCategory),d=$(s=>s.setActiveCategory),t=$(s=>s.categories),i=$(s=>s.categoryItems),x=$(s=>s.products),C=$(s=>s.fetchProducts),u=me(s=>s.fetchRules),z=pe(s=>s.fetchSuppliers),I=$(s=>s.isLoading),m=ae(),[W,F]=p.useState(!1);p.useEffect(()=>{navigator.onLine||F(!0)},[]),p.useEffect(()=>{C(),u(),z()},[C]);const[T,M]=p.useState(null),[S,D]=p.useState(""),[B,R]=p.useState(!1),[P,L]=p.useState(!1),[w,O]=p.useState(""),k=(s,r,c=!0)=>{if(!r)return 0;const l=s.toLowerCase(),f=r.toLowerCase();if(l===f)return 100;if(l.startsWith(f))return 80;if(l.includes(f))return 60;if(!c)return 0;let A=0;const j=f.split("");let a=-1;for(const V of j){const Q=l.indexOf(V,a+1);Q>-1&&(A++,a=Q)}const v=A/f.length*40;return v>20?v:0},g=S?x.filter(s=>{if(o!=="All Items")if(o==="Un-grouped"){const r=t.filter(l=>l!=="All Items");if(!(!s.categoryOnly&&!s.categoryId&&(!s.category||!r.includes(s.category))))return!1}else{const r=i.find(c=>c.name===o);if(r){if(s.categoryId!==r.id)return!1}else return!1}return w?s.category.toLowerCase().includes(w.toLowerCase()):!0}).map(s=>{const r=S.trim().toLowerCase().split(/\s+/),c=s.categoryId?i.find(f=>f.id===s.categoryId):void 0;let l=0;for(const f of r){const A=k(s.name,f,!1)*10,j=s.sku?k(s.sku,f,!0)*8:0,a=c?.sku?k(c.sku,f,!0)*5:0,v=k(s.detail,f,!0),V=k(s.category,f,!1),Q=s.id?k(String(s.id),f,!0):0,je=Math.max(A,j,a,v,V,Q);l+=je}return{...s,searchScore:l}}).filter(s=>s.searchScore>0).sort((s,r)=>(r.searchScore||0)-(s.searchScore||0)):x,y=s=>{d(s),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},400)},E=s=>{M(s),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},400)},b=()=>{M(null),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},400)};return e.jsxs(n,{sx:{pb:10,bgcolor:"background.default",minHeight:"100vh",color:"text.primary"},children:[e.jsxs(n,{sx:{position:"sticky",top:0,zIndex:1100,bgcolor:"background.default",borderBottom:1,borderColor:"divider"},children:[e.jsx(Qe,{title:"Shop Online",icon:e.jsxs(n,{sx:{position:"relative"},children:[e.jsx(ce,{src:Pe,sx:{width:40,height:40,border:"2px solid",borderColor:"primary.main"},onClick:()=>m({to:"/admin"})}),e.jsx(n,{sx:{position:"absolute",bottom:0,right:0,width:12,height:12,bgcolor:"primary.main",borderRadius:"50%",border:"2px solid",borderColor:"background.paper"}})]}),rightContent:e.jsxs(e.Fragment,{children:[e.jsx(Ae,{sx:{cursor:"pointer",pr:2,color:"text.secondary"},onClick:()=>R(!0)}),e.jsx(rt,{sx:{cursor:"pointer",pr:2,color:"text.secondary"},onClick:()=>m({to:"/history"})}),e.jsx(ye,{})]})}),e.jsxs(n,{sx:{px:2,pt:0,pb:1.5},children:[e.jsxs(n,{sx:{position:"relative"},children:[e.jsx(n,{sx:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",display:"flex",zIndex:100},children:e.jsx(K,{name:"search"})}),e.jsx(G,{placeholder:"Search supplements, gear...",value:S,onChange:s=>D(s.target.value),onKeyDown:s=>{s.key==="Escape"&&(D(""),s.target.blur())},sx:{width:"100%",bgcolor:"background.paper",borderRadius:4,py:1.5,pl:6,pr:6,border:1,borderColor:"divider","&.Mui-focused":{borderColor:"primary.main",boxShadow:"0 0 0 2px rgba(242, 215, 13, 0.2)"}}}),e.jsx(Y,{onClick:()=>{P&&(O(""),y("All Items")),L(!P)},sx:{position:"absolute",right:8,top:"50%",transform:"translateY(-50%)",bgcolor:P||w?"primary.main":"action.hover",color:P||w?"common.black":"inherit",p:.5,borderRadius:2,"&:hover":{bgcolor:P||w?"primary.dark":"action.selected"}},children:e.jsx(K,{name:"tune"})})]}),e.jsx(ze,{in:P,children:e.jsxs(n,{sx:{pt:1,position:"relative"},children:[e.jsx(G,{placeholder:"Filter categories...",value:w,onChange:s=>{O(s.target.value),s.target.value&&y("All Items")},sx:{width:"100%",bgcolor:"background.paper",borderRadius:3,py:1,pl:2,pr:5,border:1,borderColor:"divider",fontSize:"0.9rem"}}),w&&e.jsx(Y,{size:"small",onClick:()=>{O(""),y("All Items")},sx:{position:"absolute",right:8,top:"50%",transform:"translateY(-30%)",color:"text.secondary"},children:e.jsx(Ve,{fontSize:"small"})})]})})]})]}),e.jsx(Xe,{children:I?e.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center",py:8},children:e.jsx(le,{})}):e.jsxs(e.Fragment,{children:[!S&&e.jsx(n,{sx:{display:"flex",gap:1.5,overflowX:"auto",pb:2,"&::-webkit-scrollbar":{display:"none"}},children:(()=>{const s=t.filter(l=>l!=="All Items");return(x.some(l=>!l.categoryOnly&&(!l.category||!s.includes(l.category)))?[...t,"Un-grouped"]:t).map(l=>e.jsx(Z,{label:l,onClick:()=>y(l),sx:{fontWeight:"bold",borderRadius:50,height:40,px:1,bgcolor:"background.paper",color:o===l?"primary.main":"text.secondary",border:1,borderColor:o===l?"primary.main":"divider","&:hover":{bgcolor:o===l?"primary.dark":"action.hover"}}},l))})()}),e.jsx(n,{sx:{px:0,pb:10},children:S?e.jsxs(n,{children:[e.jsxs(h,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:["Search Results (",g.length,")"]}),g.length>0?e.jsx(n,{sx:{width:"100%"},children:e.jsx(oe,{useWindowScroll:!0,increaseViewportBy:300,data:g,totalCount:g.length,components:{List:ne,Item:xt},itemContent:(s,r)=>e.jsx(J,{product:r,onClick:()=>E(r),setActiveCategory:y})})}):e.jsx(n,{sx:{textAlign:"center",py:8,opacity:.6},children:e.jsxs(h,{variant:"body1",children:['No products found matching "',S,'"']})})]}):e.jsx(e.Fragment,{children:o==="All Items"?e.jsx(n,{sx:{width:"100%"},children:(()=>{const s=j=>j.categoryId&&i.some(a=>a.id===j.categoryId),r=x.filter(j=>!j.categoryOnly&&!s(j)),c=i.filter(j=>!w||j.name.toLowerCase().includes(w.toLowerCase())),l=[],f=[];c.forEach(j=>{const a=x.filter(v=>v.categoryId===j.id).length;a>0?l.push({type:"category",category:j,count:a}):f.push({type:"category-empty",category:j})}),l.sort((j,a)=>j.category.name.localeCompare(a.category.name)),f.sort((j,a)=>j.category.name.localeCompare(a.category.name));const A=[...l];return r.length>0&&(!w||"un-grouped".includes(w.toLowerCase()))&&A.push({type:"un-grouped",count:r.length}),f.length>0&&(A.push({type:"header",label:"Empty Categories"}),A.push(...f)),e.jsx(_e,{useWindowScroll:!0,increaseViewportBy:300,data:A,itemContent:(j,a)=>{if(a.type==="category"||a.type==="category-empty"){const v=a.category,V=a.count!==void 0?a.count:0;return e.jsx(n,{sx:{mb:4},children:e.jsx(ie,{title:v.name,count:V,products:[v],onProductClick:()=>y(v.name),onViewAll:()=>y(v.name),setActiveCategory:y})})}else{if(a.type==="un-grouped")return e.jsx(n,{sx:{mb:4},children:e.jsx(ie,{title:"Un-grouped",count:a.count,products:[{id:"ungrouped-dummy",name:"Un-grouped Items",detail:"Items not yet categorized",icon:"shopping_cart",sale:!1,isNew:!1,category:"Un-grouped",imageColor:"#f5f5f5",categoryOnly:!0}],onProductClick:()=>y("Un-grouped"),onViewAll:()=>y("Un-grouped"),setActiveCategory:y})});if(a.type==="header")return e.jsxs(n,{sx:{display:"flex",alignItems:"center",my:3},children:[e.jsx(q,{sx:{flex:1}}),e.jsx(h,{variant:"caption",sx:{px:2,fontWeight:"bold",color:"text.secondary",textTransform:"uppercase"},children:a.label}),e.jsx(q,{sx:{flex:1}})]})}return null}})})()}):e.jsx(n,{sx:{width:"100%",px:0},children:(()=>{const s=t.filter(c=>c!=="All Items");let r=x;if(o==="Un-grouped")r=x.filter(c=>!c.categoryOnly&&!c.categoryId&&(!c.category||!s.includes(c.category)));else{const l=i.find(f=>f.name===o)?.id;l&&(r=x.filter(f=>f.categoryId===l&&!f.categoryOnly))}return e.jsx(oe,{useWindowScroll:!0,increaseViewportBy:300,data:r,totalCount:r.length,components:{List:ne,Item:ht},itemContent:(c,l)=>e.jsx(J,{product:l,onClick:()=>E(l),setActiveCategory:y})})})()})})})]})}),e.jsx(pt,{open:T!==null,handleClose:b,product:T}),e.jsx(at,{open:B,onClose:()=>R(!1),onScanSuccess:s=>{R(!1),D(s),window.scrollTo({top:0,behavior:"smooth"})}}),e.jsx(Ye,{open:W,onContinue:()=>F(!1),onNavigateAway:()=>m({to:"/shop"})})]})}const mt=({onClick:o})=>e.jsxs(de,{onClick:o,sx:{minWidth:120,height:"100%",borderRadius:4,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",bgcolor:"action.hover",border:1,borderColor:"divider",cursor:"pointer","&:hover":{borderColor:"primary.main",bgcolor:"action.selected",transform:"scale(1.02)",transition:"all 0.2s"}},children:[e.jsx(ce,{sx:{bgcolor:"primary.main",mb:1.5,width:48,height:48},children:e.jsx(Ke,{sx:{color:"black",fontSize:20,ml:.5}})}),e.jsx(h,{variant:"subtitle2",sx:{fontWeight:800,color:"text.primary"},children:"View All"})]}),ie=({title:o,count:d,products:t,onProductClick:i,onViewAll:x,setActiveCategory:C})=>e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",px:0,mb:1.5},children:[e.jsxs(h,{variant:"h6",sx:{fontWeight:800,textTransform:"uppercase",letterSpacing:.5,fontSize:"0.9rem"},children:[o," ",e.jsxs(h,{component:"span",sx:{color:"text.secondary",fontWeight:600},children:["(",d,")"]})]}),e.jsx(U,{size:"small",onClick:x,sx:{fontWeight:700,textTransform:"none",color:"primary.main",minWidth:0,p:0,"&:hover":{bgcolor:"transparent",textDecoration:"underline"}},children:"View all"})]}),e.jsxs(n,{sx:{display:"flex",gap:2,overflowX:"auto",px:2,pb:1,"&::-webkit-scrollbar":{display:"none"},scrollSnapType:"x mandatory","& > *":{scrollSnapAlign:"start"}},children:[t.filter(u=>u.categoryOnly).slice(0,1).map(u=>e.jsx(n,{sx:{minWidth:200,maxWidth:200},children:e.jsx(J,{product:u,onClick:i,setActiveCategory:C})},u.id)),e.jsx(n,{sx:{minWidth:120,py:.5},children:e.jsx(mt,{onClick:x})})]})]}),pt=({open:o,handleClose:d,product:t})=>{const[i,x]=p.useState(1),[C,u]=p.useState(""),[z,I]=p.useState(""),[m,W]=p.useState(null),F=_(r=>r.addToCart),T=_(r=>r.items),M=_(r=>r.updateQuantity),{rules:S}=me(),D=$(r=>r.categoryItems),B=pe(r=>r.suppliers),R=T.find(r=>r.id===t?.id&&r.selectedSize?.label===m?.label);H.useEffect(()=>{o&&t&&(R?x(R.quantity):(x(1),u(""),I("")))},[o,t?.id,m?.label]),H.useEffect(()=>{if(t?.isComplexVariant&&C&&z){const r=Number(C)*Number(z);x(Math.round(r*100)/100)}},[C,z,t?.isComplexVariant]),H.useEffect(()=>{o&&t?t.sizes&&t.sizes.length>0?W(t.sizes[0]):W(null):o||W(null)},[o,t?.id]);const P=m?m.price:t?.price,L=m?m.purchasePrice:t?.purchasePrice,w=H.useMemo(()=>!o||P===void 0||L===void 0?"":lt(P,L),[o,P,L]);if(!t)return null;const O=m?m.price:t.price??0,k=m&&m.price!==void 0||t.price!==void 0;let g=0;if(t.taxRuleId){const r=S.find(c=>c.id===t.taxRuleId);r&&(r.valueType==="percentage"?g=O*(r.value/100):g=r.value)}let y=0;t.addonRuleIds&&t.addonRuleIds.length>0&&t.addonRuleIds.forEach(r=>{const c=S.find(l=>l.id===r);c&&(c.valueType==="percentage"?y+=O*(c.value/100):y+=c.value)});const E=O,b=E+g+y,s=()=>{let r=m;t.isComplexVariant&&(r={label:`${C} x ${z} ${t.unitName||"units"}`,price:O}),R?(t.isComplexVariant?T.find(l=>l.id===t.id&&l.selectedSize?.label===r.label):R)?M(t.id,i,r?.label):F({id:t.id,sku:t.sku,name:t.name,buyPrice:E,taxAmount:g,addonAmount:y,totalPrice:b,src:t.src,quantity:i,selectedSize:r,category:t.category,isComplexVariant:t.isComplexVariant,unitName:t.unitName}):F({id:t.id,sku:t.sku,name:t.name,buyPrice:E,taxAmount:g,addonAmount:y,totalPrice:b,src:t.src,quantity:i,selectedSize:r,category:t.category,isComplexVariant:t.isComplexVariant,unitName:t.unitName}),d()};return e.jsx(ue,{fullScreen:!0,open:o,onClose:d,TransitionComponent:dt,PaperProps:{sx:{bgcolor:"background.default",color:"text.primary"}},children:e.jsxs(n,{sx:{position:"relative",display:"flex",flexDirection:"column",height:"100%",maxWidth:"sm",mx:"auto",width:"100%",bgcolor:"background.paper",boxShadow:r=>r.shadows[10]},children:[e.jsx(xe,{sx:{position:"sticky",bgcolor:"background.paper",color:"text.primary",boxShadow:"none",borderBottom:1,borderColor:"divider"},children:e.jsxs(he,{sx:{justifyContent:"space-between",minHeight:56},children:[e.jsx(Y,{edge:"start",onClick:d,"aria-label":"close",size:"small",children:e.jsx(We,{fontSize:"small"})}),e.jsx(h,{sx:{fontWeight:800,fontSize:"1.1rem",letterSpacing:-.5},variant:"h6",children:"Product Details"}),e.jsx(n,{sx:{position:"relative",display:"flex"},children:e.jsx(ye,{})})]})}),e.jsxs(n,{sx:{flex:1,overflowY:"auto",pb:13},children:[e.jsxs(n,{sx:{width:"100%",aspectRatio:"16/9",bgcolor:"#121212",borderRadius:"0 0 20px 20px",position:"relative",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"inset 0 -10px 20px rgba(0,0,0,0.2)"},children:[t.src&&e.jsx(n,{component:"img",src:t.src,alt:t.name,sx:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}}),e.jsx(n,{sx:{position:"absolute",bottom:12,right:12,bgcolor:"rgba(0,0,0,0.6)",color:"white",px:1.2,py:.4,borderRadius:10,fontSize:11,fontWeight:"bold",backdropFilter:"blur(8px)",zIndex:1},children:"1 / 3"})]}),e.jsxs(n,{sx:{px:2.5,pt:2.5},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:.5},children:[e.jsxs(n,{sx:{flex:1,pr:2},children:[e.jsx(h,{variant:"h6",sx:{fontWeight:800,lineHeight:1.2,mb:.5},children:t.name}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5,color:"success.main"},children:[e.jsx(Re,{sx:{fontSize:14}}),e.jsx(h,{variant:"caption",sx:{fontWeight:600},children:"In Stock • Ready to sell"})]}),w&&e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5,color:"grey.600",mt:.5},children:[e.jsx(se,{sx:{fontSize:14}}),e.jsxs(h,{variant:"caption",sx:{fontWeight:600},children:["PID: ",w]})]}),t.sku&&e.jsxs(h,{variant:"caption",sx:{fontWeight:800,color:"text.disabled",letterSpacing:1,mt:.5,display:"block"},children:["SKU: ",t.sku]})]}),e.jsxs(n,{sx:{textAlign:"right"},children:[e.jsx(h,{variant:"h6",color:"primary.main",sx:{fontWeight:800,lineHeight:1},children:k?`₹${b?.toFixed(2)}`:"Price on Request"}),(g>0||y>0)&&e.jsxs(e.Fragment,{children:[e.jsxs(h,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5,fontSize:"0.7rem"},children:["(Base: ₹",E.toFixed(2),")"]}),e.jsxs(h,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.2,fontSize:"0.7rem"},children:["(Tax: ₹",g.toFixed(2),")"]}),e.jsxs(h,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.2,fontSize:"0.7rem"},children:["(Addon: ₹",y.toFixed(2),")"]})]})]})]}),e.jsx(q,{sx:{my:2,opacity:.6}}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1.5},children:[e.jsx(h,{variant:"caption",sx:{fontWeight:800,textTransform:"uppercase",letterSpacing:1,color:"text.secondary"},children:"Size Selection"}),e.jsx(U,{variant:"text",size:"small",startIcon:e.jsx(Te,{sx:{fontSize:"14px !important"}}),sx:{textTransform:"none",color:"text.secondary",fontSize:"0.75rem",fontWeight:600,minWidth:0,p:0},children:"Size Guide"})]}),t.sizes&&t.sizes.length>0?e.jsx($e,{fullWidth:!0,size:"small",children:e.jsx(He,{value:m?m.label:"",onChange:r=>{const c=t.sizes.find(l=>l.label===r.target.value);W(c)},sx:{borderRadius:2,fontWeight:700,fontSize:"0.85rem",bgcolor:"background.paper","& .MuiSelect-select":{py:1}},children:t.sizes.map(r=>e.jsxs(Ge,{value:r.label,children:[r.label," - ₹",r.price.toFixed(2)]},r.label))})}):e.jsx(h,{variant:"body2",sx:{fontWeight:600,color:"text.secondary",bgcolor:"action.hover",p:1,borderRadius:2,textAlign:"center"},children:"SIngle Variant"})]}),e.jsxs(n,{sx:{bgcolor:"action.hover",borderRadius:3,p:2,display:"flex",alignItems:"flex-start",justifyContent:"space-between"},children:[e.jsx(n,{sx:{flex:1,mr:2},children:t.isComplexVariant?e.jsxs(n,{sx:{width:"100%"},children:[e.jsxs(h,{variant:"caption",sx:{fontWeight:800,textTransform:"uppercase",letterSpacing:.5,color:"text.secondary",display:"block",mb:1},children:["Measurements (",t.unitName,")"]}),e.jsxs(n,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx(G,{type:"number",placeholder:"X",value:C,onChange:r=>u(Number(r.target.value)),sx:{bgcolor:"background.paper",border:1,borderColor:"divider",borderRadius:2,px:2,py:1,width:"100%",fontWeight:"bold"}}),e.jsx(h,{sx:{color:"text.secondary",fontWeight:"bold"},children:"x"}),e.jsx(G,{type:"number",placeholder:"Y",value:z,onChange:r=>I(Number(r.target.value)),sx:{bgcolor:"background.paper",border:1,borderColor:"divider",borderRadius:2,px:2,py:1,width:"100%",fontWeight:"bold"}})]}),e.jsxs(h,{variant:"body2",sx:{mt:1,fontWeight:"bold",color:"primary.main",textAlign:"right"},children:["Total: ",i," ",t.unitName,"²"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{variant:"caption",sx:{fontWeight:800,textTransform:"uppercase",letterSpacing:.5,color:"text.secondary",display:"block",mb:.5},children:"Quantity"}),e.jsx(Ue,{quantity:i,onQuantityChange:x})]})}),e.jsxs(n,{sx:{textAlign:"right",marginTop:"auto",marginBottom:"auto"},children:[e.jsx(h,{variant:"caption",sx:{fontWeight:800,textTransform:"uppercase",letterSpacing:.5,color:"text.secondary",display:"block",mb:.5},children:"Total Value"}),e.jsxs(h,{sx:{fontWeight:900,color:"text.primary",fontSize:"1.1rem"},children:["₹",(b*i).toFixed(2)]})]})]}),e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(h,{variant:"subtitle1",sx:{fontWeight:800},children:"Description"}),e.jsx(se,{sx:{fontSize:16,color:"text.disabled"}})]}),e.jsx(h,{variant:"body2",color:"text.secondary",sx:{lineHeight:1.6,fontSize:"0.875rem"},children:t.detail}),(t.secondaryCategoryIds?.length>0||t.supplierIds?.length>0)&&e.jsxs(n,{sx:{mt:2,display:"flex",flexDirection:"column",gap:1.5},children:[t.secondaryCategoryIds?.length>0&&e.jsxs(n,{children:[e.jsx(h,{variant:"caption",sx:{fontWeight:800,color:"text.secondary",display:"block",mb:.5},children:"ALSO IN"}),e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:t.secondaryCategoryIds.map(r=>{const c=D.find(l=>l.id===r);return c?e.jsx(Z,{label:c.name,size:"small",sx:{height:24,fontSize:"0.7rem"}},r):null})})]}),t.supplierIds?.length>0&&e.jsxs(n,{children:[e.jsx(h,{variant:"caption",sx:{fontWeight:800,color:"text.secondary",display:"block",mb:.5},children:"SUPPLIERS"}),e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:t.supplierIds.map(r=>{const c=B.find(l=>l.id===r);return c?e.jsx(Z,{label:c.name,size:"small",variant:"outlined",sx:{height:24,fontSize:"0.7rem"}},r):null})})]})]}),e.jsxs(n,{sx:{mt:2.5,p:1.5,borderRadius:3,display:"flex",gap:1.5,bgcolor:"primary.light",background:"linear-gradient(135deg, rgba(242, 215, 13, 0.1) 0%, rgba(242, 215, 13, 0.05) 100%)",border:"1px solid rgba(242, 215, 13, 0.2)",alignItems:"center"},children:[e.jsx(n,{sx:{width:36,height:36,borderRadius:"10px",bgcolor:"primary.main",display:"flex",alignItems:"center",justifyContent:"center",color:"common.black",flexShrink:0},children:e.jsx(Ee,{sx:{fontSize:18}})}),e.jsxs(n,{children:[e.jsx(h,{sx:{fontWeight:800,fontSize:"0.8rem",color:"text.primary"},children:"Free Desk Delivery"}),e.jsx(h,{sx:{fontSize:"0.7rem",color:"text.secondary",fontWeight:500},children:"Collection available within 2 hours at front desk"})]})]})]})]})]})]}),e.jsx(n,{sx:{position:"fixed",bottom:0,left:0,right:0,p:2,bgcolor:"background.paper",borderTop:1,borderColor:"divider",maxWidth:"sm",mx:"auto",zIndex:10},children:e.jsx(U,{fullWidth:!0,variant:"contained",size:"large",onClick:s,disabled:!k,sx:{py:2,borderRadius:4,fontWeight:800,textTransform:"none",fontSize:"1.1rem",bgcolor:k?R?"success.main":"primary.main":"action.disabled",color:k?R?"white":"black":"text.disabled",boxShadow:k?"0 8px 20px -4px rgba(242, 215, 13, 0.4)":"none","&:hover":{bgcolor:R?"success.dark":"primary.dark"}},children:k?`Add to Cart • ₹${(b*i).toFixed(2)}`:"Contact for Pricing"})})]})})},J=({product:o,onClick:d,setActiveCategory:t})=>{const x=_(u=>u.items).some(u=>u.id===o.id),C=u=>{u.stopPropagation(),d(o)};return e.jsx(de,{onClick:()=>{o.categoryOnly?t(o.category):d(o)},sx:{cursor:"pointer",borderRadius:4,height:"100%",display:"flex",flexDirection:"column",bgcolor:"background.paper",border:1,borderColor:x?"primary.main":"divider",boxShadow:x?"0 0 15px rgba(242, 215, 13, 0.2)":"0 2px 6px -1px rgba(0, 0, 0, 0.05)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{borderColor:"primary.main",transform:"translateY(-4px)",boxShadow:"0 12px 20px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.05)"}},children:e.jsxs(n,{sx:{p:1,flex:1,display:"flex",flexDirection:"column"},children:[e.jsxs(n,{sx:{aspectRatio:"1/1",bgcolor:"action.hover",borderRadius:3,mb:1,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden"},children:[o.src?e.jsx("img",{loading:"lazy",src:o.src,alt:o.name,style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"10px"}}):e.jsx(n,{sx:{color:"text.disabled",opacity:.2},children:e.jsx(K,{name:o.icon,className:"!text-5xl"})}),e.jsxs(n,{sx:{position:"absolute",top:6,left:6,display:"flex",flexDirection:"column",gap:.5},children:[o.sale&&e.jsx(n,{sx:{bgcolor:"secondary.main",color:"white",fontSize:"0.6rem",fontWeight:900,px:.75,py:.25,borderRadius:1.5,textTransform:"uppercase",letterSpacing:.5},children:"Sale"}),o.isNew&&e.jsx(n,{sx:{bgcolor:"info.main",color:"black",fontSize:"0.6rem",fontWeight:900,px:.75,py:.25,borderRadius:1.5,textTransform:"uppercase",letterSpacing:.5},children:"New"})]}),!o.categoryOnly&&e.jsx(n,{sx:{position:"absolute",bottom:6,left:6,bgcolor:"rgba(0,0,0,0.7)",backdropFilter:"blur(4px)",px:1,py:.5,borderRadius:2,color:"white"},children:e.jsx(h,{sx:{fontSize:"0.75rem",fontWeight:900},children:o.sizes&&o.sizes.length>0?`${o.sizes.length} Variants`:o?.price!==void 0?`₹${o.price.toFixed(0)}`:"Contact for Price"})}),!o.categoryOnly&&e.jsx(Y,{onClick:C,size:"small",sx:{position:"absolute",bottom:6,right:6,bgcolor:x?"primary.main":"rgba(255,255,255,0.9)",color:x?"black":"text.primary",width:32,height:32,borderRadius:2,transition:"all 0.2s","&:hover":{bgcolor:"primary.main",color:"black",transform:"scale(1.1)"}},children:e.jsx(Fe,{sx:{fontSize:20}})})]}),e.jsxs(n,{sx:{px:.5,pb:.5},children:[e.jsx(h,{variant:"caption",sx:{fontWeight:900,lineHeight:1.1,fontSize:"0.75rem",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",color:"text.primary",mb:o.categoryOnly?.5:0},children:o.name}),o.categoryOnly&&e.jsxs(e.Fragment,{children:[o.detail&&e.jsx(h,{variant:"caption",sx:{display:"block",fontSize:"0.65rem",color:"text.secondary",lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:o.detail.length>40?`${o.detail.substring(0,40)}...`:o.detail}),o.sku&&e.jsxs(h,{variant:"caption",sx:{display:"block",fontSize:"0.6rem",fontWeight:700,color:"text.disabled",mt:.25,letterSpacing:.5},children:["SKU: ",o.sku]})]})]})]})})};export{Xt as component};

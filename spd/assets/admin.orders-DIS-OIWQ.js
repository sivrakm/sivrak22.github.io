import{aa as rr,a as tr,u as or,r as a,j as e,B as n,I as w,A as xe,h as d,S as b,C as sr,m as nr,k as ge,E as fe,l as ir,a1 as ye,p as ar,q as u,D as lr,G as cr,H as dr,y as pr,v as x,x as f,ab as be,w as ur}from"./index-CBou6moi.js";import{p as mr,a as hr}from"./printInvoice-Bb1PbcHs.js";import{O as xr}from"./OrderItem-DkxFQcc9.js";import{O as gr,a as fr}from"./OrderShippingDetails-DBTTviIx.js";import{W as yr,R as br,C as jr,c as Cr}from"./WhatsAppShareButton-Bk0A3RXC.js";import{Y as vr}from"./index-DWku4nr_.js";import{u as Sr}from"./deliveryStore-DfoFwVpJ.js";import{C as je}from"./Cancel-DrE5d04Z.js";import{S as Ce}from"./Search-DEj_P3US.js";import{B as l}from"./Button-BflV7euM.js";import{C as Dr}from"./Chip-BXUFp7Xu.js";import{P as wr}from"./Person-Ppu-bxkp.js";import{T as ve,L as kr}from"./TextField-RXHFbKtb.js";import{D as Y,a as J,b as V}from"./DialogTitle-f2PvcPNk.js";import{D as Se}from"./DialogContentText-QZEy0qxP.js";import{D as G}from"./DialogActions-BLBSxaJt.js";import{L as De}from"./ListItem-Anqu2vOM.js";import{L as we}from"./ListItemText-BtKz7UBn.js";import{L as Pr}from"./ListItemAvatar-DHpKiIzo.js";import{C as Rr}from"./CheckCircle-DhJyyHVD.js";import{H as ke}from"./HourglassTop-Du6lS-2A.js";import{I as zr}from"./Inventory2-DA7Atluh.js";import{L as Tr}from"./LocalShipping-DJqXIIiw.js";import"./ShoppingCart-Dll2RlNX.js";import"./Divider-8YTaR6cQ.js";import"./dividerClasses-aUSE17Cl.js";import"./Phone-CMIUrlWo.js";import"./Home-abGg50Z0.js";import"./Business-7pyVT6yB.js";import"./InputAdornment-DpBsnqo5.js";import"./QuantitySelector-D3KUdhXw.js";import"./Add-q8NcmhRW.js";import"./SwitchBase-C11Fma45.js";import"./Checkbox-BKxSD9Yg.js";import"./WhatsApp-BUNF56kZ.js";import"./isMuiElement-fD2fXW9_.js";import"./listItemTextClasses-CNe8SJtV.js";function Wr(X){return rr({select:y=>y.location})}const E=pr`
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
`;function xt(){const X=tr(),y=or(t=>t.user),[k,Pe]=a.useState([]),[Re,P]=a.useState(!0),[m,ze]=a.useState("All"),[R,Te]=a.useState(null),[We,z]=a.useState(!1),[_,K]=a.useState(null),[Ae,Z]=a.useState(!1),[j,Ie]=a.useState(null),[Le,T]=a.useState(!1),[ee,re]=a.useState(null),[W,B]=a.useState(""),[Oe,F]=a.useState(!1),[te,oe]=a.useState(null),{deliveryPersons:Ne,fetchDeliveryPersons:Ee}=Sr(),[Be,Q]=a.useState(!1),[A,I]=a.useState(""),[$,se]=a.useState({}),ne=Wr();a.useEffect(()=>{const r=new URLSearchParams(ne.search).get("search");r&&(I(r),Q(!0))},[ne.search]);const[Fe,L]=a.useState(!1),[ie,q]=a.useState(""),[C,ae]=a.useState(null),Qe=["All","Processing","Delivered","Cancelled"],h=async()=>{if(!y){P(!1);return}try{const t=ar(u,"orders"),r=lr(t,cr("timestamp","desc")),o=(await dr(r)).docs.map(i=>({id:i.id,...i.data()}));Pe(o)}catch(t){console.error("Error fetching orders:",t)}finally{P(!1)}};a.useEffect(()=>{h(),Ee()},[y]);const g=k.filter(t=>{if(m!=="All"&&(t.status==="pending"?"Processing":t.status).toLowerCase()!==m.toLowerCase())return!1;if(A.trim()){const r=A.toLowerCase(),s=t.id.toLowerCase().includes(r),o=t.shippingDetails||{},i=(o.firstName?.toLowerCase()||"").includes(r)||(o.lastName?.toLowerCase()||"").includes(r),c=(o.phoneNumber||"").includes(r),p=(o.orgName?.toLowerCase()||"").includes(r),v=t.items?.some(S=>S.name.toLowerCase().includes(r));return s||i||c||p||v}return!0}),$e=async()=>{if(!y||!y.phoneNumber){alert("User phone number not found. Cannot verify identity.");return}if(ie!==y.phoneNumber){alert("Phone number does not match logged-in user.");return}const t=g;if(t.length!==0){P(!0);try{const r=t.map(async s=>{const o=x(u,"orders",s.id);C==="deliver"?s.status!=="Delivered"&&await f(o,{status:"Delivered"}):C==="delete"&&await be(o)});await Promise.all(r),alert(`Bulk ${C==="deliver"?"Delivery":"Deletion"} Complete!`),L(!1),q(""),ae(null),h()}catch(r){console.error("Bulk action error:",r),alert("Failed to perform bulk action.")}finally{P(!1)}}},le=t=>{ae(t),L(!0),q("")},ce=t=>{switch(t.toLowerCase()){case"pending":case"processing":return{label:"Processing",icon:e.jsx(ke,{fontSize:"small"}),color:"warning.main",bgcolor:"rgba(237, 108, 2, 0.1)",borderColor:"rgba(237, 108, 2, 0.2)"};case"shipped":return{label:"Shipped",icon:e.jsx(Tr,{fontSize:"small"}),color:"info.main",bgcolor:"rgba(2, 136, 209, 0.1)",borderColor:"rgba(2, 136, 209, 0.2)"};case"delivered":return{label:"Delivered",icon:e.jsx(zr,{fontSize:"small"}),color:"success.main",bgcolor:"rgba(46, 125, 50, 0.1)",borderColor:"rgba(46, 125, 50, 0.2)"};case"cancelled":return{label:"Cancelled",icon:e.jsx(je,{fontSize:"small"}),color:"error.main",bgcolor:"rgba(211, 47, 47, 0.1)",borderColor:"rgba(211, 47, 47, 0.2)"};case"delay":return{label:"Delayed",icon:e.jsx(ke,{fontSize:"small"}),color:"secondary.main",bgcolor:"rgba(156, 39, 176, 0.1)",borderColor:"rgba(156, 39, 176, 0.2)"};case"returned":return{label:"Returned",icon:e.jsx(ye,{fontSize:"small"}),color:"text.primary",bgcolor:"rgba(0, 0, 0, 0.08)",borderColor:"divider"};default:return{label:"Completed",icon:e.jsx(Rr,{fontSize:"small"}),color:"text.secondary",bgcolor:"action.hover",borderColor:"divider"}}},M=(t,r)=>{try{const s=x(u,"orders",t);f(s,{status:r}),h()}catch(s){console.error("Error updating order status:",s),alert("Failed to update order status = "+t)}},qe=async(t,r,s)=>{if(!r||r<=0)return;const o=k.find(i=>i.id===t);if(o)try{const i={amount:r,timestamp:new Date,method:s},c=[...o.payments||[],i],p=(o.paidAmount||0)+r,v=x(u,"orders",t);await f(v,{payments:c,paidAmount:p}),se(S=>({...S,[t]:""})),h()}catch(i){console.error("Error adding payment:",i),alert("Failed to add payment")}},Me=async t=>{try{const r=x(u,"orders",t);await f(r,{isClosed:!0}),h()}catch(r){console.error("Error closing delay:",r),alert("Failed to close delayed order")}},He=async()=>{if(_)try{const t=x(u,"orders",_);await be(t),z(!1),K(null),alert("Order deleted successfully"),h()}catch(t){console.error("Error deleting order:",t),alert("Failed to delete order")}},Ue=t=>{K(t),z(!0)},Ye=t=>{if(!t)return"Just now";const r=t.toDate(),o=new Date().getTime()-r.getTime(),i=Math.floor(o/(1e3*60*60*24));return i===0?`Today, ${r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:i===1?`Yesterday, ${r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:r.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},Je=t=>{Te(R===t?null:t)},Ve=t=>{const r=k.find(s=>s.id===t);mr(r)},Ge=t=>{const r=k.find(s=>s.id===t);hr(r)},Xe=t=>{Ie(t),Z(!0)},_e=async t=>{if(j)try{const r=Cr(t,j.manualAddons,j.deliveryAmount),s=t.every(c=>(c.returnedQuantity||0)>=c.quantity),o={...r,items:t};s&&(o.status="Returned");const i=x(u,"orders",j.id);await f(i,o);try{for(let c=0;c<t.length;c++){const p=t[c],v=j.items[c],S=p.returnedQuantity||0,er=v.returnedQuantity||0,H=S-er;if(H>0){const ue=x(u,"products",String(p.id)),me=await ur(ue);if(me.exists()){const he=me.data(),O={};if(p.selectedSize){const N=he.sizes||[],U=N.findIndex(D=>D.label===p.selectedSize.label);if(U!==-1){const D={...N[U]};D.returnStock=(D.returnStock||0)+H,N[U]=D,O.sizes=N}}else O.returnStock=(he.returnStock||0)+H;Object.keys(O).length>0&&await f(ue,O)}}}}catch(c){console.error("Error updating return stock:",c)}alert("Return processed successfully"),h()}catch(r){throw console.error("Error processing return:",r),r}},de=async t=>{if(ee)try{const r=x(u,"orders",ee.id);await f(r,{deliveryPersonId:t?.id||null,deliveryPersonName:t?.name||null,deliveryPersonPhone:t?.phone||null,deliveryPersonVehicle:t?.vehicleNumber||null}),T(!1),re(null),alert(t?"Driver assigned successfully":"Driver assignment cleared"),h()}catch(r){console.error("Error assigning/clearing driver:",r),alert("Failed to update driver assignment")}},pe=()=>{const t=Ne.filter(s=>s.status==="active");if(!W)return t;const r=W.toLowerCase();return t.map(s=>{let o=0;const i=(s.name||"").toLowerCase(),c=(s.phone||"").toLowerCase(),p=(s.vehicleNumber||"").toLowerCase();return i===r?o+=100:i.startsWith(r)?o+=50:i.includes(r)&&(o+=20),c===r?o+=90:c.startsWith(r)?o+=40:c.includes(r)&&(o+=15),p===r?o+=80:p.startsWith(r)?o+=30:p.includes(r)&&(o+=10),{driver:s,score:o}}).filter(s=>s.score>0).sort((s,o)=>o.score-s.score).map(s=>s.driver)},Ke=async t=>{if(te)try{const r=x(u,"orders",te.id),s={firstName:t.name||"",orgName:t.organisation||"",address:t.address||"",zip:t.zip||"",city:t.city||"",phoneNumber:t.phone||""};await f(r,{shippingDetails:s}),F(!1),oe(null),h()}catch(r){console.error("Error updating customer:",r),alert("Failed to update customer")}},Ze=t=>{oe(t),F(!0)};return e.jsxs(n,{sx:{pb:10,bgcolor:"background.default",minHeight:"100vh",color:"text.primary"},children:[e.jsx(n,{sx:{position:"sticky",top:0,zIndex:1100,bgcolor:"background.default",borderBottom:1,borderColor:"divider"},children:e.jsx(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:2,height:60},children:Be?e.jsxs(n,{sx:{display:"flex",alignItems:"center",flex:1,gap:1},children:[e.jsx(w,{onClick:()=>{Q(!1),I("")},children:e.jsx(xe,{})}),e.jsx("input",{autoFocus:!0,placeholder:"Search orders...",style:{flex:1,border:"none",outline:"none",background:"transparent",fontSize:"1rem",color:"inherit"},value:A,onChange:t=>I(t.target.value)}),A&&e.jsx(w,{size:"small",onClick:()=>I(""),children:e.jsx(je,{fontSize:"small"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{sx:{ml:-1},onClick:()=>X({to:"/shop"}),children:e.jsx(xe,{})}),e.jsxs(d,{variant:"h6",sx:{fontWeight:"bold"},children:["Estimate"," History"]}),e.jsx(w,{sx:{mr:-1},onClick:()=>Q(!0),children:e.jsx(Ce,{})})]})})}),e.jsxs(n,{sx:{p:2},children:[e.jsx(n,{sx:{display:"flex",gap:1.5,overflowX:"auto",p:2,mb:2,"&::-webkit-scrollbar":{display:"none"},animation:`${E} 0.6s ease-out forwards`},children:Qe.map(t=>e.jsx(l,{variant:m===t?"contained":"outlined",onClick:()=>ze(t),sx:{flexShrink:0,borderRadius:50,textTransform:"none",fontWeight:"bold",fontSize:"0.875rem",px:3,py:1,bgcolor:m===t?"primary.main":"background.paper",color:m===t?"black":"text.secondary",borderColor:m===t?"primary.main":"divider",boxShadow:m===t?"0 4px 12px rgba(242, 215, 13, 0.2)":"none","&:hover":{bgcolor:m===t?"primary.main":"action.hover",borderColor:m===t?"primary.main":"divider"}},children:t},t))}),e.jsxs(b,{direction:"row",spacing:2,sx:{px:2,mb:2},justifyContent:"flex-end",children:[e.jsxs(l,{size:"small",variant:"outlined",color:"success",onClick:()=>le("deliver"),disabled:g.length===0,children:["Deliver All (",g.length,")"]}),e.jsxs(l,{size:"small",variant:"outlined",color:"error",onClick:()=>le("delete"),disabled:g.length===0,children:["Delete All (",g.length,")"]})]}),Re?e.jsx(n,{sx:{display:"flex",justifyContent:"center",py:8},children:e.jsx(sr,{})}):g.length===0?e.jsx(n,{sx:{textAlign:"center",py:8,animation:`${E} 0.6s ease-out forwards`},children:e.jsx(d,{color:"text.secondary",children:"No orders found."})}):e.jsx(n,{sx:{width:"100%",animation:`${E} 0.6s ease-out forwards`,animationDelay:"0.1s"},children:e.jsx(vr,{useWindowScroll:!0,increaseViewportBy:300,data:g,itemContent:(t,r)=>{const s=r.orderType==="delay"&&!r.isClosed?ce("delay"):ce(r.status);return e.jsx(n,{sx:{pb:2},children:e.jsx(nr,{sx:{p:2,borderRadius:3,border:1,borderColor:"divider",boxShadow:"none",cursor:"pointer",transition:"all 0.2s","&:active":{transform:"scale(0.98)"}},onClick:()=>Je(r.id),children:e.jsxs(n,{sx:{width:"100%"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,flex:1,minWidth:0},children:[e.jsx(ge,{sx:{width:48,height:48,bgcolor:s.bgcolor,color:s.color,border:1,borderColor:s.borderColor,flexShrink:0},children:s.icon}),e.jsxs(n,{sx:{flex:1,minWidth:0},children:[e.jsxs(b,{direction:"row",spacing:1,alignItems:"center",sx:{flexWrap:"wrap",mb:.25},children:[e.jsx(Dr,{label:`#${r.id.slice(0,5).toUpperCase()}`,size:"small",sx:{height:20,fontSize:"0.65rem",fontWeight:900,borderRadius:1,bgcolor:"action.selected",color:"text.primary"}}),r.shippingDetails?.firstName&&e.jsx(d,{variant:"body2",noWrap:!0,sx:{fontWeight:600,color:"text.primary"},children:r.shippingDetails.firstName}),r.shippingDetails?.orgName&&e.jsxs(d,{variant:"caption",noWrap:!0,sx:{color:"text.secondary",fontWeight:"medium"},children:["• ",r.shippingDetails.orgName]}),r.items?.some(o=>(o.returnedQuantity||0)>0)&&e.jsx(n,{sx:{px:.75,py:.25,borderRadius:1,bgcolor:r.items.every(o=>(o.returnedQuantity||0)>=o.quantity)?"error.main":"warning.main",color:"white",fontSize:"0.65rem",fontWeight:"bold",lineHeight:1},children:r.items.every(o=>(o.returnedQuantity||0)>=o.quantity)?"RETURNED":"PARTIAL"})]}),e.jsxs(d,{variant:"caption",noWrap:!0,sx:{color:"text.secondary",display:"flex",alignItems:"center",gap:.5,opacity:.8},children:[Ye(r.timestamp),r.deliveryPersonName&&e.jsxs(n,{component:"span",sx:{display:"flex",alignItems:"center",gap:.5},children:["• ",e.jsx(d,{component:"span",variant:"caption",sx:{fontWeight:"bold"},children:r.deliveryPersonName})]})]})]})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1.5,ml:2,flexShrink:0},children:[e.jsxs(n,{sx:{textAlign:"right"},children:[e.jsxs(d,{variant:"body2",sx:{fontWeight:800,color:"text.primary",lineHeight:1},children:["₹",r.total.toLocaleString()]}),e.jsx(n,{sx:{display:"inline-block",mt:.75,px:1,py:.25,borderRadius:1,bgcolor:s.color+"1A",color:s.color,fontSize:"0.6rem",fontWeight:900,textTransform:"uppercase",letterSpacing:.5,lineHeight:1},children:s.label})]}),e.jsx(w,{size:"small",sx:{transform:R===r.id?"rotate(180deg)":"none",transition:"transform 0.3s",bgcolor:R===r.id?"action.selected":"transparent"},children:e.jsx(fe,{})})]})]}),e.jsxs(ir,{in:R===r.id,timeout:"auto",unmountOnExit:!0,children:[e.jsx(n,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:e.jsx(gr,{order:r})}),e.jsxs(n,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:[e.jsx(l,{size:"small",variant:"outlined",color:"error",onClick:o=>{o.stopPropagation(),Ue(r.id)},children:"Delete"}),r.orderType==="delay"&&!r.isClosed&&e.jsx(l,{sx:{mt:1,borderRadius:2,textTransform:"none",fontWeight:"bold"},variant:"outlined",color:"secondary",size:"small",onClick:o=>{o.stopPropagation(),Me(r.id)},children:"Close Delay"})]}),e.jsxs(n,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(d,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",textTransform:"uppercase",letterSpacing:.5},children:"Customer Details"}),e.jsx(l,{size:"small",startIcon:e.jsx(wr,{}),onClick:o=>{o.stopPropagation(),Ze(r)},sx:{fontSize:"0.75rem"},children:"Change Customer"})]}),e.jsx(fr,{shippingDetails:r.shippingDetails||{}})]}),e.jsxs(n,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:[e.jsxs(d,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",mb:1.5,display:"block",textTransform:"uppercase",letterSpacing:.5},children:["Estimate"," Items"]}),e.jsx(b,{spacing:2,children:r.items?.map((o,i)=>e.jsx(xr,{item:o},i))}),e.jsxs(b,{direction:"row",spacing:1,sx:{mt:2},children:[e.jsx(l,{size:"small",variant:"outlined",color:"success",onClick:o=>{o.stopPropagation(),M(r.id,"Delivered")},children:"Delivered"}),e.jsx(l,{size:"small",variant:"outlined",color:"error",onClick:o=>{o.stopPropagation(),M(r.id,"Cancelled")},children:"Cancelled"}),e.jsx(l,{size:"small",variant:"outlined",color:"warning",onClick:o=>{o.stopPropagation(),M(r.id,"pending")},children:"Processing"})]})]}),r.orderType==="delay"&&!r.isClosed&&e.jsxs(n,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:[e.jsxs(d,{variant:"caption",sx:{fontWeight:"bold",color:"text.secondary",mb:1.5,display:"block",textTransform:"uppercase",letterSpacing:.5},children:["Payment Management (",r.paidAmount>=r.total?"Fully Paid":`Balance: ₹${(r.total-(r.paidAmount||0)).toFixed(2)}`,")"]}),r.payments?.length>0&&e.jsx(b,{spacing:1,sx:{mb:2},children:r.payments.map((o,i)=>e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",bgcolor:"action.hover",p:1,borderRadius:1.5,border:1,borderColor:"divider"},children:[e.jsxs(d,{variant:"caption",sx:{fontWeight:500},children:[o.timestamp?.seconds?new Date(o.timestamp.seconds*1e3).toLocaleDateString():"Just now"," - ",o.method]}),e.jsxs(d,{variant:"caption",sx:{fontWeight:"bold",color:"success.main"},children:["+₹",o.amount.toFixed(2)]})]},i))}),e.jsxs(n,{sx:{display:"flex",gap:1,alignItems:"center"},onClick:o=>o.stopPropagation(),children:[e.jsx(ve,{size:"small",placeholder:"Amount",type:"number",value:$[r.id]||"",onChange:o=>se(i=>({...i,[r.id]:o.target.value})),sx:{flex:1,"& .MuiOutlinedInput-root":{borderRadius:2}}}),e.jsx(l,{variant:"contained",size:"small",onClick:()=>qe(r.id,Number($[r.id]),"Cash"),disabled:!$[r.id],sx:{borderRadius:2,textTransform:"none",fontWeight:"bold"},children:"Add"})]})]}),e.jsxs(n,{sx:{mt:2,pt:2,borderTop:1,borderColor:"divider"},children:[e.jsxs(b,{direction:"row",spacing:1,sx:{mt:2},justifyContent:"space-between",alignItems:"center",children:[e.jsxs(n,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(l,{size:"small",variant:"contained",color:"success",onClick:o=>{o.stopPropagation(),Ve(r.id)},children:"Print"}),e.jsx(yr,{order:r})]}),e.jsx(n,{sx:{display:"flex",gap:1,alignItems:"center"},children:e.jsx(l,{size:"small",variant:"outlined",color:"warning",startIcon:e.jsx(ye,{}),onClick:o=>{o.stopPropagation(),Xe(r)},children:"Return"})})]}),e.jsxs(b,{direction:"row",spacing:1,sx:{mt:2},children:[e.jsx(l,{size:"small",variant:"outlined",color:"primary",onClick:o=>{o.stopPropagation(),re(r),T(!0)},children:"Delivery"}),e.jsx(l,{size:"small",variant:"outlined",color:"primary",onClick:o=>{o.stopPropagation(),Ge(r.id)},children:"Challan"})]})]})]})]})},r.id)})}})})]}),e.jsx(n,{sx:{mt:4,textAlign:"center",animation:`${E} 0.6s ease-out forwards`,animationDelay:"0.3s"},children:e.jsx(l,{size:"small",endIcon:e.jsx(fe,{}),sx:{color:"primary.main",fontWeight:"bold",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:1,"&:hover":{bgcolor:"transparent",color:"primary.dark"}},children:"Load More"})}),e.jsxs(Y,{open:We,onClose:()=>z(!1),PaperProps:{sx:{borderRadius:3,p:1}},children:[e.jsxs(J,{sx:{fontWeight:"bold"},children:["Delete ","Estimate","?"]}),e.jsx(V,{children:e.jsx(Se,{children:"Are you sure you want to delete this order? This action is permanent and cannot be undone."})}),e.jsxs(G,{sx:{p:2},children:[e.jsx(l,{onClick:()=>z(!1),color:"inherit",sx:{fontWeight:"bold"},children:"Cancel"}),e.jsx(l,{onClick:He,variant:"contained",color:"error",sx:{fontWeight:"bold",borderRadius:2},children:"Delete"})]})]}),e.jsxs(Y,{open:Fe,onClose:()=>L(!1),PaperProps:{sx:{borderRadius:3,p:1}},children:[e.jsxs(J,{sx:{fontWeight:"bold"},children:["Confirm Bulk ",C==="deliver"?"Delivery":"Deletion"]}),e.jsxs(V,{children:[e.jsxs(Se,{sx:{mb:2},children:["Please enter your phone number to confirm this bulk action.",e.jsx("br",{}),e.jsxs("strong",{children:["This will affect ",g.length," orders."]})]}),e.jsx("input",{type:"tel",placeholder:"Enter your phone number",style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ccc",fontSize:"1rem",outline:"none"},value:ie,onChange:t=>q(t.target.value)})]}),e.jsxs(G,{sx:{p:2},children:[e.jsx(l,{onClick:()=>L(!1),color:"inherit",sx:{fontWeight:"bold"},children:"Cancel"}),e.jsxs(l,{onClick:$e,variant:"contained",color:C==="delete"?"error":"primary",sx:{fontWeight:"bold",borderRadius:2},children:["Confirm ",C==="deliver"?"Delivery":"Deletion"]})]})]}),e.jsx(br,{open:Ae,onClose:()=>Z(!1),order:j,onSave:_e}),e.jsx(jr,{open:Oe,onClose:()=>F(!1),onSelect:Ke}),e.jsxs(Y,{open:Le,onClose:()=>{T(!1),B("")},PaperProps:{sx:{borderRadius:3,maxWidth:400,width:"90%"}},children:[e.jsx(J,{sx:{fontWeight:"bold"},children:"Assign Driver"}),e.jsxs(V,{sx:{p:0},children:[e.jsx(n,{sx:{p:2,borderBottom:1,borderColor:"divider"},children:e.jsx(ve,{fullWidth:!0,size:"small",placeholder:"Search name, phone, or vehicle...",value:W,onChange:t=>B(t.target.value),InputProps:{startAdornment:e.jsx(Ce,{sx:{mr:1,color:"text.secondary"}}),sx:{borderRadius:2}}})}),e.jsxs(kr,{sx:{py:0,maxHeight:400,overflow:"auto"},children:[e.jsx(De,{component:"div",onClick:()=>de(null),sx:{cursor:"pointer","&:hover":{bgcolor:"action.hover"},borderBottom:1,borderColor:"divider",py:1.5},children:e.jsx(we,{primary:"None (Clear)",primaryTypographyProps:{color:"text.secondary"}})}),pe().map(t=>e.jsxs(De,{component:"div",onClick:()=>de(t),sx:{cursor:"pointer","&:hover":{bgcolor:"action.hover"},borderBottom:1,borderColor:"divider",py:2},children:[e.jsx(Pr,{children:e.jsx(ge,{sx:{bgcolor:"primary.main",color:"black"},children:t.name.charAt(0).toUpperCase()})}),e.jsx(we,{primary:t.name,secondary:`${t.vehicleNumber||"No vehicle"} • ${t.phone}`,primaryTypographyProps:{fontWeight:"bold"}})]},t.id)),pe().length===0&&e.jsx(n,{sx:{p:4,textAlign:"center"},children:e.jsx(d,{variant:"body2",color:"text.secondary",children:W?"No matching drivers found.":"No active drivers found."})})]})]}),e.jsx(G,{sx:{p:2},children:e.jsx(l,{onClick:()=>{T(!1),B("")},color:"inherit",sx:{fontWeight:"bold"},children:"Cancel"})})]})]})}export{xt as component};

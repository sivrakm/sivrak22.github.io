import{f as Ce,j as e,K as Oe,J as $e,r as h,L as Be,a2 as we,M as Ge,c as Ue,a3 as te,N as ie,O as ne,P as ze,Q as _e,U as Fe,a4 as Qe,a5 as he,a6 as Xe,i as Ye,B as m,I as X,h as S,S as Y,E as qe,l as Je,a7 as Ke}from"./index-CBou6moi.js";import{Y as Ze}from"./index-DWku4nr_.js";import{A as es,T as ss,a as ts}from"./ArrowBackIosNew-CIbvTB3E.js";import{C as os}from"./Container-DtrslpOQ.js";import{A as ns}from"./AddCircle-cTCxnp_u.js";import{G as P}from"./Grid-IWINzjQb.js";import{u as is,T as $}from"./TextField-RXHFbKtb.js";import{R as xe}from"./RemoveCircleOutline-BnCmUeEd.js";import{I as Z}from"./InputAdornment-DpBsnqo5.js";import{P as fe}from"./Person-Ppu-bxkp.js";import{P as ge}from"./Phone-CMIUrlWo.js";import{M as ve}from"./Mail-DsOhcTLt.js";import{L as je}from"./LocationOn-CDKi7nvV.js";import{B as ee}from"./Button-BflV7euM.js";import{A as ye}from"./Add-q8NcmhRW.js";import{S as as}from"./Save-BYobhu1a.js";import{S as ls}from"./Search-DEj_P3US.js";import{C as rs}from"./Chip-BXUFp7Xu.js";import{E as cs}from"./Edit-FTKVc5Ef.js";import{D as ds}from"./Delete-DRnHzxX1.js";import{D as ps,a as us,b as ms}from"./DialogTitle-f2PvcPNk.js";import{D as hs}from"./DialogContentText-QZEy0qxP.js";import{D as xs}from"./DialogActions-BLBSxaJt.js";import"./isMuiElement-fD2fXW9_.js";const fs={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},gs=Ce(e.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})),vs=Ce(e.jsx("path",{d:"M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"}));function js(i){return $e("MuiRating",i)}const se=Oe("MuiRating",["root","sizeSmall","sizeMedium","sizeLarge","readOnly","disabled","focusVisible","visuallyHidden","pristine","label","labelEmptyValueActive","icon","iconEmpty","iconFilled","iconHover","iconFocus","iconActive","decimal"]);function ys(i){const n=i.toString().split(".")[1];return n?n.length:0}function ce(i,n){if(i==null)return i;const r=Math.round(i/n)*n;return Number(r.toFixed(ys(n)))}const bs=i=>{const{classes:n,size:r,readOnly:C,disabled:E,emptyValueFocused:w,focusVisible:z}=i,g={root:["root",`size${ze(r)}`,E&&"disabled",z&&"focusVisible",C&&"readOnly"],label:["label","pristine"],labelEmptyValue:[w&&"labelEmptyValueActive"],icon:["icon"],iconEmpty:["iconEmpty"],iconFilled:["iconFilled"],iconHover:["iconHover"],iconFocus:["iconFocus"],iconActive:["iconActive"],decimal:["decimal"],visuallyHidden:["visuallyHidden"]};return _e(g,js,n)},Ss=ie("span",{name:"MuiRating",slot:"Root",overridesResolver:(i,n)=>{const{ownerState:r}=i;return[{[`& .${se.visuallyHidden}`]:n.visuallyHidden},n.root,n[`size${ze(r.size)}`],r.readOnly&&n.readOnly]}})(Fe(({theme:i})=>({display:"inline-flex",position:"relative",fontSize:i.typography.pxToRem(24),color:"#faaf00",cursor:"pointer",textAlign:"left",width:"min-content",WebkitTapHighlightColor:"transparent",[`&.${se.disabled}`]:{opacity:(i.vars||i).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${se.focusVisible} .${se.iconActive}`]:{outline:"1px solid #999"},[`& .${se.visuallyHidden}`]:fs,variants:[{props:{size:"small"},style:{fontSize:i.typography.pxToRem(18)}},{props:{size:"large"},style:{fontSize:i.typography.pxToRem(30)}},{props:({ownerState:n})=>n.readOnly,style:{pointerEvents:"none"}}]}))),Re=ie("label",{name:"MuiRating",slot:"Label",overridesResolver:({ownerState:i},n)=>[n.label,i.emptyValueFocused&&n.labelEmptyValueActive]})({cursor:"inherit",variants:[{props:({ownerState:i})=>i.emptyValueFocused,style:{top:0,bottom:0,position:"absolute",outline:"1px solid #999",width:"100%"}}]}),Cs=ie("span",{name:"MuiRating",slot:"Icon",overridesResolver:(i,n)=>{const{ownerState:r}=i;return[n.icon,r.iconEmpty&&n.iconEmpty,r.iconFilled&&n.iconFilled,r.iconHover&&n.iconHover,r.iconFocus&&n.iconFocus,r.iconActive&&n.iconActive]}})(Fe(({theme:i})=>({display:"flex",transition:i.transitions.create("transform",{duration:i.transitions.duration.shortest}),pointerEvents:"none",variants:[{props:({ownerState:n})=>n.iconActive,style:{transform:"scale(1.2)"}},{props:({ownerState:n})=>n.iconEmpty,style:{color:(i.vars||i).palette.action.disabled}}]}))),ws=ie("span",{name:"MuiRating",slot:"Decimal",shouldForwardProp:i=>Qe(i)&&i!=="iconActive",overridesResolver:(i,n)=>{const{iconActive:r}=i;return[n.decimal,r&&n.iconActive]}})({position:"relative",variants:[{props:({iconActive:i})=>i,style:{transform:"scale(1.2)"}}]});function zs(i){const{value:n,...r}=i;return e.jsx("span",{...r})}function be(i){const{classes:n,disabled:r,emptyIcon:C,focus:E,getLabelText:w,highlightSelectedOnly:z,hover:g,icon:M,IconContainerComponent:B,isActive:v,itemValue:x,labelProps:T,name:F,onBlur:L,onChange:f,onClick:p,onFocus:V,readOnly:y,ownerState:D,ratingValue:u,ratingValueRounded:R,slots:q={},slotProps:J={}}=i,I=z?x===u:x<=u,W=x<=g,G=x<=E,H=x===R,U=`${F}-${we()}`,N={slots:q,slotProps:J},[s,t]=te("icon",{elementType:Cs,className:ne(n.icon,I?n.iconFilled:n.iconEmpty,W&&n.iconHover,G&&n.iconFocus,v&&n.iconActive),externalForwardedProps:N,ownerState:{...D,iconEmpty:!I,iconFilled:I,iconHover:W,iconFocus:G,iconActive:v},additionalProps:{value:x},internalForwardedProps:{as:B}}),[o,a]=te("label",{elementType:Re,externalForwardedProps:N,ownerState:{...D,emptyValueFocused:void 0},additionalProps:{style:T?.style,htmlFor:U}}),d=e.jsx(s,{...t,children:C&&!I?C:M});return y?e.jsx("span",{...T,children:d}):e.jsxs(h.Fragment,{children:[e.jsxs(o,{...a,children:[d,e.jsx("span",{className:n.visuallyHidden,children:w(x)})]}),e.jsx("input",{className:n.visuallyHidden,onFocus:V,onBlur:L,onChange:f,onClick:p,disabled:r,value:x,id:U,type:"radio",name:F,checked:H})]})}const Fs=e.jsx(gs,{fontSize:"inherit"}),Rs=e.jsx(vs,{fontSize:"inherit"});function Is(i){return`${i||"0"} Star${i!==1?"s":""}`}const Se=h.forwardRef(function(n,r){const C=Be({name:"MuiRating",props:n}),{component:E="span",className:w,defaultValue:z=null,disabled:g=!1,emptyIcon:M=Rs,emptyLabelText:B="Empty",getLabelText:v=Is,highlightSelectedOnly:x=!1,icon:T=Fs,IconContainerComponent:F=zs,max:L=5,name:f,onChange:p,onChangeActive:V,onMouseLeave:y,onMouseMove:D,precision:u=1,readOnly:R=!1,size:q="medium",value:J,slots:I={},slotProps:W={},...G}=C,H=we(f),[U,N]=is({controlled:J,default:z,name:"Rating"}),s=ce(U,u),t=Ge(),[{hover:o,focus:a},d]=h.useState({hover:-1,focus:-1});let b=s;o!==-1&&(b=o),a!==-1&&(b=a);const[Ie,ae]=h.useState(!1),de=h.useRef(),Ae=Ue(de,r),Pe=l=>{D&&D(l);const c=de.current,{right:j,left:oe,width:_}=c.getBoundingClientRect();let Q;t?Q=(j-l.clientX)/_:Q=(l.clientX-oe)/_;let A=ce(L*Q+u/2,u);A=Xe(A,u,L),d(O=>O.hover===A&&O.focus===A?O:{hover:A,focus:A}),ae(!1),V&&o!==A&&V(l,A)},Ee=l=>{y&&y(l);const c=-1;d({hover:c,focus:c}),V&&o!==c&&V(l,c)},pe=l=>{let c=l.target.value===""?null:parseFloat(l.target.value);o!==-1&&(c=o),N(c),p&&p(l,c)},Me=l=>{l.clientX===0&&l.clientY===0||(d({hover:-1,focus:-1}),N(null),p&&parseFloat(l.target.value)===s&&p(l,null))},Te=l=>{he(l.target)&&ae(!0);const c=parseFloat(l.target.value);d(j=>({hover:j.hover,focus:c}))},Le=l=>{if(o!==-1)return;he(l.target)||ae(!1);const c=-1;d(j=>({hover:j.hover,focus:c}))},[Ve,ue]=h.useState(!1),K={...C,component:E,defaultValue:z,disabled:g,emptyIcon:M,emptyLabelText:B,emptyValueFocused:Ve,focusVisible:Ie,getLabelText:v,icon:T,IconContainerComponent:F,max:L,precision:u,readOnly:R,size:q},k=bs(K),le={slots:I,slotProps:W},[ke,De]=te("root",{ref:Ae,className:ne(k.root,w),elementType:Ss,externalForwardedProps:{...le,...G,component:E},getSlotProps:l=>({...l,onMouseMove:c=>{Pe(c),l.onMouseMove?.(c)},onMouseLeave:c=>{Ee(c),l.onMouseLeave?.(c)}}),ownerState:K,additionalProps:{role:R?"img":null,"aria-label":R?v(b):null}}),[We,He]=te("label",{className:ne(k.label,k.labelEmptyValue),elementType:Re,externalForwardedProps:le,ownerState:K}),[Ne,me]=te("decimal",{className:k.decimal,elementType:ws,externalForwardedProps:le,ownerState:K});return e.jsxs(ke,{...De,children:[Array.from(new Array(L)).map((l,c)=>{const j=c+1,oe={classes:k,disabled:g,emptyIcon:M,focus:a,getLabelText:v,highlightSelectedOnly:x,hover:o,icon:T,IconContainerComponent:F,name:H,onBlur:Le,onChange:pe,onClick:Me,onFocus:Te,ratingValue:b,ratingValueRounded:s,readOnly:R,ownerState:K,slots:I,slotProps:W},_=j===Math.ceil(b)&&(o!==-1||a!==-1);if(u<1){const Q=Array.from(new Array(1/u));return h.createElement(Ne,{...me,key:j,className:ne(me.className,_&&k.iconActive),iconActive:_},Q.map((A,O)=>{const re=ce(j-1+(O+1)*u,u);return e.jsx(be,{...oe,isActive:!1,itemValue:re,labelProps:{style:Q.length-1===O?{}:{width:re===b?`${(O+1)*u*100}%`:"0%",overflow:"hidden",position:"absolute"}}},re)}))}return e.jsx(be,{...oe,isActive:_,itemValue:j},j)}),!R&&!g&&e.jsxs(We,{...He,children:[e.jsx("input",{className:k.visuallyHidden,value:"",id:`${H}-empty`,type:"radio",name:H,checked:s==null,onFocus:()=>ue(!0),onBlur:()=>ue(!1),onChange:pe}),e.jsx("span",{className:k.visuallyHidden,children:B})]})]})});function Zs(){const{suppliers:i,fetchSuppliers:n,addSupplier:r,updateSupplier:C,deleteSupplier:E}=Ye();h.useEffect(()=>{n()},[]);const[w,z]=h.useState(null),[g,M]=h.useState(!1),[B,v]=h.useState(!1),[x,T]=h.useState(null),[F,L]=h.useState(""),[f,p]=h.useState({id:"",name:"",contacts:[{name:"",phone:"",email:"",address:"",gstins:[""],rating:0}]}),V=(s,t)=>{p(o=>({...o,[s]:t}))},y=(s,t,o)=>{const a=[...f.contacts];a[s]={...a[s],[t]:o},p(d=>({...d,contacts:a}))},D=(s,t,o)=>{const a=[...f.contacts],d=[...a[s].gstins];d[t]=o,a[s]={...a[s],gstins:d},p(b=>({...b,contacts:a}))},u=s=>{const t=[...f.contacts];t[s]={...t[s],gstins:[...t[s].gstins,""]},p(o=>({...o,contacts:t}))},R=(s,t)=>{const o=[...f.contacts];o[s]={...o[s],gstins:o[s].gstins.filter((a,d)=>d!==t)},p(a=>({...a,contacts:o}))},q=()=>{p(s=>({...s,contacts:[...s.contacts,{name:"",phone:"",email:"",address:"",gstins:[""],rating:0}]}))},J=s=>{p(t=>({...t,contacts:t.contacts.filter((o,a)=>a!==s)}))},I=async()=>{const s={...f,contacts:f.contacts.filter(t=>t.name.trim()!==""||t.phone.trim()!==""||t.email.trim()!=="").map(t=>({...t,gstins:t.gstins.filter(o=>o.trim()!=="")}))};if(!s.name){alert("Supplier Name is required");return}try{w?await C(s):await r(s),U()}catch(t){console.error("Error saving supplier:",t),alert("Failed to save supplier")}},W=s=>{p({...s,contacts:s.contacts.length?s.contacts.map(t=>({...t,gstins:t.gstins?.length?t.gstins:[""],rating:t.rating||0})):[{name:"",phone:"",email:"",address:"",gstins:[""],rating:0}]}),z(s.id),M(!0),window.scrollTo({top:0,behavior:"smooth"})},G=s=>{T(s),v(!0)},H=async()=>{x&&(await E(x),v(!1),T(null))},U=()=>{p({id:"",name:"",contacts:[{name:"",phone:"",email:"",address:"",gstins:[""],rating:0}]}),z(null),M(!1),window.scrollTo({top:0,behavior:"smooth"})},N=i.filter(s=>s.name.toLowerCase().includes(F.toLowerCase())||s.contacts.some(t=>t.name.toLowerCase().includes(F.toLowerCase())));return e.jsxs(m,{sx:{minHeight:"100vh",bgcolor:"background.default",pb:10},children:[e.jsx(es,{position:"sticky",color:"default",elevation:0,sx:{bgcolor:"background.paper",borderBottom:1,borderColor:"divider"},children:e.jsxs(ss,{children:[e.jsx(X,{onClick:()=>window.history.back(),edge:"start",children:e.jsx(ts,{})}),e.jsx(S,{variant:"h6",component:"h1",sx:{flexGrow:1,textAlign:"center",pr:5,fontWeight:"bold"},children:"Manage Suppliers"})]})}),e.jsxs(os,{maxWidth:"md",sx:{py:3,display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(m,{sx:{border:1,borderColor:"divider",borderRadius:3,overflow:"hidden",bgcolor:"background.paper"},children:[e.jsxs(m,{onClick:()=>M(!g),sx:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",p:2,bgcolor:"action.hover",transition:"background-color 0.2s","&:hover":{bgcolor:"action.selected"}},children:[e.jsxs(Y,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(ns,{color:"primary"}),e.jsx(S,{variant:"subtitle1",sx:{fontWeight:"bold"},children:w?"Edit Supplier":"Add New Supplier"})]}),e.jsx(X,{size:"small",sx:{transform:g?"rotate(180deg)":"none",transition:"transform 0.3s"},children:e.jsx(qe,{})})]}),e.jsx(Je,{in:g,children:e.jsxs(m,{sx:{p:3,display:"flex",flexDirection:"column",gap:3},children:[e.jsx(P,{container:!0,spacing:2,children:e.jsx(P,{size:12,children:e.jsx($,{fullWidth:!0,label:"Supplier Name",value:f.name,onChange:s=>V("name",s.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2,fontWeight:700}}})})}),e.jsxs(m,{children:[e.jsx(S,{variant:"subtitle1",sx:{mb:2,fontWeight:"bold",color:"primary.main"},children:"Contacts"}),e.jsxs(Y,{spacing:3,children:[f.contacts.map((s,t)=>e.jsxs(m,{sx:{p:2,border:1,borderColor:"divider",borderRadius:2,bgcolor:"action.hover",position:"relative"},children:[e.jsx(X,{size:"small",color:"error",onClick:()=>J(t),sx:{position:"absolute",top:8,right:8},disabled:f.contacts.length===1&&!s.name&&!s.phone,children:e.jsx(xe,{})}),e.jsxs(P,{container:!0,spacing:2,children:[e.jsx(P,{size:{xs:12,sm:6},children:e.jsx($,{fullWidth:!0,size:"small",label:"Name",value:s.name,onChange:o=>y(t,"name",o.target.value),InputProps:{startAdornment:e.jsx(Z,{position:"start",children:e.jsx(fe,{sx:{fontSize:20,opacity:.5}})})}})}),e.jsx(P,{size:{xs:12,sm:6},children:e.jsx($,{fullWidth:!0,size:"small",label:"Phone",value:s.phone,onChange:o=>y(t,"phone",o.target.value),InputProps:{startAdornment:e.jsx(Z,{position:"start",children:e.jsx(ge,{sx:{fontSize:20,opacity:.5}})})}})}),e.jsx(P,{size:12,children:e.jsx($,{fullWidth:!0,size:"small",label:"Email",value:s.email,onChange:o=>y(t,"email",o.target.value),InputProps:{startAdornment:e.jsx(Z,{position:"start",children:e.jsx(ve,{sx:{fontSize:20,opacity:.5}})})}})}),e.jsx(P,{size:12,children:e.jsx($,{fullWidth:!0,size:"small",label:"Address",multiline:!0,rows:2,value:s.address,onChange:o=>y(t,"address",o.target.value),InputProps:{startAdornment:e.jsx(Z,{position:"start",sx:{alignSelf:"flex-start",mt:1},children:e.jsx(je,{sx:{fontSize:20,opacity:.5}})})}})}),e.jsxs(P,{size:12,children:[e.jsx(S,{variant:"caption",sx:{fontWeight:800,color:"text.secondary",display:"block",mb:1},children:"GSTINs for this Contact"}),e.jsxs(Y,{spacing:1,children:[s.gstins.map((o,a)=>e.jsxs(Y,{direction:"row",spacing:1,children:[e.jsx($,{fullWidth:!0,size:"small",placeholder:"GSTIN Number...",value:o,onChange:d=>D(t,a,d.target.value)}),e.jsx(X,{size:"small",color:"error",onClick:()=>R(t,a),disabled:s.gstins.length===1&&!o,children:e.jsx(xe,{})})]},a)),e.jsx(ee,{startIcon:e.jsx(ye,{}),size:"small",onClick:()=>u(t),sx:{alignSelf:"flex-start"},children:"Add GSTIN"})]})]}),e.jsx(P,{size:12,children:e.jsxs(m,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(S,{variant:"caption",sx:{fontWeight:800,color:"text.secondary"},children:"Rating:"}),e.jsx(Se,{value:s.rating,onChange:(o,a)=>y(t,"rating",a)})]})})]})]},t)),e.jsx(ee,{startIcon:e.jsx(ye,{}),variant:"outlined",size:"small",onClick:q,sx:{alignSelf:"flex-start",borderRadius:2},children:"Add Contact"})]})]}),e.jsx(ee,{fullWidth:!0,variant:"contained",size:"large",startIcon:e.jsx(as,{}),onClick:I,sx:{borderRadius:2,height:48},children:w?"Update Supplier":"Save Supplier"})]})})]}),e.jsxs(m,{children:[e.jsx($,{size:"small",fullWidth:!0,placeholder:"Search suppliers...",value:F,onChange:s=>L(s.target.value),InputProps:{startAdornment:e.jsx(Z,{position:"start",children:e.jsx(ls,{sx:{opacity:.5}})}),sx:{borderRadius:2,bgcolor:"background.paper",mb:2}}}),e.jsx(Ze,{useWindowScroll:!0,data:N,itemContent:(s,t)=>e.jsx(Ke,{sx:{p:2,mb:2,borderRadius:2},variant:"outlined",children:e.jsxs(m,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(m,{sx:{flex:1},children:[e.jsx(S,{variant:"h6",fontWeight:"bold",sx:{color:"primary.main",mb:.5},children:t.name}),t.contacts.map((o,a)=>e.jsxs(m,{sx:{mt:1.5,p:1.5,bgcolor:"action.hover",borderRadius:2,borderLeft:3,borderColor:"primary.light"},children:[e.jsxs(m,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5},children:[o.name&&e.jsxs(S,{variant:"subtitle2",sx:{fontWeight:800,display:"flex",alignItems:"center",gap:.5},children:[e.jsx(fe,{sx:{fontSize:16}})," ",o.name]}),e.jsx(Se,{value:o.rating,readOnly:!0,size:"small"})]}),e.jsxs(Y,{spacing:.5,sx:{mb:1},children:[o.phone&&e.jsxs(S,{variant:"caption",sx:{display:"flex",alignItems:"center",gap:1,fontWeight:600},children:[e.jsx(ge,{sx:{fontSize:14,opacity:.6}})," ",o.phone]}),o.email&&e.jsxs(S,{variant:"caption",sx:{display:"flex",alignItems:"center",gap:1,color:"text.secondary",fontWeight:500},children:[e.jsx(ve,{sx:{fontSize:14,opacity:.6}})," ",o.email]}),o.address&&e.jsxs(S,{variant:"caption",sx:{display:"flex",alignItems:"center",gap:1,color:"text.secondary",fontStyle:"italic"},children:[e.jsx(je,{sx:{fontSize:14,opacity:.6}})," ",o.address]})]}),e.jsx(m,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:o.gstins?.map((d,b)=>d&&e.jsx(rs,{label:`GST: ${d}`,size:"small",color:"info",variant:"outlined",sx:{fontWeight:"bold",height:20,fontSize:"0.65rem"}},b))})]},a))]}),e.jsx(m,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:1},children:e.jsxs(Y,{direction:"row",children:[e.jsx(X,{size:"small",onClick:()=>W(t),children:e.jsx(cs,{})}),e.jsx(X,{size:"small",color:"error",onClick:()=>G(t.id),children:e.jsx(ds,{})})]})})]})},t.id)})]})]}),e.jsxs(ps,{open:B,onClose:()=>v(!1),children:[e.jsx(us,{children:"Delete Supplier?"}),e.jsx(ms,{children:e.jsx(hs,{children:"This action cannot be undone."})}),e.jsxs(xs,{children:[e.jsx(ee,{onClick:()=>v(!1),children:"Cancel"}),e.jsx(ee,{onClick:H,color:"error",variant:"contained",children:"Delete"})]})]})]})}export{Zs as component};

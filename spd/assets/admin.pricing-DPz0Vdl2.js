import{r as i,j as e,B as l,I as d,h as s,C as V,a7 as g,S as y}from"./index-CBou6moi.js";import{u as H}from"./pricingStore-CjE7w1mK.js";import{A as q,T as J,a as K}from"./ArrowBackIosNew-CIbvTB3E.js";import{P as Q}from"./Page-BIJxk8nd.js";import{C as U}from"./Container-DtrslpOQ.js";import{G as r}from"./Grid-IWINzjQb.js";import{S as X}from"./Switch-DDTesXnY.js";import{T as h}from"./TextField-RXHFbKtb.js";import{B as c}from"./Button-BflV7euM.js";import{D as A}from"./Divider-8YTaR6cQ.js";import{A as W}from"./Add-q8NcmhRW.js";import{C as I}from"./Chip-BXUFp7Xu.js";import{E as R}from"./Edit-FTKVc5Ef.js";import{D as S}from"./Delete-DRnHzxX1.js";import{D as Y,a as Z,b as _}from"./DialogTitle-f2PvcPNk.js";import{M as z}from"./MenuItem-CGHN6H8j.js";import{D as ee}from"./DialogActions-BLBSxaJt.js";import"./isMuiElement-fD2fXW9_.js";import"./SwitchBase-C11Fma45.js";import"./dividerClasses-aUSE17Cl.js";import"./listItemTextClasses-CNe8SJtV.js";function Ce(){const{rules:b,fetchRules:P,addRule:E,updateRule:B,deleteRule:F,isLoading:N,deliveryConfig:v,fetchDeliveryConfig:G,updateDeliveryConfig:L}=H();i.useEffect(()=>{P(),G()},[]);const[O,C]=i.useState(!1),[u,D]=i.useState(null),[p,$]=i.useState("tax"),[t,o]=i.useState({label:"",type:"tax",valueType:"percentage",value:0}),[n,m]=i.useState({enabled:!1,amount:0});i.useEffect(()=>{m(v)},[v]);const x=(a,j)=>{j?(D(j),o(j)):(D(null),o({label:"",type:a,valueType:"percentage",value:0})),$(a),C(!0)},f=()=>{C(!1)},M=async()=>{if(!t.label||t.value===void 0){alert("Please fill in all fields");return}const a={label:t.label,type:p,valueType:t.valueType,value:Number(t.value)};u?await B({...a,id:u.id}):await E(a),f()},T=async a=>{confirm("Are you sure you want to delete this rule?")&&await F(a)},w=b.filter(a=>a.type==="tax"),k=b.filter(a=>a.type==="addon");return e.jsxs(l,{sx:{pb:10,bgcolor:"background.default",minHeight:"100vh",color:"text.primary"},children:[e.jsx(q,{position:"sticky",color:"default",elevation:0,sx:{bgcolor:"background.paper",borderBottom:1,borderColor:"divider"},children:e.jsxs(J,{children:[e.jsx(d,{onClick:()=>window.history.back(),edge:"start",children:e.jsx(K,{})}),e.jsx(s,{variant:"h6",component:"h1",sx:{flexGrow:1,textAlign:"center",pr:5,fontWeight:"bold"},children:"Pricing Configuration"})]})}),e.jsx(Q,{children:e.jsx(U,{maxWidth:"md",sx:{py:4},children:N?e.jsx(l,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(V,{})}):e.jsxs(r,{container:!0,spacing:4,children:[e.jsx(r,{size:12,children:e.jsx(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsx(s,{variant:"h6",sx:{fontWeight:"bold",color:"text.secondary",textDecoration:"underline"},children:"Order Level (1 per order)"})})}),e.jsxs(r,{size:12,children:[e.jsx(s,{variant:"h6",sx:{fontWeight:"bold",mb:2},children:"Delivery Charge"}),e.jsxs(g,{sx:{p:2,borderRadius:2},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(s,{variant:"subtitle1",fontWeight:"bold",children:"Enable Delivery Charge"}),e.jsx(X,{checked:n.enabled,onChange:a=>m({...n,enabled:a.target.checked})})]}),e.jsx(h,{label:"Amount",type:"number",fullWidth:!0,value:n.amount,disabled:!n.enabled,onChange:a=>m({...n,amount:Number(a.target.value)}),helperText:"Fixed amount applied to the entire order"}),e.jsx(c,{variant:"contained",color:"primary",sx:{mt:2},onClick:async()=>{try{await L(n),alert("Delivery charge saved successfully!")}catch{alert("Failed to save delivery charge. Please try again.")}},children:"Save Delivery Charge"})]})]}),e.jsxs(r,{size:12,children:[e.jsx(A,{}),e.jsx(A,{sx:{my:2}}),e.jsx(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsx(s,{variant:"h6",sx:{fontWeight:"bold",color:"text.secondary",textDecoration:"underline"},children:"Product Level (for each product)"})})]}),e.jsxs(r,{size:12,children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(s,{variant:"h6",sx:{fontWeight:"bold"},children:"Tax Rules"}),e.jsx(c,{variant:"contained",startIcon:e.jsx(W,{}),onClick:()=>x("tax"),size:"small",children:"Add Tax"})]}),e.jsxs(y,{spacing:2,children:[w.length===0&&e.jsx(s,{color:"text.secondary",children:"No tax rules defined."}),w.map(a=>e.jsxs(g,{sx:{p:2,display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:2},children:[e.jsxs(l,{children:[e.jsx(s,{variant:"subtitle1",fontWeight:"bold",children:a.label}),e.jsx(I,{label:`${a.value}${a.valueType==="percentage"?"%":" Fixed"}`,size:"small",color:"primary",variant:"outlined"})]}),e.jsxs(l,{children:[e.jsx(d,{onClick:()=>x("tax",a),size:"small",color:"primary",children:e.jsx(R,{})}),e.jsx(d,{onClick:()=>T(a.id),size:"small",color:"error",children:e.jsx(S,{})})]})]},a.id))]})]}),e.jsxs(r,{size:12,children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(s,{variant:"h6",sx:{fontWeight:"bold"},children:"Add-on Costs"}),e.jsx(c,{variant:"contained",color:"secondary",startIcon:e.jsx(W,{}),onClick:()=>x("addon"),size:"small",children:"Add Add-on"})]}),e.jsxs(y,{spacing:2,children:[k.length===0&&e.jsx(s,{color:"text.secondary",children:"No add-on rules defined."}),k.map(a=>e.jsxs(g,{sx:{p:2,display:"flex",justifyContent:"space-between",alignItems:"center",borderRadius:2},children:[e.jsxs(l,{children:[e.jsx(s,{variant:"subtitle1",fontWeight:"bold",children:a.label}),e.jsx(I,{label:`${a.value}${a.valueType==="percentage"?"%":" Fixed"}`,size:"small",color:"secondary",variant:"outlined"})]}),e.jsxs(l,{children:[e.jsx(d,{onClick:()=>x("addon",a),size:"small",color:"primary",children:e.jsx(R,{})}),e.jsx(d,{onClick:()=>T(a.id),size:"small",color:"error",children:e.jsx(S,{})})]})]},a.id))]})]})]})})}),e.jsxs(Y,{open:O,onClose:f,maxWidth:"xs",fullWidth:!0,children:[e.jsxs(Z,{children:[u?"Edit":"Add"," ",p==="tax"?"Tax Rule":"Add-on"]}),e.jsx(_,{children:e.jsxs(y,{spacing:2,sx:{mt:1},children:[e.jsx(h,{label:"Label",fullWidth:!0,placeholder:p==="tax"?"e.g. VAT, GST":"e.g. Gift Wrap, Service Charge",value:t.label,onChange:a=>o({...t,label:a.target.value})}),e.jsxs(h,{select:!0,label:"Type",fullWidth:!0,value:t.valueType,onChange:a=>o({...t,valueType:a.target.value}),children:[e.jsx(z,{value:"percentage",children:"Percentage (%)"}),e.jsx(z,{value:"fixed",children:"Fixed Amount"})]}),e.jsx(h,{label:"Value",type:"number",fullWidth:!0,value:t.value,onChange:a=>o({...t,value:Number(a.target.value)})})]})}),e.jsxs(ee,{children:[e.jsx(c,{onClick:f,children:"Cancel"}),e.jsx(c,{onClick:M,variant:"contained",disabled:!t.label,children:"Save"})]})]})]})}export{Ce as component};
